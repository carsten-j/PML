
<!-- saved from url=(0082)https://wouterboomsma.github.io/pml2024/week2/discrete_latent_variable_models.html -->
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="color-scheme" content="light dark"></head><body><div class="line-gutter-backdrop"></div><form autocomplete="off"><label class="line-wrap-control">Line wrap<input type="checkbox" aria-label="Line wrap"></label></form><table><tbody><tr><td class="line-number" value="1"></td><td class="line-content"><span class="html-doctype">&lt;!doctype html&gt;</span></td></tr><tr><td class="line-number" value="2"></td><td class="line-content"><span class="html-tag">&lt;html&gt;</span></td></tr><tr><td class="line-number" value="3"></td><td class="line-content">	<span class="html-tag">&lt;head&gt;</span></td></tr><tr><td class="line-number" value="4"></td><td class="line-content">		<span class="html-tag">&lt;meta <span class="html-attribute-name">charset</span>="<span class="html-attribute-value">utf-8</span>"&gt;</span></td></tr><tr><td class="line-number" value="5"></td><td class="line-content">		<span class="html-tag">&lt;meta <span class="html-attribute-name">name</span>="<span class="html-attribute-value">viewport</span>" <span class="html-attribute-name">content</span>="<span class="html-attribute-value">width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no</span>"&gt;</span></td></tr><tr><td class="line-number" value="6"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="7"></td><td class="line-content">		<span class="html-tag">&lt;title&gt;</span>Probabilistic Machine Learning<span class="html-tag">&lt;/title&gt;</span></td></tr><tr><td class="line-number" value="8"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="9"></td><td class="line-content">		<span class="html-tag">&lt;link <span class="html-attribute-name">rel</span>="<span class="html-attribute-value">stylesheet</span>" <span class="html-attribute-name">href</span>="<a class="html-attribute-value html-resource-link" target="_blank" href="https://wouterboomsma.github.io/pml2024/reveal.js-4.5.0/dist/reset.css" rel="noreferrer noopener">../reveal.js-4.5.0/dist/reset.css</a>"&gt;</span></td></tr><tr><td class="line-number" value="10"></td><td class="line-content">		<span class="html-tag">&lt;link <span class="html-attribute-name">rel</span>="<span class="html-attribute-value">stylesheet</span>" <span class="html-attribute-name">href</span>="<a class="html-attribute-value html-resource-link" target="_blank" href="https://wouterboomsma.github.io/pml2024/reveal.js-4.5.0/dist/reveal.css" rel="noreferrer noopener">../reveal.js-4.5.0/dist/reveal.css</a>"&gt;</span></td></tr><tr><td class="line-number" value="11"></td><td class="line-content">		<span class="html-tag">&lt;link <span class="html-attribute-name">rel</span>="<span class="html-attribute-value">stylesheet</span>" <span class="html-attribute-name">href</span>="<a class="html-attribute-value html-resource-link" target="_blank" href="https://wouterboomsma.github.io/pml2024/reveal.js-4.5.0/dist/theme/white-helv.css" rel="noreferrer noopener">../reveal.js-4.5.0/dist/theme/white-helv.css</a>"&gt;</span></td></tr><tr><td class="line-number" value="12"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="13"></td><td class="line-content">		<span class="html-comment">&lt;!-- Theme used for syntax highlighted code --&gt;</span></td></tr><tr><td class="line-number" value="14"></td><td class="line-content">		<span class="html-tag">&lt;link <span class="html-attribute-name">rel</span>="<span class="html-attribute-value">stylesheet</span>" <span class="html-attribute-name">href</span>="<a class="html-attribute-value html-resource-link" target="_blank" href="https://wouterboomsma.github.io/pml2024/reveal.js-4.5.0/plugin/highlight/monokai.css" rel="noreferrer noopener">../reveal.js-4.5.0/plugin/highlight/monokai.css</a>"&gt;</span></td></tr><tr><td class="line-number" value="15"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="16"></td><td class="line-content">		<span class="html-tag">&lt;style&gt;</span> </td></tr><tr><td class="line-number" value="17"></td><td class="line-content">			.reveal .slides h4 {</td></tr><tr><td class="line-number" value="18"></td><td class="line-content">				font-size:1.2em;</td></tr><tr><td class="line-number" value="19"></td><td class="line-content">			}</td></tr><tr><td class="line-number" value="20"></td><td class="line-content">			.reveal .slides h3 {</td></tr><tr><td class="line-number" value="21"></td><td class="line-content">				font-size:1.4em;</td></tr><tr><td class="line-number" value="22"></td><td class="line-content">			}</td></tr><tr><td class="line-number" value="23"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="24"></td><td class="line-content">			.reveal .slides {</td></tr><tr><td class="line-number" value="25"></td><td class="line-content">				text-align: left;</td></tr><tr><td class="line-number" value="26"></td><td class="line-content">			}</td></tr><tr><td class="line-number" value="27"></td><td class="line-content">			.reveal a {</td></tr><tr><td class="line-number" value="28"></td><td class="line-content">				color:DarkSlateBlue;</td></tr><tr><td class="line-number" value="29"></td><td class="line-content">			}</td></tr><tr><td class="line-number" value="30"></td><td class="line-content">			.reveal section img {</td></tr><tr><td class="line-number" value="31"></td><td class="line-content">				border: 1px solid lightgrey;</td></tr><tr><td class="line-number" value="32"></td><td class="line-content">				box-shadow: none;</td></tr><tr><td class="line-number" value="33"></td><td class="line-content">				margin:0;</td></tr><tr><td class="line-number" value="34"></td><td class="line-content">			}</td></tr><tr><td class="line-number" value="35"></td><td class="line-content">			.reveal section img.noborder {</td></tr><tr><td class="line-number" value="36"></td><td class="line-content">				border: none;</td></tr><tr><td class="line-number" value="37"></td><td class="line-content">				box-shadow: none;</td></tr><tr><td class="line-number" value="38"></td><td class="line-content">				margin:0</td></tr><tr><td class="line-number" value="39"></td><td class="line-content">			}</td></tr><tr><td class="line-number" value="40"></td><td class="line-content">			.reveal section img.center {</td></tr><tr><td class="line-number" value="41"></td><td class="line-content">				display: block;</td></tr><tr><td class="line-number" value="42"></td><td class="line-content">				margin: 0 auto;</td></tr><tr><td class="line-number" value="43"></td><td class="line-content">			}</td></tr><tr><td class="line-number" value="44"></td><td class="line-content">			.reveal section div.container{</td></tr><tr><td class="line-number" value="45"></td><td class="line-content">				display: flex;</td></tr><tr><td class="line-number" value="46"></td><td class="line-content">			}</td></tr><tr><td class="line-number" value="47"></td><td class="line-content">			.reveal section div.container div{</td></tr><tr><td class="line-number" value="48"></td><td class="line-content">				flex: 1;</td></tr><tr><td class="line-number" value="49"></td><td class="line-content">			}</td></tr><tr><td class="line-number" value="50"></td><td class="line-content">			.reveal dt.spaced {</td></tr><tr><td class="line-number" value="51"></td><td class="line-content">				margin-top:0.5em;</td></tr><tr><td class="line-number" value="52"></td><td class="line-content">			}</td></tr><tr><td class="line-number" value="53"></td><td class="line-content">			.MathJax_Display {</td></tr><tr><td class="line-number" value="54"></td><td class="line-content">				font-size: 75% !important;</td></tr><tr><td class="line-number" value="55"></td><td class="line-content">			}</td></tr><tr><td class="line-number" value="56"></td><td class="line-content">			.katex {</td></tr><tr><td class="line-number" value="57"></td><td class="line-content">				font-size: 100% !important;</td></tr><tr><td class="line-number" value="58"></td><td class="line-content">			}</td></tr><tr><td class="line-number" value="59"></td><td class="line-content">			.reveal .katex-display {</td></tr><tr><td class="line-number" value="60"></td><td class="line-content">				margin-top:0.25em;</td></tr><tr><td class="line-number" value="61"></td><td class="line-content">				margin-bottom:0.25em;</td></tr><tr><td class="line-number" value="62"></td><td class="line-content">			}</td></tr><tr><td class="line-number" value="63"></td><td class="line-content">			.reveal .katex-display&gt;.katex {</td></tr><tr><td class="line-number" value="64"></td><td class="line-content">				text-align:left;</td></tr><tr><td class="line-number" value="65"></td><td class="line-content">				margin-left:1em;</td></tr><tr><td class="line-number" value="66"></td><td class="line-content">			}</td></tr><tr><td class="line-number" value="67"></td><td class="line-content">			.reveal section dl.list dt {</td></tr><tr><td class="line-number" value="68"></td><td class="line-content">				display:list-item;</td></tr><tr><td class="line-number" value="69"></td><td class="line-content">			}</td></tr><tr><td class="line-number" value="70"></td><td class="line-content">			.reveal section dl.list dd {</td></tr><tr><td class="line-number" value="71"></td><td class="line-content">				margin-left:0;</td></tr><tr><td class="line-number" value="72"></td><td class="line-content">			}</td></tr><tr><td class="line-number" value="73"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="74"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="75"></td><td class="line-content">			a.popup-q {</td></tr><tr><td class="line-number" value="76"></td><td class="line-content">				background:grey;</td></tr><tr><td class="line-number" value="77"></td><td class="line-content">				color:white;</td></tr><tr><td class="line-number" value="78"></td><td class="line-content">				border-radius:100%;</td></tr><tr><td class="line-number" value="79"></td><td class="line-content">				text-align:center;</td></tr><tr><td class="line-number" value="80"></td><td class="line-content">				font-size:60%;</td></tr><tr><td class="line-number" value="81"></td><td class="line-content">				padding:0.1em;</td></tr><tr><td class="line-number" value="82"></td><td class="line-content">				top:0.0em;</td></tr><tr><td class="line-number" value="83"></td><td class="line-content">				line-height:1.1em;</td></tr><tr><td class="line-number" value="84"></td><td class="line-content">				display:inline-block;</td></tr><tr><td class="line-number" value="85"></td><td class="line-content">				cursor:pointer;</td></tr><tr><td class="line-number" value="86"></td><td class="line-content">				width:1em;</td></tr><tr><td class="line-number" value="87"></td><td class="line-content">				height:1em;</td></tr><tr><td class="line-number" value="88"></td><td class="line-content">			}</td></tr><tr><td class="line-number" value="89"></td><td class="line-content">			.popup {</td></tr><tr><td class="line-number" value="90"></td><td class="line-content">				display: none;</td></tr><tr><td class="line-number" value="91"></td><td class="line-content">				position: absolute;</td></tr><tr><td class="line-number" value="92"></td><td class="line-content">				top:50%;</td></tr><tr><td class="line-number" value="93"></td><td class="line-content">				left:50%;</td></tr><tr><td class="line-number" value="94"></td><td class="line-content">				transform: translate(-50%, -50%);</td></tr><tr><td class="line-number" value="95"></td><td class="line-content">				width: 80%;</td></tr><tr><td class="line-number" value="96"></td><td class="line-content">				font-size:80%;</td></tr><tr><td class="line-number" value="97"></td><td class="line-content">				/*margin-left:-50px;*/</td></tr><tr><td class="line-number" value="98"></td><td class="line-content">				background-color: #fff;</td></tr><tr><td class="line-number" value="99"></td><td class="line-content">				padding: 0.25em 0.5em 0em 0.5em;</td></tr><tr><td class="line-number" value="100"></td><td class="line-content">				border: solid 1px #999;</td></tr><tr><td class="line-number" value="101"></td><td class="line-content">				z-index:100;</td></tr><tr><td class="line-number" value="102"></td><td class="line-content">				/*@include border-radius(5px);*/</td></tr><tr><td class="line-number" value="103"></td><td class="line-content">				/*@include box-shadow(0 4px 10px rgba(#000,.5));*/</td></tr><tr><td class="line-number" value="104"></td><td class="line-content">			}</td></tr><tr><td class="line-number" value="105"></td><td class="line-content">			.popup-close {</td></tr><tr><td class="line-number" value="106"></td><td class="line-content">				position: absolute;</td></tr><tr><td class="line-number" value="107"></td><td class="line-content">				right: 10px;</td></tr><tr><td class="line-number" value="108"></td><td class="line-content">				top: 0px;</td></tr><tr><td class="line-number" value="109"></td><td class="line-content">				/*background-color: black;*/</td></tr><tr><td class="line-number" value="110"></td><td class="line-content">				color: black;</td></tr><tr><td class="line-number" value="111"></td><td class="line-content">				border-radius: 50%;</td></tr><tr><td class="line-number" value="112"></td><td class="line-content">				padding: 4px;</td></tr><tr><td class="line-number" value="113"></td><td class="line-content">				cursor:pointer;</td></tr><tr><td class="line-number" value="114"></td><td class="line-content">			}</td></tr><tr><td class="line-number" value="115"></td><td class="line-content">		<span class="html-tag">&lt;/style&gt;</span></td></tr><tr><td class="line-number" value="116"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="117"></td><td class="line-content">	<span class="html-tag">&lt;/head&gt;</span></td></tr><tr><td class="line-number" value="118"></td><td class="line-content">	<span class="html-tag">&lt;body&gt;</span></td></tr><tr><td class="line-number" value="119"></td><td class="line-content">		<span class="html-tag">&lt;div <span class="html-attribute-name">class</span>="<span class="html-attribute-value">reveal</span>"&gt;</span></td></tr><tr><td class="line-number" value="120"></td><td class="line-content">			<span class="html-tag">&lt;div <span class="html-attribute-name">class</span>="<span class="html-attribute-value">slides</span>"&gt;</span></td></tr><tr><td class="line-number" value="121"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="122"></td><td class="line-content">				<span class="html-tag">&lt;section&gt;</span></td></tr><tr><td class="line-number" value="123"></td><td class="line-content">					<span class="html-tag">&lt;br/&gt;</span></td></tr><tr><td class="line-number" value="124"></td><td class="line-content">					<span class="html-tag">&lt;h1&gt;</span>Probabilistic <span class="html-tag">&lt;br&gt;</span>Machine Learning<span class="html-tag">&lt;/h1&gt;</span></td></tr><tr><td class="line-number" value="125"></td><td class="line-content">					<span class="html-tag">&lt;h4&gt;</span>Week 2, Tuesday<span class="html-tag">&lt;/h4&gt;</span></td></tr><tr><td class="line-number" value="126"></td><td class="line-content">					<span class="html-comment">&lt;!-- &lt;dl&gt; --&gt;</span></td></tr><tr><td class="line-number" value="127"></td><td class="line-content">					<span class="html-tag">&lt;div <span class="html-attribute-name">style</span>="<span class="html-attribute-value">text-align:left; font-size:100%; border:1px solid lightgrey; background-color: #fafafa; padding:0.5em; display:inline-block; margin-top:0em</span>"&gt;</span></td></tr><tr><td class="line-number" value="128"></td><td class="line-content">						<span class="html-tag">&lt;h4 <span class="html-attribute-name">style</span>="<span class="html-attribute-value">margin-bottom: 0.2em</span>"&gt;</span>Discrete latent variable models<span class="html-tag">&lt;/h4&gt;</span></td></tr><tr><td class="line-number" value="129"></td><td class="line-content">						<span class="html-tag">&lt;dl <span class="html-attribute-name">class</span>="<span class="html-attribute-value">list</span>"&gt;</span></td></tr><tr><td class="line-number" value="130"></td><td class="line-content">							<span class="html-tag">&lt;dt&gt;</span>Mixture models<span class="html-tag">&lt;/dt&gt;</span></td></tr><tr><td class="line-number" value="131"></td><td class="line-content">							<span class="html-tag">&lt;dd <span class="html-attribute-name">style</span>="<span class="html-attribute-value">margin-left:1em</span>"&gt;</span>Inference: The EM algorithm<span class="html-tag">&lt;/dd&gt;</span></td></tr><tr><td class="line-number" value="132"></td><td class="line-content">							<span class="html-tag">&lt;dt&gt;</span>Bayesian Mixture Models<span class="html-tag">&lt;/dt&gt;</span></td></tr><tr><td class="line-number" value="133"></td><td class="line-content">							<span class="html-tag">&lt;dd <span class="html-attribute-name">style</span>="<span class="html-attribute-value">margin-left:1em</span>"&gt;</span>Inference: variational inference<span class="html-tag">&lt;/dd&gt;</span></td></tr><tr><td class="line-number" value="134"></td><td class="line-content">						<span class="html-tag">&lt;/dl&gt;</span></td></tr><tr><td class="line-number" value="135"></td><td class="line-content"><span class="html-comment">&lt;!--					&lt;span style="margin-left:-4em"&gt;Latent variable models:&lt;/span&gt;&lt;br&gt;--&gt;</span></td></tr><tr><td class="line-number" value="136"></td><td class="line-content"><span class="html-comment">&lt;!--					&lt;ul&gt;--&gt;</span></td></tr><tr><td class="line-number" value="137"></td><td class="line-content"><span class="html-comment">&lt;!--						&lt;li&gt;Discrete: Mixture models&lt;/li&gt;--&gt;</span></td></tr><tr><td class="line-number" value="138"></td><td class="line-content"><span class="html-comment">&lt;!--						&lt;li&gt;Continuous: Probabilistic PCA&lt;/li&gt;--&gt;</span></td></tr><tr><td class="line-number" value="139"></td><td class="line-content"><span class="html-comment">&lt;!--					&lt;/ul&gt;--&gt;</span></td></tr><tr><td class="line-number" value="140"></td><td class="line-content">				<span class="html-tag">&lt;/section&gt;</span></td></tr><tr><td class="line-number" value="141"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="142"></td><td class="line-content"><span class="html-comment">&lt;!--				&lt;section style="font-size:80%"&gt;--&gt;</span></td></tr><tr><td class="line-number" value="143"></td><td class="line-content"><span class="html-comment">&lt;!--					&lt;p&gt;Many of the figures in this slide deck are from the text book: Pattern Recognition and Machine Learning, by Christopher Bishop.&lt;/p&gt;--&gt;</span></td></tr><tr><td class="line-number" value="144"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="145"></td><td class="line-content"><span class="html-comment">&lt;!--					&lt;p&gt;In the interest of slide real-estate, I have not added citations to the individual slides, but have for all these figures added a hyperlink to the website for the book.&lt;/p&gt;--&gt;</span></td></tr><tr><td class="line-number" value="146"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="147"></td><td class="line-content"><span class="html-comment">&lt;!--					&lt;p&gt;I hereby express my gratitude to the author for making them available.&lt;/p&gt;--&gt;</span></td></tr><tr><td class="line-number" value="148"></td><td class="line-content"><span class="html-comment">&lt;!--				&lt;/section&gt;--&gt;</span></td></tr><tr><td class="line-number" value="149"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="150"></td><td class="line-content"><span class="html-tag">&lt;section  <span class="html-attribute-name">style</span>="<span class="html-attribute-value">font-size:100%</span>"&gt;</span></td></tr><tr><td class="line-number" value="151"></td><td class="line-content">	<span class="html-tag">&lt;h3&gt;</span>Before we begin: Expectations<span class="html-tag">&lt;/h3&gt;</span></td></tr><tr><td class="line-number" value="152"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="153"></td><td class="line-content">	<span class="html-tag">&lt;p&gt;</span>We will use the notation \(\mathbb{E}_{\boldsymbol x \sim p(\boldsymbol x)}[f(\boldsymbol x)]\) to denote the expectation of a function \(f\) with respect to a probability density \(p\).  <span class="html-tag">&lt;/p&gt;</span></td></tr><tr><td class="line-number" value="154"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="155"></td><td class="line-content">	<span class="html-tag">&lt;p&gt;</span>We'll also sometimes write it as \(\mathbb{E}_{p(\boldsymbol x)}[f(\boldsymbol x)]\) or \(\mathbb{E}[f(\boldsymbol x)]\)<span class="html-tag">&lt;/p&gt;</span></td></tr><tr><td class="line-number" value="156"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="157"></td><td class="line-content">	<span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">fragment</span>"&gt;</span></td></tr><tr><td class="line-number" value="158"></td><td class="line-content">	<span class="html-tag">&lt;p&gt;</span>Reminder: an expectation is a weighted average of a function<span class="html-tag">&lt;/p&gt;</span></td></tr><tr><td class="line-number" value="159"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="160"></td><td class="line-content">	\[\mathbb{E}[f] = \int p(\boldsymbol x) f(\boldsymbol x) d\boldsymbol x\]</td></tr><tr><td class="line-number" value="161"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="162"></td><td class="line-content">	<span class="html-tag">&lt;p&gt;</span>If we have available samples \(\boldsymbol x_1, \ldots, \boldsymbol x_N\) from \(p(\boldsymbol x)\), we can approximate this integral with a sum:<span class="html-tag">&lt;/p&gt;</span></td></tr><tr><td class="line-number" value="163"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="164"></td><td class="line-content">	\[\mathbb{E}[f] = \int p(\boldsymbol x) f(\boldsymbol x) d\boldsymbol x \approx \frac{1}{N}\sum_i^Nf(\boldsymbol x_i) \hspace{2em} \boldsymbol x_i \sim p(\boldsymbol x)\]</td></tr><tr><td class="line-number" value="165"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="166"></td><td class="line-content">	<span class="html-comment">&lt;!-- &lt;p&gt;We will see that this is one of the most important operations in probabilistic machine learning.&lt;/p&gt; --&gt;</span></td></tr><tr><td class="line-number" value="167"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="168"></td><td class="line-content">	<span class="html-comment">&lt;!-- &lt;p&gt;Often, the goal of acquiring samples from a density is just to approximate an expectation by a finite sum:&lt;/p&gt;</span></td></tr><tr><td class="line-number" value="169"></td><td class="line-content"><span class="html-comment"><br></span></td></tr><tr><td class="line-number" value="170"></td><td class="line-content"><span class="html-comment">	\[\mathbb{E}[f] \approx \frac{1}{L} \sum_{l=1}^L f(\boldsymbol z^{(l)}) \hspace*{3em}\text{where }\boldsymbol z^{(l)} \sim p(\boldsymbol z)\] --&gt;</span></td></tr><tr><td class="line-number" value="171"></td><td class="line-content">	<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="172"></td><td class="line-content"><span class="html-tag">&lt;/section&gt;</span></td></tr><tr><td class="line-number" value="173"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="174"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="175"></td><td class="line-content"><span class="html-tag">&lt;section&gt;</span></td></tr><tr><td class="line-number" value="176"></td><td class="line-content">	<span class="html-tag">&lt;h3&gt;</span>Before we begin: What is "inference"?<span class="html-tag">&lt;/h3&gt;</span></td></tr><tr><td class="line-number" value="177"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="178"></td><td class="line-content">	<span class="html-tag">&lt;p&gt;</span>Machine Learning terminology:<span class="html-tag">&lt;/p&gt;</span></td></tr><tr><td class="line-number" value="179"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="180"></td><td class="line-content">	<span class="html-tag">&lt;dl <span class="html-attribute-name">class</span>="<span class="html-attribute-value">list</span>"&gt;</span></td></tr><tr><td class="line-number" value="181"></td><td class="line-content">		<span class="html-tag">&lt;dt&gt;</span><span class="html-tag">&lt;em&gt;</span>Learning<span class="html-tag">&lt;/em&gt;</span> typically refers to finding optimal parameters for variables in the model<span class="html-tag">&lt;/dt&gt;</span></td></tr><tr><td class="line-number" value="182"></td><td class="line-content">		<span class="html-tag">&lt;dt <span class="html-attribute-name">class</span>="<span class="html-attribute-value">spaced</span>"&gt;</span><span class="html-tag">&lt;em&gt;</span>Inference<span class="html-tag">&lt;/em&gt;</span> refers to the task of reasoning about unknown probability distributions.<span class="html-tag">&lt;/dt&gt;</span></td></tr><tr><td class="line-number" value="183"></td><td class="line-content">	<span class="html-tag">&lt;/dl&gt;</span></td></tr><tr><td class="line-number" value="184"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="185"></td><td class="line-content">	<span class="html-tag">&lt;p <span class="html-attribute-name">class</span>="<span class="html-attribute-value">fragment</span>"&gt;</span>In a fully Bayesian setting, one treats all parameters as distributions - so there is no <span class="html-tag">&lt;em&gt;</span>learning<span class="html-tag">&lt;/em&gt;</span>, only <span class="html-tag">&lt;em&gt;</span>inference<span class="html-tag">&lt;/em&gt;</span>.<span class="html-tag">&lt;/p&gt;</span></td></tr><tr><td class="line-number" value="186"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="187"></td><td class="line-content">	<span class="html-tag">&lt;p <span class="html-attribute-name">class</span>="<span class="html-attribute-value">fragment</span>"&gt;</span>Even if you are not doing a Bayesian analysis, you will still do <span class="html-tag">&lt;em&gt;</span>inference<span class="html-tag">&lt;/em&gt;</span> for any latent (unobserved) variables in the model. This is what we mean when we say that we do variational inference in e.g. a variational autoencoder.<span class="html-tag">&lt;/p&gt;</span></td></tr><tr><td class="line-number" value="188"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="189"></td><td class="line-content">	<span class="html-comment">&lt;!-- &lt;p class="fragment"&gt;For the same reason, in the Bayesian setting, there will often be no distinction between parameters \(\boldsymbol \theta\), and latent variables \(\boldsymbol z\). Everything will be contained in \(\boldsymbol z\).&lt;/p&gt; --&gt;</span></td></tr><tr><td class="line-number" value="190"></td><td class="line-content"><span class="html-tag">&lt;/section&gt;</span></td></tr><tr><td class="line-number" value="191"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="192"></td><td class="line-content"><span class="html-comment">&lt;!-- &lt;section style="font-size:90%"&gt;</span></td></tr><tr><td class="line-number" value="193"></td><td class="line-content"><span class="html-comment">	&lt;h3&gt;Before we begin: What is "inference"? (2)&lt;/h3&gt;</span></td></tr><tr><td class="line-number" value="194"></td><td class="line-content"><span class="html-comment"><br></span></td></tr><tr><td class="line-number" value="195"></td><td class="line-content"><span class="html-comment">	&lt;p&gt;Central tasks in Bayesian inference:&lt;/p&gt;</span></td></tr><tr><td class="line-number" value="196"></td><td class="line-content"><span class="html-comment"><br></span></td></tr><tr><td class="line-number" value="197"></td><td class="line-content"><span class="html-comment">	&lt;dl class="list"&gt;</span></td></tr><tr><td class="line-number" value="198"></td><td class="line-content"><span class="html-comment">		&lt;dt&gt;Find the distributions over parameters that best explain my data:&lt;/dt&gt;</span></td></tr><tr><td class="line-number" value="199"></td><td class="line-content"><span class="html-comment">		&lt;dd&gt;\[\underbrace{p(\boldsymbol \theta|\boldsymbol x)}_{\text{posterior}} = \frac{\overbrace{p(\boldsymbol x|\boldsymbol \theta)}^{\text{likelihood}}\overbrace{p(\boldsymbol \theta)}^{\text{prior}}}{\underbrace{p(\boldsymbol x)}_{\text{evidence / marginal likelihood}}}\]&lt;/dd&gt;</span></td></tr><tr><td class="line-number" value="200"></td><td class="line-content"><span class="html-comment">		&lt;span class="fragment"&gt;</span></td></tr><tr><td class="line-number" value="201"></td><td class="line-content"><span class="html-comment">		&lt;dt class="spaced"&gt;Make predictions on new data \(x'\) by evaluating expectations over the posterior:&lt;/dt&gt;</span></td></tr><tr><td class="line-number" value="202"></td><td class="line-content"><span class="html-comment">		&lt;dd&gt;\[p(\boldsymbol x'|\boldsymbol x) = \int_{\boldsymbol \theta} p(\boldsymbol x'|\boldsymbol \theta)p(\boldsymbol \theta|\boldsymbol x)d\boldsymbol \theta = \mathbb{E}_{p(\boldsymbol \theta|\boldsymbol x)}p(\boldsymbol x'|\boldsymbol \theta) \]&lt;/dd&gt;</span></td></tr><tr><td class="line-number" value="203"></td><td class="line-content"><span class="html-comment">		&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="204"></td><td class="line-content"><span class="html-comment">	&lt;/dl&gt;</span></td></tr><tr><td class="line-number" value="205"></td><td class="line-content"><span class="html-comment"><br></span></td></tr><tr><td class="line-number" value="206"></td><td class="line-content"><span class="html-comment">&lt;/section&gt; --&gt;</span></td></tr><tr><td class="line-number" value="207"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="208"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="209"></td><td class="line-content">				<span class="html-tag">&lt;section <span class="html-attribute-name">style</span>="<span class="html-attribute-value">text-align:center</span>"&gt;</span></td></tr><tr><td class="line-number" value="210"></td><td class="line-content">					<span class="html-tag">&lt;h2&gt;</span>Discrete latent variable models: <span class="html-tag">&lt;br&gt;</span>Mixture models<span class="html-tag">&lt;/h2&gt;</span></td></tr><tr><td class="line-number" value="211"></td><td class="line-content">				<span class="html-tag">&lt;/section&gt;</span></td></tr><tr><td class="line-number" value="212"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="213"></td><td class="line-content">				<span class="html-tag">&lt;section <span class="html-attribute-name">style</span>="<span class="html-attribute-value">font-size:90%</span>"&gt;</span></td></tr><tr><td class="line-number" value="214"></td><td class="line-content">					<span class="html-tag">&lt;h4&gt;</span>How do we model multimodal distributions?<span class="html-tag">&lt;/h4&gt;</span></td></tr><tr><td class="line-number" value="215"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="216"></td><td class="line-content">					<span class="html-tag">&lt;div <span class="html-attribute-name">class</span>="<span class="html-attribute-value">container</span>"&gt;</span></td></tr><tr><td class="line-number" value="217"></td><td class="line-content">						<span class="html-tag">&lt;div <span class="html-attribute-name">style</span>="<span class="html-attribute-value">flex-grow:0.7</span>"&gt;</span><span class="html-tag">&lt;p&gt;</span>Complex density functions can be approximated by convex combination of simpler distributions.<span class="html-tag">&lt;/p&gt;</span></td></tr><tr><td class="line-number" value="218"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="219"></td><td class="line-content">						\[p(\boldsymbol x) = \sum_k^K \pi_k \mathcal{N}(\boldsymbol x | \boldsymbol \mu_k, \boldsymbol \Sigma_k)\]</td></tr><tr><td class="line-number" value="220"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="221"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="222"></td><td class="line-content">						<span class="html-tag">&lt;/div&gt;</span></td></tr><tr><td class="line-number" value="223"></td><td class="line-content">						<span class="html-tag">&lt;div <span class="html-attribute-name">class</span>="<span class="html-attribute-value">r-stack</span>" <span class="html-attribute-name">style</span>="<span class="html-attribute-value">margin:1em</span>"&gt;</span></td></tr><tr><td class="line-number" value="224"></td><td class="line-content">							<span class="html-tag">&lt;img <span class="html-attribute-name">class</span>="<span class="html-attribute-value">fragment current-visible noborder</span>" <span class="html-attribute-name">src</span>="<a class="html-attribute-value html-resource-link" target="_blank" href="https://wouterboomsma.github.io/pml2024/week2/mixture1.svg" rel="noreferrer noopener">mixture1.svg</a>"&gt;</span></td></tr><tr><td class="line-number" value="225"></td><td class="line-content">							<span class="html-tag">&lt;img <span class="html-attribute-name">class</span>="<span class="html-attribute-value">fragment noborder</span>" <span class="html-attribute-name">src</span>="<a class="html-attribute-value html-resource-link" target="_blank" href="https://wouterboomsma.github.io/pml2024/week2/mixture2.svg" rel="noreferrer noopener">mixture2.svg</a>"&gt;</span></td></tr><tr><td class="line-number" value="226"></td><td class="line-content">							<span class="html-tag">&lt;img <span class="html-attribute-name">class</span>="<span class="html-attribute-value">fragment noborder</span>" <span class="html-attribute-name">src</span>="<a class="html-attribute-value html-resource-link" target="_blank" href="https://wouterboomsma.github.io/pml2024/week2/mixture_2d_1.svg" rel="noreferrer noopener">mixture_2d_1.svg</a>"&gt;</span></td></tr><tr><td class="line-number" value="227"></td><td class="line-content">							<span class="html-tag">&lt;img <span class="html-attribute-name">class</span>="<span class="html-attribute-value">fragment noborder</span>" <span class="html-attribute-name">src</span>="<a class="html-attribute-value html-resource-link" target="_blank" href="https://wouterboomsma.github.io/pml2024/week2/mixture_2d_2.svg" rel="noreferrer noopener">mixture_2d_2.svg</a>"&gt;</span></td></tr><tr><td class="line-number" value="228"></td><td class="line-content">						<span class="html-tag">&lt;/div&gt;</span></td></tr><tr><td class="line-number" value="229"></td><td class="line-content">					<span class="html-tag">&lt;/div&gt;</span></td></tr><tr><td class="line-number" value="230"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="231"></td><td class="line-content">					Such models are called mixture models. The simpler distributions in a mixture model are often called <span class="html-tag">&lt;em&gt;</span>components<span class="html-tag">&lt;/em&gt;</span>. We will focus on Gaussian mixture models.</td></tr><tr><td class="line-number" value="232"></td><td class="line-content">				<span class="html-tag">&lt;/section&gt;</span></td></tr><tr><td class="line-number" value="233"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="234"></td><td class="line-content">				<span class="html-tag">&lt;section <span class="html-attribute-name">style</span>="<span class="html-attribute-value">font-size:80%</span>"&gt;</span></td></tr><tr><td class="line-number" value="235"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="236"></td><td class="line-content">					<span class="html-tag">&lt;h3&gt;</span>Mixture models are latent variable models<span class="html-tag">&lt;/h3&gt;</span></td></tr><tr><td class="line-number" value="237"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="238"></td><td class="line-content">					<span class="html-tag">&lt;div <span class="html-attribute-name">class</span>="" <span class="html-attribute-name">style</span>="<span class="html-attribute-value">float:right; width:40%; border:1px solid lightgrey; padding-right:0.5em; margin-top:0em; margin-left:0.5em</span>"&gt;</span></td></tr><tr><td class="line-number" value="239"></td><td class="line-content">					\[p(\boldsymbol x) = \sum_k^K \pi_k \mathcal{N}(\boldsymbol x | \boldsymbol \mu_k, \boldsymbol \Sigma_k) \\</td></tr><tr><td class="line-number" value="240"></td><td class="line-content">					\downarrow\\</td></tr><tr><td class="line-number" value="241"></td><td class="line-content">					p(\boldsymbol x) = \sum_{\boldsymbol z} p(\boldsymbol z)p(\boldsymbol x| \boldsymbol z)</td></tr><tr><td class="line-number" value="242"></td><td class="line-content">					\]</td></tr><tr><td class="line-number" value="243"></td><td class="line-content">					<span class="html-tag">&lt;/div&gt;</span></td></tr><tr><td class="line-number" value="244"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="245"></td><td class="line-content">					<span class="html-tag">&lt;p&gt;</span>Idea: introduce discrete random variable \(z\) which takes \(K\) possible outcomes, representing the \(K\) components.<span class="html-tag">&lt;/p&gt;</span></td></tr><tr><td class="line-number" value="246"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="247"></td><td class="line-content">					<span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">fragment</span>"&gt;</span></td></tr><tr><td class="line-number" value="248"></td><td class="line-content">					<span class="html-tag">&lt;p&gt;</span>As usual when representing a categorical variable, we will use a <span class="html-tag">&lt;em&gt;</span>one-hot<span class="html-tag">&lt;/em&gt;</span> (or <span class="html-tag">&lt;em&gt;</span>one-out-of-K<span class="html-tag">&lt;/em&gt;</span>) representation.<span class="html-tag">&lt;/p&gt;</span></td></tr><tr><td class="line-number" value="249"></td><td class="line-content">					\[z_k \in \{0,1\} \hspace{3em}\text{(but only one $z_k$ can be nonzero at a time)} \]</td></tr><tr><td class="line-number" value="250"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="251"></td><td class="line-content">					<span class="html-tag">&lt;p&gt;</span>The marginal probability of \(z\) are the mixture components weights<span class="html-tag">&lt;/p&gt;</span></td></tr><tr><td class="line-number" value="252"></td><td class="line-content">					\[p(z_k = 1) = \pi_k \]</td></tr><tr><td class="line-number" value="253"></td><td class="line-content"><span class="html-comment">&lt;!--					&lt;ul&gt;--&gt;</span></td></tr><tr><td class="line-number" value="254"></td><td class="line-content"><span class="html-comment">&lt;!--						&lt;li&gt;\(z_k \in {0,1}\)   (but only one $k$ can be nonzero at a time)&lt;/li&gt;--&gt;</span></td></tr><tr><td class="line-number" value="255"></td><td class="line-content"><span class="html-comment">&lt;!--						&lt;li&gt;\(p(z_k = 1) = \pi_k \)&lt;/li&gt;--&gt;</span></td></tr><tr><td class="line-number" value="256"></td><td class="line-content"><span class="html-comment">&lt;!--					&lt;/ul&gt;--&gt;</span></td></tr><tr><td class="line-number" value="257"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="258"></td><td class="line-content">					<span class="html-tag">&lt;p&gt;</span>Since \(z\) has a one-hot representation, we can write<span class="html-tag">&lt;/p&gt;</span></td></tr><tr><td class="line-number" value="259"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="260"></td><td class="line-content">					\[p(\boldsymbol z) = \prod_{k=1}^{K}\pi_k^{z_k}\hspace{3em}\text{(only one of the factors will contribute)}\]</td></tr><tr><td class="line-number" value="261"></td><td class="line-content">				<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="262"></td><td class="line-content">				<span class="html-tag">&lt;/section&gt;</span></td></tr><tr><td class="line-number" value="263"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="264"></td><td class="line-content">				<span class="html-tag">&lt;section <span class="html-attribute-name">style</span>="<span class="html-attribute-value">font-size:90%</span>"&gt;</span></td></tr><tr><td class="line-number" value="265"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="266"></td><td class="line-content">					<span class="html-tag">&lt;h4&gt;</span>Mixture models are latent variable models (2)<span class="html-tag">&lt;/h4&gt;</span></td></tr><tr><td class="line-number" value="267"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="268"></td><td class="line-content">					<span class="html-tag">&lt;div <span class="html-attribute-name">class</span>="<span class="html-attribute-value">container</span>"&gt;</span></td></tr><tr><td class="line-number" value="269"></td><td class="line-content">						<span class="html-tag">&lt;div <span class="html-attribute-name">style</span>="<span class="html-attribute-value">flex-grow:3.0</span>"&gt;</span></td></tr><tr><td class="line-number" value="270"></td><td class="line-content"><span class="html-comment">&lt;!--							&lt;span class="fragment" data-fragment-index="2"&gt;&lt;/span&gt;--&gt;</span></td></tr><tr><td class="line-number" value="271"></td><td class="line-content"><span class="html-comment">&lt;!--							&lt;p&gt;Different perspective: categorical latent variable \(z\), which can take one of \(K\) values, each with probability \(\pi_k\).&lt;/p&gt;--&gt;</span></td></tr><tr><td class="line-number" value="272"></td><td class="line-content"><span class="html-comment">&lt;!--							&lt;p&gt;We use a one-hot representation for \(z\). &lt;/p&gt;--&gt;</span></td></tr><tr><td class="line-number" value="273"></td><td class="line-content">							<span class="html-tag">&lt;p&gt;</span>Model: \[\begin{aligned}p(\boldsymbol x) &amp;= \sum_{\boldsymbol z} p(\boldsymbol x, \boldsymbol z) = \sum_{\boldsymbol z} p(\boldsymbol x| \boldsymbol z)p(\boldsymbol z) \\ &amp;= \sum_{\boldsymbol z} \prod_{k=1}^K \mathcal{N} (\boldsymbol x | \boldsymbol \mu_k, \boldsymbol \Sigma_k)^{z_k} \pi_k^{z_k} \\ &amp;= \sum_{k=1}^K \mathcal{N}(\boldsymbol x | \boldsymbol \mu_k, \boldsymbol \Sigma_k) \underbrace{\pi_k}_{p(z_k=1)} \end{aligned}\]<span class="html-tag">&lt;/p&gt;</span></td></tr><tr><td class="line-number" value="274"></td><td class="line-content">						<span class="html-tag">&lt;/div&gt;</span></td></tr><tr><td class="line-number" value="275"></td><td class="line-content">						<span class="html-tag">&lt;div <span class="html-attribute-name">class</span>="<span class="html-attribute-value">fragment</span>" <span class="html-attribute-name">data-fragment-index</span>="<span class="html-attribute-value">1</span>" <span class="html-attribute-name">style</span>="<span class="html-attribute-value">text-align: center; margin-left:1em; margin-top:2em</span>"&gt;</span></td></tr><tr><td class="line-number" value="276"></td><td class="line-content">							Graphical model:</td></tr><tr><td class="line-number" value="277"></td><td class="line-content">							<span class="html-tag">&lt;img <span class="html-attribute-name">style</span>="<span class="html-attribute-value">width:40%; padding:0.5em</span>" <span class="html-attribute-name">class</span>="<span class="html-attribute-value">noborder prml</span>" <span class="html-attribute-name">src</span>="<a class="html-attribute-value html-resource-link" target="_blank" href="https://wouterboomsma.github.io/pml2024/prmlfigs-svg/Figure9.4.svg" rel="noreferrer noopener">../prmlfigs-svg/Figure9.4.svg</a>"&gt;</span></td></tr><tr><td class="line-number" value="278"></td><td class="line-content"><span class="html-comment">&lt;!--							&lt;svg width="60%" viewBox="0 0 100 200"&gt;--&gt;</span></td></tr><tr><td class="line-number" value="279"></td><td class="line-content"><span class="html-comment">&lt;!--								&lt;defs&gt;--&gt;</span></td></tr><tr><td class="line-number" value="280"></td><td class="line-content"><span class="html-comment">&lt;!--									&lt;desc&gt;Define the marker&lt;/desc&gt;--&gt;</span></td></tr><tr><td class="line-number" value="281"></td><td class="line-content"><span class="html-comment">&lt;!--									&lt;marker id="arrow" refX="4" refY="3" markerWidth="6" markerHeight="6" orient="auto" stroke="black"&gt;--&gt;</span></td></tr><tr><td class="line-number" value="282"></td><td class="line-content"><span class="html-comment">&lt;!--										&lt;path d="M 0 0 L 4 3 L 0 6 Z"&gt;&lt;/path&gt;--&gt;</span></td></tr><tr><td class="line-number" value="283"></td><td class="line-content"><span class="html-comment">&lt;!--									&lt;/marker&gt;--&gt;</span></td></tr><tr><td class="line-number" value="284"></td><td class="line-content"><span class="html-comment">&lt;!--								&lt;/defs&gt;--&gt;</span></td></tr><tr><td class="line-number" value="285"></td><td class="line-content"><span class="html-comment">&lt;!--								&lt;desc&gt;Use the markers&lt;/desc&gt;--&gt;</span></td></tr><tr><td class="line-number" value="286"></td><td class="line-content"><span class="html-comment">&lt;!--								&lt;circle cy="160" cx="50" r="20" fill="none" stroke="black"/&gt;--&gt;</span></td></tr><tr><td class="line-number" value="287"></td><td class="line-content"><span class="html-comment">&lt;!--								&lt;circle cy="50" cx="50" r="20"  fill="none" stroke="black"/&gt;--&gt;</span></td></tr><tr><td class="line-number" value="288"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="289"></td><td class="line-content"><span class="html-comment">&lt;!--								&lt;line x1="50" y1="70" x2="50" y2="140" fill="none" stroke="black" stroke-width="2" marker-end="url(#arrow)"&gt;&lt;/line&gt;--&gt;</span></td></tr><tr><td class="line-number" value="290"></td><td class="line-content"><span class="html-comment">&lt;!--								&lt;foreignObject x="30" y="30" width="40" height="40"&gt;--&gt;</span></td></tr><tr><td class="line-number" value="291"></td><td class="line-content"><span class="html-comment">&lt;!--									&lt;div xmlns="http://www.w3.org/1999/xhtml" style="text-align:center; margin-top:0.3em; font-size:20px"&gt;--&gt;</span></td></tr><tr><td class="line-number" value="292"></td><td class="line-content"><span class="html-comment">&lt;!--										\(\displaystyle{z}\)--&gt;</span></td></tr><tr><td class="line-number" value="293"></td><td class="line-content"><span class="html-comment">&lt;!--									&lt;/div&gt;--&gt;</span></td></tr><tr><td class="line-number" value="294"></td><td class="line-content"><span class="html-comment">&lt;!--								&lt;/foreignObject&gt;--&gt;</span></td></tr><tr><td class="line-number" value="295"></td><td class="line-content"><span class="html-comment">&lt;!--								&lt;foreignObject x="30" y="140" width="40" height="40"&gt;--&gt;</span></td></tr><tr><td class="line-number" value="296"></td><td class="line-content"><span class="html-comment">&lt;!--									&lt;div xmlns="http://www.w3.org/1999/xhtml" style="text-align:center; margin-top:0.3em; font-size:20px"&gt;--&gt;</span></td></tr><tr><td class="line-number" value="297"></td><td class="line-content"><span class="html-comment">&lt;!--										\(\displaystyle{x}\)--&gt;</span></td></tr><tr><td class="line-number" value="298"></td><td class="line-content"><span class="html-comment">&lt;!--									&lt;/div&gt;--&gt;</span></td></tr><tr><td class="line-number" value="299"></td><td class="line-content"><span class="html-comment">&lt;!--								&lt;/foreignObject&gt;--&gt;</span></td></tr><tr><td class="line-number" value="300"></td><td class="line-content"><span class="html-comment">&lt;!--							&lt;/svg&gt;--&gt;</span></td></tr><tr><td class="line-number" value="301"></td><td class="line-content">						<span class="html-tag">&lt;/div&gt;</span></td></tr><tr><td class="line-number" value="302"></td><td class="line-content">					<span class="html-tag">&lt;/div&gt;</span></td></tr><tr><td class="line-number" value="303"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="304"></td><td class="line-content">					<span class="html-tag">&lt;div <span class="html-attribute-name">class</span>="<span class="html-attribute-value">container</span>"&gt;</span></td></tr><tr><td class="line-number" value="305"></td><td class="line-content">						<span class="html-tag">&lt;div <span class="html-attribute-name">style</span>="<span class="html-attribute-value">flex-grow: 1.5;</span>"&gt;</span></td></tr><tr><td class="line-number" value="306"></td><td class="line-content">							<span class="html-tag">&lt;p <span class="html-attribute-name">class</span>="<span class="html-attribute-value">fragment</span>" <span class="html-attribute-name">data-fragment-index</span>="<span class="html-attribute-value">1</span>"&gt;</span>So, we recover the same expression, but with a different interpretation: our model now includes a stochastic variable \(z\), which is <span class="html-tag">&lt;em&gt;</span>latent<span class="html-tag">&lt;/em&gt;</span> (unobserved) <span class="html-tag">&lt;/p&gt;</span></td></tr><tr><td class="line-number" value="307"></td><td class="line-content">						<span class="html-tag">&lt;/div&gt;</span></td></tr><tr><td class="line-number" value="308"></td><td class="line-content">						<span class="html-tag">&lt;div&gt;</span></td></tr><tr><td class="line-number" value="309"></td><td class="line-content">							<span class="html-tag">&lt;img <span class="html-attribute-name">class</span>="<span class="html-attribute-value">fragment noborder</span>" <span class="html-attribute-name">data-fragment-index</span>="<span class="html-attribute-value">1</span>" <span class="html-attribute-name">src</span>="<a class="html-attribute-value html-resource-link" target="_blank" href="https://wouterboomsma.github.io/pml2024/week2/mixture2.svg" rel="noreferrer noopener">mixture2.svg</a>"&gt;</span></td></tr><tr><td class="line-number" value="310"></td><td class="line-content">						<span class="html-tag">&lt;/div&gt;</span></td></tr><tr><td class="line-number" value="311"></td><td class="line-content">					<span class="html-tag">&lt;/div&gt;</span></td></tr><tr><td class="line-number" value="312"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="313"></td><td class="line-content">				<span class="html-tag">&lt;/section&gt;</span></td></tr><tr><td class="line-number" value="314"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="315"></td><td class="line-content">				<span class="html-tag">&lt;section <span class="html-attribute-name">style</span>="<span class="html-attribute-value">font-size:90%</span>"&gt;</span></td></tr><tr><td class="line-number" value="316"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="317"></td><td class="line-content">					<span class="html-tag">&lt;h4&gt;</span>Why do we need latent variables?<span class="html-tag">&lt;/h4&gt;</span></td></tr><tr><td class="line-number" value="318"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="319"></td><td class="line-content">					<span class="html-tag">&lt;div <span class="html-attribute-name">class</span>="<span class="html-attribute-value">container</span>"&gt;</span></td></tr><tr><td class="line-number" value="320"></td><td class="line-content">						<span class="html-tag">&lt;div <span class="html-attribute-name">style</span>="<span class="html-attribute-value">flex-grow:6</span>"&gt;</span></td></tr><tr><td class="line-number" value="321"></td><td class="line-content">							<span class="html-tag">&lt;p&gt;</span>Reasons for introducing latent variables:<span class="html-tag">&lt;/p&gt;</span></td></tr><tr><td class="line-number" value="322"></td><td class="line-content">							<span class="html-tag">&lt;dl&gt;</span></td></tr><tr><td class="line-number" value="323"></td><td class="line-content">								<span class="html-tag">&lt;dt&gt;</span>Artificial variable introduced to facilitate modelling<span class="html-tag">&lt;/dt&gt;</span></td></tr><tr><td class="line-number" value="324"></td><td class="line-content">								<span class="html-tag">&lt;dd&gt;</span>Example: Mixture model<span class="html-tag">&lt;/dd&gt;</span></td></tr><tr><td class="line-number" value="325"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="326"></td><td class="line-content">								<span class="html-tag">&lt;dt <span class="html-attribute-name">style</span>="<span class="html-attribute-value">margin-top:0.5em</span>"&gt;</span>Real quantity that is difficult to measure<span class="html-tag">&lt;/dt&gt;</span></td></tr><tr><td class="line-number" value="327"></td><td class="line-content">								<span class="html-tag">&lt;dd&gt;</span>Example: Underlying causes for disease<span class="html-tag">&lt;/dd&gt;</span></td></tr><tr><td class="line-number" value="328"></td><td class="line-content">							<span class="html-tag">&lt;/dl&gt;</span></td></tr><tr><td class="line-number" value="329"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="330"></td><td class="line-content">						<span class="html-tag">&lt;/div&gt;</span></td></tr><tr><td class="line-number" value="331"></td><td class="line-content">						<span class="html-tag">&lt;div <span class="html-attribute-name">style</span>="<span class="html-attribute-value">text-align: center; margin:0em</span>"&gt;</span></td></tr><tr><td class="line-number" value="332"></td><td class="line-content">							<span class="html-tag">&lt;img <span class="html-attribute-name">style</span>="<span class="html-attribute-value">width:80%; margin-top:-0.5em; padding-top:1em</span>" <span class="html-attribute-name">class</span>="<span class="html-attribute-value">noborder prml</span>" <span class="html-attribute-name">src</span>="<a class="html-attribute-value html-resource-link" target="_blank" href="https://wouterboomsma.github.io/pml2024/prmlfigs-svg/Figure9.4.svg" rel="noreferrer noopener">../prmlfigs-svg/Figure9.4.svg</a>"&gt;</span></td></tr><tr><td class="line-number" value="333"></td><td class="line-content">						<span class="html-tag">&lt;/div&gt;</span></td></tr><tr><td class="line-number" value="334"></td><td class="line-content">					<span class="html-tag">&lt;/div&gt;</span></td></tr><tr><td class="line-number" value="335"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="336"></td><td class="line-content">					<span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">fragment</span>"&gt;</span></td></tr><tr><td class="line-number" value="337"></td><td class="line-content">						<span class="html-tag">&lt;p&gt;</span>Types of latent variables:<span class="html-tag">&lt;/p&gt;</span></td></tr><tr><td class="line-number" value="338"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="339"></td><td class="line-content">						<span class="html-tag">&lt;dl <span class="html-attribute-name">style</span>="<span class="html-attribute-value">width:100%</span>"&gt;</span></td></tr><tr><td class="line-number" value="340"></td><td class="line-content">							<span class="html-tag">&lt;dt&gt;</span>Discrete (e.g. mixture models)<span class="html-tag">&lt;/dt&gt;</span></td></tr><tr><td class="line-number" value="341"></td><td class="line-content">							<span class="html-tag">&lt;dd&gt;</span>Structuring observations/features in groups/clusters<span class="html-tag">&lt;/dd&gt;</span></td></tr><tr><td class="line-number" value="342"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="343"></td><td class="line-content">							<span class="html-tag">&lt;dt <span class="html-attribute-name">style</span>="<span class="html-attribute-value">margin-top:0.5em</span>"&gt;</span>Continuous (PCA, factor analysis, variational autoencoders)<span class="html-tag">&lt;/dt&gt;</span></td></tr><tr><td class="line-number" value="344"></td><td class="line-content">							<span class="html-tag">&lt;dd&gt;</span>Dimensionality reduction / representation learning<span class="html-tag">&lt;/dd&gt;</span></td></tr><tr><td class="line-number" value="345"></td><td class="line-content">						<span class="html-tag">&lt;/dl&gt;</span></td></tr><tr><td class="line-number" value="346"></td><td class="line-content">					<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="347"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="348"></td><td class="line-content">				<span class="html-tag">&lt;/section&gt;</span></td></tr><tr><td class="line-number" value="349"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="350"></td><td class="line-content">					<span class="html-tag">&lt;section&gt;</span></td></tr><tr><td class="line-number" value="351"></td><td class="line-content">					<span class="html-tag">&lt;h4&gt;</span>Sampling from a mixture model<span class="html-tag">&lt;/h4&gt;</span></td></tr><tr><td class="line-number" value="352"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="353"></td><td class="line-content">					<span class="html-tag">&lt;div <span class="html-attribute-name">class</span>="<span class="html-attribute-value">container</span>"&gt;</span></td></tr><tr><td class="line-number" value="354"></td><td class="line-content">						<span class="html-tag">&lt;div <span class="html-attribute-name">style</span>="<span class="html-attribute-value">flex-grow:5.0</span>"&gt;</span></td></tr><tr><td class="line-number" value="355"></td><td class="line-content">							<span class="html-tag">&lt;p&gt;</span>The factorization depicted in the graphical model suggests how we can sample from the model:<span class="html-tag">&lt;/p&gt;</span></td></tr><tr><td class="line-number" value="356"></td><td class="line-content">							<span class="html-tag">&lt;ol&gt;</span></td></tr><tr><td class="line-number" value="357"></td><td class="line-content">								<span class="html-tag">&lt;li&gt;</span>Draw a sample \(z\) from \(p(z)\)<span class="html-tag">&lt;/li&gt;</span></td></tr><tr><td class="line-number" value="358"></td><td class="line-content">								<span class="html-tag">&lt;li&gt;</span>Draw a sample \(x\) from \(p(x | z)\)<span class="html-tag">&lt;/li&gt;</span></td></tr><tr><td class="line-number" value="359"></td><td class="line-content">							<span class="html-tag">&lt;/ol&gt;</span></td></tr><tr><td class="line-number" value="360"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="361"></td><td class="line-content">							<span class="html-tag">&lt;p&gt;</span>(a simple example of <span class="html-tag">&lt;em&gt;</span>ancestral sampling<span class="html-tag">&lt;/em&gt;</span>)<span class="html-tag">&lt;/p&gt;</span></td></tr><tr><td class="line-number" value="362"></td><td class="line-content">						<span class="html-tag">&lt;/div&gt;</span></td></tr><tr><td class="line-number" value="363"></td><td class="line-content">						<span class="html-tag">&lt;div <span class="html-attribute-name">style</span>="<span class="html-attribute-value">text-align: center; margin:1em</span>"&gt;</span></td></tr><tr><td class="line-number" value="364"></td><td class="line-content">							<span class="html-tag">&lt;img <span class="html-attribute-name">style</span>="<span class="html-attribute-value">width:60%; margin-top:-0.5em; padding-top:1em</span>" <span class="html-attribute-name">class</span>="<span class="html-attribute-value">noborder prml</span>" <span class="html-attribute-name">src</span>="<a class="html-attribute-value html-resource-link" target="_blank" href="https://wouterboomsma.github.io/pml2024/prmlfigs-svg/Figure9.4.svg" rel="noreferrer noopener">../prmlfigs-svg/Figure9.4.svg</a>"&gt;</span></td></tr><tr><td class="line-number" value="365"></td><td class="line-content">						<span class="html-tag">&lt;/div&gt;</span></td></tr><tr><td class="line-number" value="366"></td><td class="line-content">					<span class="html-tag">&lt;/div&gt;</span></td></tr><tr><td class="line-number" value="367"></td><td class="line-content">						<span class="html-tag">&lt;img <span class="html-attribute-name">style</span>="<span class="html-attribute-value">width:50%; float:right</span>" <span class="html-attribute-name">class</span>="<span class="html-attribute-value">noborder fragment</span>" <span class="html-attribute-name">src</span>="<a class="html-attribute-value html-resource-link" target="_blank" href="https://wouterboomsma.github.io/pml2024/week2/mixture2.svg" rel="noreferrer noopener">mixture2.svg</a>"&gt;</span></td></tr><tr><td class="line-number" value="368"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="369"></td><td class="line-content">				<span class="html-tag">&lt;/section&gt;</span></td></tr><tr><td class="line-number" value="370"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="371"></td><td class="line-content">				<span class="html-tag">&lt;section <span class="html-attribute-name">style</span>="<span class="html-attribute-value">font-size:85%</span>"&gt;</span></td></tr><tr><td class="line-number" value="372"></td><td class="line-content">					<span class="html-tag">&lt;h4&gt;</span>Which component is responsible for a given \(x\)?<span class="html-tag">&lt;/h4&gt;</span></td></tr><tr><td class="line-number" value="373"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="374"></td><td class="line-content">					<span class="html-tag">&lt;div <span class="html-attribute-name">class</span>="<span class="html-attribute-value">container</span>"&gt;</span></td></tr><tr><td class="line-number" value="375"></td><td class="line-content">						<span class="html-tag">&lt;div <span class="html-attribute-name">style</span>="<span class="html-attribute-value">flex-grow:1.5</span>"&gt;</span></td></tr><tr><td class="line-number" value="376"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="377"></td><td class="line-content">							<span class="html-tag">&lt;p&gt;</span>We can use Bayes rule to evaluate the probability \(p(z_k=1 | \boldsymbol x)\)<span class="html-tag">&lt;/p&gt;</span></td></tr><tr><td class="line-number" value="378"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="379"></td><td class="line-content">							\[\begin{align*}p(z_k=1 | \boldsymbol x) &amp;= \frac{p(\boldsymbol x | z_k=1)p(z_k=1)}{p(\boldsymbol x)} \\</td></tr><tr><td class="line-number" value="380"></td><td class="line-content">						&amp;=\frac{\mathcal{N}(\boldsymbol x | \boldsymbol \mu_k, \boldsymbol \Sigma_k) \pi_k}{\sum_{j=1}^K \mathcal{N}(\boldsymbol x | \boldsymbol \mu_j, \boldsymbol \Sigma_j) \pi_j}\end{align*}\]</td></tr><tr><td class="line-number" value="381"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="382"></td><td class="line-content">							<span class="html-tag">&lt;p&gt;</span>These are referred to as the <span class="html-tag">&lt;em&gt;</span>responsibilities<span class="html-tag">&lt;/em&gt;</span>, \(\gamma(z_k)\), of component \(k\) to an observation \(x\).<span class="html-tag">&lt;/p&gt;</span></td></tr><tr><td class="line-number" value="383"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="384"></td><td class="line-content">							<span class="html-tag">&lt;p <span class="html-attribute-name">class</span>="<span class="html-attribute-value">fragment</span>"&gt;</span>Note that we can evaluate the normalization constant \(p(\boldsymbol x)\), because \(z\) is discrete.<span class="html-tag">&lt;/p&gt;</span></td></tr><tr><td class="line-number" value="385"></td><td class="line-content">						<span class="html-tag">&lt;/div&gt;</span></td></tr><tr><td class="line-number" value="386"></td><td class="line-content">						<span class="html-tag">&lt;div <span class="html-attribute-name">class</span>="<span class="html-attribute-value">fragment</span>" <span class="html-attribute-name">style</span>="<span class="html-attribute-value">text-align: center; margin:0em</span>"&gt;</span></td></tr><tr><td class="line-number" value="387"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="388"></td><td class="line-content">							<span class="html-tag">&lt;img <span class="html-attribute-name">style</span>="<span class="html-attribute-value">width:100%; margin-bottom:1em;</span>" <span class="html-attribute-name">class</span>="<span class="html-attribute-value">noborder</span>" <span class="html-attribute-name">src</span>="<a class="html-attribute-value html-resource-link" target="_blank" href="https://wouterboomsma.github.io/pml2024/week2/mixture_2d_2.svg" rel="noreferrer noopener">mixture_2d_2.svg</a>"&gt;</span></td></tr><tr><td class="line-number" value="389"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="390"></td><td class="line-content">							<span class="html-tag">&lt;span <span class="html-attribute-name">style</span>="<span class="html-attribute-value">font-size:80%; </span>"&gt;</span>\(p(z_k = 1 | x) \) for \(k=1\) (the orange cluster):<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="391"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="392"></td><td class="line-content">							<span class="html-tag">&lt;img <span class="html-attribute-name">style</span>="<span class="html-attribute-value">width:100%; </span>" <span class="html-attribute-name">class</span>="<span class="html-attribute-value">noborder</span>" <span class="html-attribute-name">src</span>="<a class="html-attribute-value html-resource-link" target="_blank" href="https://wouterboomsma.github.io/pml2024/week2/mixture_2d_responsibilities_k1.svg" rel="noreferrer noopener">mixture_2d_responsibilities_k1.svg</a>"&gt;</span></td></tr><tr><td class="line-number" value="393"></td><td class="line-content">						<span class="html-tag">&lt;/div&gt;</span></td></tr><tr><td class="line-number" value="394"></td><td class="line-content">					<span class="html-tag">&lt;/div&gt;</span></td></tr><tr><td class="line-number" value="395"></td><td class="line-content">				<span class="html-tag">&lt;/section&gt;</span></td></tr><tr><td class="line-number" value="396"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="397"></td><td class="line-content">				<span class="html-tag">&lt;section <span class="html-attribute-name">style</span>="<span class="html-attribute-value">font-size:75%</span>"&gt;</span></td></tr><tr><td class="line-number" value="398"></td><td class="line-content">					<span class="html-tag">&lt;h2&gt;</span>Parameter estimation in mixture models<span class="html-tag">&lt;/h2&gt;</span></td></tr><tr><td class="line-number" value="399"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="400"></td><td class="line-content">					<span class="html-tag">&lt;div <span class="html-attribute-name">class</span>="<span class="html-attribute-value">container</span>"&gt;</span></td></tr><tr><td class="line-number" value="401"></td><td class="line-content">						<span class="html-tag">&lt;div <span class="html-attribute-name">style</span>="<span class="html-attribute-value">flex-grow:2.0</span>"&gt;</span></td></tr><tr><td class="line-number" value="402"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="403"></td><td class="line-content">							<span class="html-tag">&lt;p&gt;</span>Log-likelihood for \(N \times D\) data matrix \(\boldsymbol X\):<span class="html-tag">&lt;/p&gt;</span></td></tr><tr><td class="line-number" value="404"></td><td class="line-content">					\[\ln p(\boldsymbol X | \boldsymbol \pi, \boldsymbol \mu, \boldsymbol \Sigma) = \sum_{n=1}^N \ln \left ( \sum_{k=1}^K \mathcal{N}(\boldsymbol x_n | \boldsymbol \mu_k, \boldsymbol \Sigma_k) \pi_k \right )\]</td></tr><tr><td class="line-number" value="405"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="406"></td><td class="line-content">							<span class="html-tag">&lt;p&gt;</span>We would like to maximize this wrt \(\boldsymbol \pi, \boldsymbol \mu, \boldsymbol \Sigma\). Unfortunately, unlike the Gaussian itself, we cannot optimize this in closed form (due to the sum inside the \(\ln\)).</td></tr><tr><td class="line-number" value="407"></td><td class="line-content">						<span class="html-tag">&lt;a <span class="html-attribute-name">onclick</span>="<span class="html-attribute-value">$(this.parentElement.parentElement).find('div.popup').toggle()</span>" <span class="html-attribute-name">class</span>="<span class="html-attribute-value">popup-q</span>"&gt;</span>?<span class="html-tag">&lt;/a&gt;</span></td></tr><tr><td class="line-number" value="408"></td><td class="line-content">							<span class="html-tag">&lt;div <span class="html-attribute-name">class</span>="<span class="html-attribute-value">popup</span>"&gt;</span></td></tr><tr><td class="line-number" value="409"></td><td class="line-content">								<span class="html-tag">&lt;div <span class="html-attribute-name">onclick</span>="<span class="html-attribute-value">$(this.parentElement).toggle()</span>" <span class="html-attribute-name">class</span>="<span class="html-attribute-value">popup-close</span>"&gt;</span>×<span class="html-tag">&lt;/div&gt;</span></td></tr><tr><td class="line-number" value="410"></td><td class="line-content">								<span class="html-tag">&lt;p&gt;</span></td></tr><tr><td class="line-number" value="411"></td><td class="line-content">									One of the reasons we typically consider the log likelihood is that the log cancels with the exp.</td></tr><tr><td class="line-number" value="412"></td><td class="line-content">								<span class="html-tag">&lt;/p&gt;</span></td></tr><tr><td class="line-number" value="413"></td><td class="line-content">							<span class="html-tag">&lt;/div&gt;</span></td></tr><tr><td class="line-number" value="414"></td><td class="line-content">							<span class="html-tag">&lt;/p&gt;</span></td></tr><tr><td class="line-number" value="415"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="416"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="417"></td><td class="line-content">							<span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">fragment</span>" <span class="html-attribute-name">data-fragment-index</span>="<span class="html-attribute-value">1</span>"&gt;</span></td></tr><tr><td class="line-number" value="418"></td><td class="line-content">							<span class="html-tag">&lt;p&gt;</span>Life would be easier if we had observed all \(z_n\):<span class="html-tag">&lt;/p&gt;</span></td></tr><tr><td class="line-number" value="419"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="420"></td><td class="line-content">							\[p(\boldsymbol X, \boldsymbol Z | \boldsymbol \pi, \boldsymbol \mu, \boldsymbol \Sigma) = \prod_{n=1}^N \prod_{k=1}^K \mathcal{N}(\boldsymbol x_n | \boldsymbol \mu_k, \boldsymbol \Sigma_k)^{z_{nk}} \pi_k^{z_{nk}}  \]</td></tr><tr><td class="line-number" value="421"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="422"></td><td class="line-content">							\[\ln p(\boldsymbol X, \boldsymbol Z | \boldsymbol \pi, \boldsymbol \mu, \boldsymbol \Sigma) = \sum_{n=1}^N \sum_{k=1}^K z_{nk} \ln \left ( \mathcal{N}(\boldsymbol x_n | \boldsymbol \mu_k, \boldsymbol \Sigma_k) \pi_k \right )\]</td></tr><tr><td class="line-number" value="423"></td><td class="line-content">							<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="424"></td><td class="line-content">						<span class="html-tag">&lt;/div&gt;</span></td></tr><tr><td class="line-number" value="425"></td><td class="line-content">						<span class="html-tag">&lt;div <span class="html-attribute-name">style</span>="<span class="html-attribute-value">margin-left:0.5em;</span>"&gt;</span></td></tr><tr><td class="line-number" value="426"></td><td class="line-content">							<span class="html-tag">&lt;img <span class="html-attribute-name">style</span>="<span class="html-attribute-value">width:100%; margin-top:1em</span>" <span class="html-attribute-name">class</span>="<span class="html-attribute-value">noborder prml</span>" <span class="html-attribute-name">src</span>="<a class="html-attribute-value html-resource-link" target="_blank" href="https://wouterboomsma.github.io/pml2024/prmlfigs-svg/Figure9.6.svg" rel="noreferrer noopener">../prmlfigs-svg/Figure9.6.svg</a>"&gt;</span></td></tr><tr><td class="line-number" value="427"></td><td class="line-content">							<span class="html-tag">&lt;img <span class="html-attribute-name">class</span>="<span class="html-attribute-value">fragment noborder prml</span>" <span class="html-attribute-name">data-fragment-index</span>="<span class="html-attribute-value">1</span>" <span class="html-attribute-name">style</span>="<span class="html-attribute-value">width:100%; margin-top:2em</span>" <span class="html-attribute-name">src</span>="<a class="html-attribute-value html-resource-link" target="_blank" href="https://wouterboomsma.github.io/pml2024/prmlfigs-svg/Figure9.9.svg" rel="noreferrer noopener">../prmlfigs-svg/Figure9.9.svg</a>"&gt;</span></td></tr><tr><td class="line-number" value="428"></td><td class="line-content">						<span class="html-tag">&lt;/div&gt;</span></td></tr><tr><td class="line-number" value="429"></td><td class="line-content">					<span class="html-tag">&lt;/div&gt;</span></td></tr><tr><td class="line-number" value="430"></td><td class="line-content">				<span class="html-tag">&lt;/section&gt;</span></td></tr><tr><td class="line-number" value="431"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="432"></td><td class="line-content">				<span class="html-tag">&lt;section <span class="html-attribute-name">style</span>="<span class="html-attribute-value">font-size:90%</span>"&gt;</span></td></tr><tr><td class="line-number" value="433"></td><td class="line-content">					<span class="html-tag">&lt;h4&gt;</span>Expectation Maximization (idea)<span class="html-tag">&lt;/h4&gt;</span></td></tr><tr><td class="line-number" value="434"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="435"></td><td class="line-content">					<span class="html-tag">&lt;p&gt;</span>The complete-data case had a convenient form<span class="html-tag">&lt;/p&gt;</span></td></tr><tr><td class="line-number" value="436"></td><td class="line-content">					\[\ln p(\boldsymbol X, \boldsymbol Z | \boldsymbol \pi, \boldsymbol \mu, \boldsymbol \Sigma) = \sum_{n=1}^N \sum_{k=1}^K z_{nk} \ln \left ( \mathcal{N}(\boldsymbol x_n | \boldsymbol \mu_k, \boldsymbol \Sigma_k) \pi_k \right )\]</td></tr><tr><td class="line-number" value="437"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="438"></td><td class="line-content">					<span class="html-tag">&lt;p&gt;</span>But we don't know \(z_{nk}\). <span class="html-tag">&lt;/p&gt;</span></td></tr><tr><td class="line-number" value="439"></td><td class="line-content">					<span class="html-tag">&lt;dl <span class="html-attribute-name">style</span>="<span class="html-attribute-value">margin-left:0</span>"&gt;</span></td></tr><tr><td class="line-number" value="440"></td><td class="line-content">						<span class="html-tag">&lt;dt&gt;</span>Idea:<span class="html-tag">&lt;/dt&gt;</span></td></tr><tr><td class="line-number" value="441"></td><td class="line-content">						<span class="html-tag">&lt;dd&gt;</span></td></tr><tr><td class="line-number" value="442"></td><td class="line-content">							<span class="html-tag">&lt;ul&gt;</span></td></tr><tr><td class="line-number" value="443"></td><td class="line-content">								<span class="html-tag">&lt;li&gt;</span>For any choice of values for \(\boldsymbol \pi_0, \boldsymbol \mu_0, \boldsymbol \Sigma_0\), we can calculate a posterior distribution  \(p(\boldsymbol Z | \boldsymbol X, \boldsymbol \pi_0, \boldsymbol \mu_0, \boldsymbol \Sigma_0) \)<span class="html-tag">&lt;/li&gt;</span></td></tr><tr><td class="line-number" value="444"></td><td class="line-content">								<span class="html-tag">&lt;li <span class="html-attribute-name">class</span>="<span class="html-attribute-value">fragment</span>"&gt;</span>We can then calculate the expectation \(\mathbb{E}_{\boldsymbol Z} \left [ \ln p(\boldsymbol X, \boldsymbol Z | \boldsymbol \pi, \boldsymbol \mu, \boldsymbol \Sigma) \right ]\) under \(p(\boldsymbol Z | \boldsymbol X, \boldsymbol \pi_0, \boldsymbol \mu_0, \boldsymbol \Sigma_0) \).<span class="html-tag">&lt;/li&gt;</span></td></tr><tr><td class="line-number" value="445"></td><td class="line-content">								<span class="html-tag">&lt;li <span class="html-attribute-name">class</span>="<span class="html-attribute-value">fragment</span>"&gt;</span>We can now maximize \(\mathbb{E}_{\boldsymbol Z} \left [ \ln p(\boldsymbol X, \boldsymbol Z | \boldsymbol \pi, \boldsymbol \mu, \boldsymbol \Sigma) \right ]\) wrt \(\boldsymbol \pi, \boldsymbol \mu, \boldsymbol \Sigma\)<span class="html-tag">&lt;/li&gt;</span></td></tr><tr><td class="line-number" value="446"></td><td class="line-content">							<span class="html-tag">&lt;/ul&gt;</span></td></tr><tr><td class="line-number" value="447"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="448"></td><td class="line-content">						<span class="html-tag">&lt;/dd&gt;</span></td></tr><tr><td class="line-number" value="449"></td><td class="line-content">				<span class="html-tag">&lt;/dl&gt;</span></td></tr><tr><td class="line-number" value="450"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="451"></td><td class="line-content"><span class="html-comment">&lt;!--						use the expectation, \(\mathbb{E}_{\boldsymbol Z} \left [ \ln p(\boldsymbol X, \boldsymbol Z | \boldsymbol \pi, \boldsymbol \mu, \boldsymbol \Sigma) \right ]\), using our current best estimate of &lt;/p&gt;--&gt;</span></td></tr><tr><td class="line-number" value="452"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="453"></td><td class="line-content"><span class="html-comment">&lt;!--					&lt;ol start="0"&gt;--&gt;</span></td></tr><tr><td class="line-number" value="454"></td><td class="line-content"><span class="html-comment">&lt;!--						&lt;li&gt;For choice of values for \(\boldsymbol \pi, \boldsymbol \mu, \boldsymbol \Sigma\), we can calculate a posterior distribution  \(p(\boldsymbol Z | \boldsymbol X, \boldsymbol \pi, \boldsymbol \mu, \boldsymbol \Sigma) \)--&gt;</span></td></tr><tr><td class="line-number" value="455"></td><td class="line-content"><span class="html-comment">&lt;!--							--&gt;</span></td></tr><tr><td class="line-number" value="456"></td><td class="line-content"><span class="html-comment">&lt;!--							--&gt;</span></td></tr><tr><td class="line-number" value="457"></td><td class="line-content"><span class="html-comment">&lt;!--							we can calculate the expectation of \ln p(\boldsymbol X, \boldsymbol Z | \boldsymbol \pi, \boldsymbol \mu, \boldsymbol \Sigma)&lt;/li&gt;--&gt;</span></td></tr><tr><td class="line-number" value="458"></td><td class="line-content"><span class="html-comment">&lt;!--					&lt;/ol&gt;--&gt;</span></td></tr><tr><td class="line-number" value="459"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="460"></td><td class="line-content">				<span class="html-tag">&lt;/section&gt;</span></td></tr><tr><td class="line-number" value="461"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="462"></td><td class="line-content">				<span class="html-tag">&lt;section <span class="html-attribute-name">style</span>="<span class="html-attribute-value">font-size:90%</span>"&gt;</span></td></tr><tr><td class="line-number" value="463"></td><td class="line-content">					<span class="html-tag">&lt;h4&gt;</span>Expectation Maximization<span class="html-tag">&lt;/h4&gt;</span></td></tr><tr><td class="line-number" value="464"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="465"></td><td class="line-content">					<span class="html-tag">&lt;dl&gt;</span></td></tr><tr><td class="line-number" value="466"></td><td class="line-content">						<span class="html-tag">&lt;dt&gt;</span>Procedure:<span class="html-tag">&lt;/dt&gt;</span></td></tr><tr><td class="line-number" value="467"></td><td class="line-content">						<span class="html-tag">&lt;dd&gt;</span></td></tr><tr><td class="line-number" value="468"></td><td class="line-content">							<span class="html-tag">&lt;ol <span class="html-attribute-name">start</span>="<span class="html-attribute-value">0</span>"&gt;</span></td></tr><tr><td class="line-number" value="469"></td><td class="line-content">								<span class="html-tag">&lt;li&gt;</span>\(\text{initialize}~\boldsymbol \pi_0, \boldsymbol \mu_0, \boldsymbol \Sigma_0\) (e.g. randomly)</td></tr><tr><td class="line-number" value="470"></td><td class="line-content">									<span class="html-tag">&lt;br&gt;</span>\(t \leftarrow 0\)</td></tr><tr><td class="line-number" value="471"></td><td class="line-content">									<span class="html-tag">&lt;br&gt;</span>\(\text{while}~\text{not}~\mathit{converged}: \)</td></tr><tr><td class="line-number" value="472"></td><td class="line-content">									<span class="html-tag">&lt;br&gt;</span>\(\hspace*{1em}t \leftarrow t+1\)</td></tr><tr><td class="line-number" value="473"></td><td class="line-content">								<span class="html-tag">&lt;/li&gt;</span></td></tr><tr><td class="line-number" value="474"></td><td class="line-content">								<span class="html-tag">&lt;li&gt;</span>\(\hspace*{1em}\underbrace{\text{calculate}~\mathbb{E}_{\boldsymbol Z} \left [ \ln p(\boldsymbol X, \boldsymbol Z | \boldsymbol \pi, \boldsymbol \mu, \boldsymbol \Sigma) \right ]~\text{under}~p(\boldsymbol Z | \boldsymbol X, \boldsymbol \pi_{t-1}, \boldsymbol \mu_{t-1}, \boldsymbol \Sigma_{t-1})}_{\text{Expectation step}} \)<span class="html-tag">&lt;/li&gt;</span></td></tr><tr><td class="line-number" value="475"></td><td class="line-content">								<span class="html-tag">&lt;li&gt;</span>\(\hspace*{1em}\underbrace{(\boldsymbol \pi_t, \boldsymbol \mu_t, \boldsymbol \Sigma_t) \leftarrow \underset{(\boldsymbol \pi, \boldsymbol \mu, \boldsymbol \Sigma)}{\mathrm{argmax}} \left(  \mathbb{E}_{\boldsymbol Z} \left [ \ln p(\boldsymbol X, \boldsymbol Z | \boldsymbol \pi, \boldsymbol \mu, \boldsymbol \Sigma) \right ] \right)}_{\text{Maximization step}} \)<span class="html-tag">&lt;/li&gt;</span></td></tr><tr><td class="line-number" value="476"></td><td class="line-content">							<span class="html-tag">&lt;/ol&gt;</span></td></tr><tr><td class="line-number" value="477"></td><td class="line-content">						<span class="html-tag">&lt;/dd&gt;</span></td></tr><tr><td class="line-number" value="478"></td><td class="line-content">					<span class="html-tag">&lt;/dl&gt;</span></td></tr><tr><td class="line-number" value="479"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="480"></td><td class="line-content">					<span class="html-tag">&lt;p&gt;</span>Let's take a closer look at these steps.<span class="html-tag">&lt;/p&gt;</span></td></tr><tr><td class="line-number" value="481"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="482"></td><td class="line-content">				<span class="html-tag">&lt;/section&gt;</span></td></tr><tr><td class="line-number" value="483"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="484"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="485"></td><td class="line-content">				<span class="html-tag">&lt;section <span class="html-attribute-name">style</span>="<span class="html-attribute-value">font-size:85%</span>"&gt;</span></td></tr><tr><td class="line-number" value="486"></td><td class="line-content">					<span class="html-tag">&lt;h3&gt;</span>E-step<span class="html-tag">&lt;/h3&gt;</span></td></tr><tr><td class="line-number" value="487"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="488"></td><td class="line-content"><span class="html-comment">&lt;!--					\(\text{calculate}~\mathbb{E}_{\boldsymbol Z} \left [ \ln p(\boldsymbol X, \boldsymbol Z | \boldsymbol \pi, \boldsymbol \mu, \boldsymbol \Sigma) \right ]~\text{under}~p(\boldsymbol Z | \boldsymbol X, \boldsymbol \pi_{t-1}, \boldsymbol \mu_{t-1}, \boldsymbol \Sigma_{t-1}) \)--&gt;</span></td></tr><tr><td class="line-number" value="489"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="490"></td><td class="line-content">					<span class="html-tag">&lt;p&gt;</span>The expectation goes inside the sum:<span class="html-tag">&lt;/p&gt;</span></td></tr><tr><td class="line-number" value="491"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="492"></td><td class="line-content">					\[\mathbb{E}_{\boldsymbol Z} \left [ \ln p(\boldsymbol X, \boldsymbol Z | \boldsymbol \pi, \boldsymbol \mu, \boldsymbol \Sigma) \right ] = \sum_{n=1}^N \sum_{k=1}^K \mathbb{E}_{\boldsymbol Z}[z_{nk}] \ln \left ( \mathcal{N}(\boldsymbol x_n | \boldsymbol \mu_k, \boldsymbol \Sigma_k) \pi_k \right )\]</td></tr><tr><td class="line-number" value="493"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="494"></td><td class="line-content">					<span class="html-tag">&lt;p&gt;</span>The expectation of the binary indicator variable \(z_{nk}\) is its probability:<span class="html-tag">&lt;/p&gt;</span></td></tr><tr><td class="line-number" value="495"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="496"></td><td class="line-content">					\[\begin{align*}\mathbb{E}_{\boldsymbol Z}[z_{nk}] &amp;= p(z_{nk}=1 | \boldsymbol x_n, \boldsymbol \mu, \boldsymbol \Sigma) \\</td></tr><tr><td class="line-number" value="497"></td><td class="line-content">					&amp;= \frac{p(\boldsymbol x_n | z_{nk}, \boldsymbol \mu, \boldsymbol \Sigma)p(z_{nk}) }{p(\boldsymbol x_n)} = \frac{\mathcal{N}(\boldsymbol x_n | \boldsymbol \mu_k, \boldsymbol \Sigma_k)\pi_k}{\sum_j^K \mathcal{N}(\boldsymbol x_n | \boldsymbol \mu_j, \boldsymbol \Sigma_j)\pi_j} = \gamma(z_{nk})</td></tr><tr><td class="line-number" value="498"></td><td class="line-content">					\end{align*}\]</td></tr><tr><td class="line-number" value="499"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="500"></td><td class="line-content">					<span class="html-tag">&lt;p&gt;</span>So, we see that \(\mathbb{E}_{\boldsymbol Z}[z_{nk}]\) is simply the responsibility of component \(k\) to datapoint \(x_n\).<span class="html-tag">&lt;/p&gt;</span></td></tr><tr><td class="line-number" value="501"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="502"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="503"></td><td class="line-content">					<span class="html-tag">&lt;aside <span class="html-attribute-name">class</span>="<span class="html-attribute-value">notes</span>"&gt;</span>Note that z_{nk} is non-zero only for one entry in the last sum.<span class="html-tag">&lt;/aside&gt;</span></td></tr><tr><td class="line-number" value="504"></td><td class="line-content">				<span class="html-tag">&lt;/section&gt;</span></td></tr><tr><td class="line-number" value="505"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="506"></td><td class="line-content">				<span class="html-tag">&lt;section <span class="html-attribute-name">style</span>="<span class="html-attribute-value">font-size:85%</span>"&gt;</span></td></tr><tr><td class="line-number" value="507"></td><td class="line-content">					<span class="html-tag">&lt;h3&gt;</span>M-step<span class="html-tag">&lt;/h3&gt;</span></td></tr><tr><td class="line-number" value="508"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="509"></td><td class="line-content">					<span class="html-tag">&lt;p <span class="html-attribute-name">style</span>="<span class="html-attribute-value">margin-bottom:-0.5em;</span>" &gt;</span>Now we just need to optimize:<span class="html-tag">&lt;/p&gt;</span></td></tr><tr><td class="line-number" value="510"></td><td class="line-content">					\[\mathbb{E}_{\boldsymbol Z} \left [ \ln p(\boldsymbol X, \boldsymbol Z | \boldsymbol \pi, \boldsymbol \mu, \boldsymbol \Sigma) \right ] = \sum_{n=1}^N \sum_{k=1}^K \gamma(z_{nk}) \underbrace{\ln ( \mathcal{N}(\boldsymbol x_n | \boldsymbol \mu_k, \boldsymbol \Sigma_k) \pi_k )}_{\ln \mathcal{N}(\boldsymbol x_n | \boldsymbol \mu_k, \boldsymbol \Sigma_k) + \ln(\pi_k )} =: f(\boldsymbol \mu, \boldsymbol \Sigma, \boldsymbol \pi)\]</td></tr><tr><td class="line-number" value="511"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="512"></td><td class="line-content">					<span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">fragment</span>"&gt;</span></td></tr><tr><td class="line-number" value="513"></td><td class="line-content">					<span class="html-tag">&lt;p <span class="html-attribute-name">style</span>="<span class="html-attribute-value">margin-bottom:-0.0em; margin-top:-0.0em</span>"&gt;</span>Considering single component \(\mu_k\). Set derivative to zero:<span class="html-tag">&lt;/p&gt;</span></td></tr><tr><td class="line-number" value="514"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="515"></td><td class="line-content">					\[\begin{align*}\frac{\partial f}{\partial \boldsymbol \mu_k} &amp;= \sum_{n=1}^N \gamma(z_{nk})  \frac{\partial}{\partial \boldsymbol \mu_k}(\mathcal{N}(\boldsymbol x_n | \boldsymbol \mu_k, \boldsymbol \Sigma_k)) \\[-0.5em]</td></tr><tr><td class="line-number" value="516"></td><td class="line-content">					&amp;= \sum_{n=1}^N \gamma(z_{nk})  \frac{\partial}{\partial \boldsymbol \mu_k}\left(\frac{1}{2}(\boldsymbol x_n - \mu_k)^T\Sigma_k^{-1}(\boldsymbol x_n - \mu_k)\right) = \sum_{n=1}^N \gamma(z_{nk}) \overbrace{ \Sigma_k^{-1} (\boldsymbol x_n - \boldsymbol \mu_k)}^{\text{Matrix cookbook: eq 86}}\\[1em]</td></tr><tr><td class="line-number" value="517"></td><td class="line-content">					\end{align*}\]</td></tr><tr><td class="line-number" value="518"></td><td class="line-content">					<span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">fragment</span>"&gt;</span></td></tr><tr><td class="line-number" value="519"></td><td class="line-content">					Setting to zero:</td></tr><tr><td class="line-number" value="520"></td><td class="line-content">					\[\begin{align*} \sum_{n=1}^N \gamma(z_{nk}) \Sigma_k^{-1} (\boldsymbol x_n - \boldsymbol \mu_k) = 0 \hspace{1em} \Rightarrow \hspace{1em} \boldsymbol \mu_k = \underbrace{\frac{1}{\sum_{n=1}^N \gamma(z_{nk})}}_{\text{Effective \#datapoints}\atop\text{in cluster } k}\sum_{n=1}^N \gamma(z_{nk}) \boldsymbol x_n \end{align*}\]</td></tr><tr><td class="line-number" value="521"></td><td class="line-content">					<span class="html-tag">&lt;p&gt;</span>similar for the other parameters<span class="html-tag">&lt;/p&gt;</span></td></tr><tr><td class="line-number" value="522"></td><td class="line-content">					<span class="html-tag">&lt;/span&gt;</span>						</td></tr><tr><td class="line-number" value="523"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="524"></td><td class="line-content">					<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="525"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="526"></td><td class="line-content">					<span class="html-tag">&lt;aside <span class="html-attribute-name">class</span>="<span class="html-attribute-value">notes</span>"&gt;</span>Logarithm splits into sum so \pi_k disappears<span class="html-tag">&lt;/aside&gt;</span></td></tr><tr><td class="line-number" value="527"></td><td class="line-content">				<span class="html-tag">&lt;/section&gt;</span></td></tr><tr><td class="line-number" value="528"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="529"></td><td class="line-content">				<span class="html-tag">&lt;section <span class="html-attribute-name">style</span>="<span class="html-attribute-value">font-size:85%</span>"&gt;</span></td></tr><tr><td class="line-number" value="530"></td><td class="line-content">					<span class="html-tag">&lt;h3&gt;</span>EM illustration<span class="html-tag">&lt;/h3&gt;</span></td></tr><tr><td class="line-number" value="531"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="532"></td><td class="line-content">					<span class="html-tag">&lt;div <span class="html-attribute-name">style</span>="<span class="html-attribute-value">width:100%</span>"&gt;</span></td></tr><tr><td class="line-number" value="533"></td><td class="line-content">					<span class="html-tag">&lt;img <span class="html-attribute-name">class</span>="<span class="html-attribute-value">prml</span>" <span class="html-attribute-name">style</span>="<span class="html-attribute-value">width:30%</span>" <span class="html-attribute-name">src</span>="<a class="html-attribute-value html-resource-link" target="_blank" href="https://wouterboomsma.github.io/pml2024/prmlfigs-svg/Figure9.8a.svg" rel="noreferrer noopener">../prmlfigs-svg/Figure9.8a.svg</a>"&gt;</span></td></tr><tr><td class="line-number" value="534"></td><td class="line-content">					<span class="html-tag">&lt;img <span class="html-attribute-name">class</span>="<span class="html-attribute-value">prml fragment</span>" <span class="html-attribute-name">style</span>="<span class="html-attribute-value">width:30%</span>" <span class="html-attribute-name">src</span>="<a class="html-attribute-value html-resource-link" target="_blank" href="https://wouterboomsma.github.io/pml2024/prmlfigs-svg/Figure9.8b.svg" rel="noreferrer noopener">../prmlfigs-svg/Figure9.8b.svg</a>"&gt;</span></td></tr><tr><td class="line-number" value="535"></td><td class="line-content">					<span class="html-tag">&lt;img <span class="html-attribute-name">class</span>="<span class="html-attribute-value">prml fragment</span>" <span class="html-attribute-name">style</span>="<span class="html-attribute-value">width:30%</span>" <span class="html-attribute-name">src</span>="<a class="html-attribute-value html-resource-link" target="_blank" href="https://wouterboomsma.github.io/pml2024/prmlfigs-svg/Figure9.8c.svg" rel="noreferrer noopener">../prmlfigs-svg/Figure9.8c.svg</a>"&gt;</span></td></tr><tr><td class="line-number" value="536"></td><td class="line-content">					<span class="html-tag">&lt;img <span class="html-attribute-name">class</span>="<span class="html-attribute-value">prml fragment</span>" <span class="html-attribute-name">style</span>="<span class="html-attribute-value">width:30%</span>" <span class="html-attribute-name">src</span>="<a class="html-attribute-value html-resource-link" target="_blank" href="https://wouterboomsma.github.io/pml2024/prmlfigs-svg/Figure9.8d.svg" rel="noreferrer noopener">../prmlfigs-svg/Figure9.8d.svg</a>"&gt;</span></td></tr><tr><td class="line-number" value="537"></td><td class="line-content">					<span class="html-tag">&lt;img <span class="html-attribute-name">class</span>="<span class="html-attribute-value">prml fragment</span>" <span class="html-attribute-name">style</span>="<span class="html-attribute-value">width:30%</span>" <span class="html-attribute-name">src</span>="<a class="html-attribute-value html-resource-link" target="_blank" href="https://wouterboomsma.github.io/pml2024/prmlfigs-svg/Figure9.8e.svg" rel="noreferrer noopener">../prmlfigs-svg/Figure9.8e.svg</a>"&gt;</span></td></tr><tr><td class="line-number" value="538"></td><td class="line-content">					<span class="html-tag">&lt;img <span class="html-attribute-name">class</span>="<span class="html-attribute-value">prml fragment</span>" <span class="html-attribute-name">style</span>="<span class="html-attribute-value">width:30%</span>" <span class="html-attribute-name">src</span>="<a class="html-attribute-value html-resource-link" target="_blank" href="https://wouterboomsma.github.io/pml2024/prmlfigs-svg/Figure9.8f.svg" rel="noreferrer noopener">../prmlfigs-svg/Figure9.8f.svg</a>"&gt;</span></td></tr><tr><td class="line-number" value="539"></td><td class="line-content">					<span class="html-tag">&lt;/div&gt;</span></td></tr><tr><td class="line-number" value="540"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="541"></td><td class="line-content">					<span class="html-tag">&lt;p <span class="html-attribute-name">class</span>="<span class="html-attribute-value">fragment</span>"&gt;</span>Note: you can get faster convergence using Kmeans as an initializer.<span class="html-tag">&lt;/p&gt;</span></td></tr><tr><td class="line-number" value="542"></td><td class="line-content">				<span class="html-tag">&lt;/section&gt;</span></td></tr><tr><td class="line-number" value="543"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="544"></td><td class="line-content">				<span class="html-tag">&lt;section <span class="html-attribute-name">style</span>="<span class="html-attribute-value">font-size:90%</span>"&gt;</span></td></tr><tr><td class="line-number" value="545"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="546"></td><td class="line-content">					<span class="html-tag">&lt;h3&gt;</span>Is maximum likelihood a good idea?<span class="html-tag">&lt;/h3&gt;</span></td></tr><tr><td class="line-number" value="547"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="548"></td><td class="line-content">					<span class="html-tag">&lt;div <span class="html-attribute-name">class</span>="<span class="html-attribute-value">container</span>"&gt;</span></td></tr><tr><td class="line-number" value="549"></td><td class="line-content">						<span class="html-tag">&lt;div <span class="html-attribute-name">style</span>="<span class="html-attribute-value">flex-grow:2</span>"&gt;</span></td></tr><tr><td class="line-number" value="550"></td><td class="line-content">							<span class="html-tag">&lt;dl&gt;</span></td></tr><tr><td class="line-number" value="551"></td><td class="line-content">								<span class="html-tag">&lt;dt&gt;</span>Does it makes sense to optimize the likelihood?<span class="html-tag">&lt;/dt&gt;</span></td></tr><tr><td class="line-number" value="552"></td><td class="line-content">								<span class="html-tag">&lt;dd <span class="html-attribute-name">class</span>="<span class="html-attribute-value">fragment</span>"  <span class="html-attribute-name">data-fragment-index</span>="<span class="html-attribute-value">1</span>"&gt;</span>Not really. It's ill-posed.<span class="html-tag">&lt;/dd&gt;</span></td></tr><tr><td class="line-number" value="553"></td><td class="line-content">							<span class="html-tag">&lt;/dl&gt;</span></td></tr><tr><td class="line-number" value="554"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="555"></td><td class="line-content">							<span class="html-tag">&lt;dl <span class="html-attribute-name">class</span>="<span class="html-attribute-value">fragment</span>"&gt;</span></td></tr><tr><td class="line-number" value="556"></td><td class="line-content">								<span class="html-tag">&lt;dt <span class="html-attribute-name">style</span>="<span class="html-attribute-value">margin-top:0.5em</span>"&gt;</span>Why does EM work then?<span class="html-tag">&lt;/dt&gt;</span></td></tr><tr><td class="line-number" value="557"></td><td class="line-content">								<span class="html-tag">&lt;dd&gt;</span>Reasonable initialization + local optimization.<span class="html-tag">&lt;/dd&gt;</span></td></tr><tr><td class="line-number" value="558"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="559"></td><td class="line-content">							<span class="html-tag">&lt;/dl&gt;</span></td></tr><tr><td class="line-number" value="560"></td><td class="line-content">						<span class="html-tag">&lt;/div&gt;</span></td></tr><tr><td class="line-number" value="561"></td><td class="line-content">						<span class="html-tag">&lt;div&gt;</span></td></tr><tr><td class="line-number" value="562"></td><td class="line-content">							<span class="html-tag">&lt;img <span class="html-attribute-name">class</span>="<span class="html-attribute-value">noborder fragment prml</span>" <span class="html-attribute-name">data-fragment-index</span>="<span class="html-attribute-value">1</span>" <span class="html-attribute-name">src</span>="<a class="html-attribute-value html-resource-link" target="_blank" href="https://wouterboomsma.github.io/pml2024/prmlfigs-svg/Figure9.7.svg" rel="noreferrer noopener">../prmlfigs-svg/Figure9.7.svg</a>" <span class="html-attribute-name">alt</span>=""&gt;</span></td></tr><tr><td class="line-number" value="563"></td><td class="line-content">						<span class="html-tag">&lt;/div&gt;</span></td></tr><tr><td class="line-number" value="564"></td><td class="line-content">					<span class="html-tag">&lt;/div&gt;</span></td></tr><tr><td class="line-number" value="565"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="566"></td><td class="line-content">					<span class="html-tag">&lt;dl <span class="html-attribute-name">class</span>="<span class="html-attribute-value">fragment</span>"&gt;</span></td></tr><tr><td class="line-number" value="567"></td><td class="line-content">						<span class="html-tag">&lt;dt <span class="html-attribute-name">style</span>="<span class="html-attribute-value">margin-top:0.5em</span>"&gt;</span>What is the proper way to fix this?<span class="html-tag">&lt;/dt&gt;</span></td></tr><tr><td class="line-number" value="568"></td><td class="line-content">						<span class="html-tag">&lt;dd&gt;</span>We can apply regularization to avoid the covariances in \(\Sigma\) becoming too small.<span class="html-tag">&lt;/dd&gt;</span></td></tr><tr><td class="line-number" value="569"></td><td class="line-content">						<span class="html-tag">&lt;dd&gt;</span>In the Bayesian setting: add a prior on \(\Sigma\)<span class="html-tag">&lt;/dd&gt;</span></td></tr><tr><td class="line-number" value="570"></td><td class="line-content">					<span class="html-tag">&lt;/dl&gt;</span></td></tr><tr><td class="line-number" value="571"></td><td class="line-content">				<span class="html-tag">&lt;/section&gt;</span></td></tr><tr><td class="line-number" value="572"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="573"></td><td class="line-content"><span class="html-comment">&lt;!--				&lt;section&gt;--&gt;</span></td></tr><tr><td class="line-number" value="574"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="575"></td><td class="line-content"><span class="html-comment">&lt;!--					&lt;h3&gt;Gaussian Mixture model in a Bayesian setting&lt;/h3&gt;--&gt;</span></td></tr><tr><td class="line-number" value="576"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="577"></td><td class="line-content"><span class="html-comment">&lt;!--				&lt;/section&gt;--&gt;</span></td></tr><tr><td class="line-number" value="578"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="579"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="580"></td><td class="line-content"><span class="html-comment">&lt;!--				&lt;section&gt;--&gt;</span></td></tr><tr><td class="line-number" value="581"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="582"></td><td class="line-content"><span class="html-comment">&lt;!--					&lt;h3&gt;Choosing the number of components&lt;/h3&gt;--&gt;</span></td></tr><tr><td class="line-number" value="583"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="584"></td><td class="line-content"><span class="html-comment">&lt;!--				&lt;/section&gt;--&gt;</span></td></tr><tr><td class="line-number" value="585"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="586"></td><td class="line-content"><span class="html-comment">&lt;!--				&lt;section&gt;--&gt;</span></td></tr><tr><td class="line-number" value="587"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="588"></td><td class="line-content"><span class="html-comment">&lt;!--					&lt;h4&gt;Example: conditional independence in action&lt;/h4&gt;--&gt;</span></td></tr><tr><td class="line-number" value="589"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="590"></td><td class="line-content"><span class="html-comment">&lt;!--					https://www.google.com/url?sa=t&amp;rct=j&amp;q=&amp;esrc=s&amp;source=web&amp;cd=&amp;ved=2ahUKEwiw88TNyq70AhUCRvEDHfG7AUEQFnoECAMQAQ&amp;url=https%3A%2F%2Fwww.cs.toronto.edu%2F~rgrosse%2Fcsc321%2Fmixture_models.pdf&amp;usg=AOvVaw3ag9GFqNLOgkTS7VEEDr62--&gt;</span></td></tr><tr><td class="line-number" value="591"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="592"></td><td class="line-content"><span class="html-comment">&lt;!--				Mention missing data--&gt;</span></td></tr><tr><td class="line-number" value="593"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="594"></td><td class="line-content"><span class="html-comment">&lt;!--				&lt;/section&gt;--&gt;</span></td></tr><tr><td class="line-number" value="595"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="596"></td><td class="line-content">				<span class="html-tag">&lt;section <span class="html-attribute-name">style</span>="<span class="html-attribute-value">font-size:80%</span>"&gt;</span></td></tr><tr><td class="line-number" value="597"></td><td class="line-content">					<span class="html-tag">&lt;h3&gt;</span>EM in terms of log-likelihood bound<span class="html-tag">&lt;/h3&gt;</span></td></tr><tr><td class="line-number" value="598"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="599"></td><td class="line-content">					<span class="html-tag">&lt;div <span class="html-attribute-name">class</span>="<span class="html-attribute-value">container</span>"&gt;</span></td></tr><tr><td class="line-number" value="600"></td><td class="line-content">						<span class="html-tag">&lt;div <span class="html-attribute-name">style</span>="<span class="html-attribute-value">flex-grow:2; padding:0.5em; padding-bottom:0.25em;</span>" <span class="html-attribute-name">class</span>="<span class="html-attribute-value">fragment</span>"  <span class="html-attribute-name">data-fragment-index</span>="<span class="html-attribute-value">1</span>"&gt;</span></td></tr><tr><td class="line-number" value="601"></td><td class="line-content">							<span class="html-tag">&lt;span <span class="html-attribute-name">data-fragment-index</span>="<span class="html-attribute-value">1</span>"&gt;</span>The product rule states \(p(\boldsymbol X) = \frac{p(\boldsymbol X,\boldsymbol Z)}{p(\boldsymbol Z|\boldsymbol X)}\), so</td></tr><tr><td class="line-number" value="602"></td><td class="line-content">							\[\ln p(\boldsymbol X|\boldsymbol \theta) = \ln p(\boldsymbol X, \boldsymbol Z |\boldsymbol \theta) - \ln p(\boldsymbol Z |\boldsymbol X, \boldsymbol \theta)\]</td></tr><tr><td class="line-number" value="603"></td><td class="line-content">							<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="604"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="605"></td><td class="line-content">							<span class="html-tag">&lt;p <span class="html-attribute-name">class</span>="<span class="html-attribute-value">fragment</span>" <span class="html-attribute-name">data-fragment-index</span>="<span class="html-attribute-value">2</span>" <span class="html-attribute-name">style</span>="<span class="html-attribute-value">margin-bottom:0.25em; margin-top:1em</span>"&gt;</span>Add and subtract \(\ln q(\boldsymbol Z)\) (valid for any choice of \(q\)):<span class="html-tag">&lt;/p&gt;</span></td></tr><tr><td class="line-number" value="606"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="607"></td><td class="line-content">						<span class="html-tag">&lt;/div&gt;</span></td></tr><tr><td class="line-number" value="608"></td><td class="line-content">						<span class="html-tag">&lt;div <span class="html-attribute-name">style</span>="<span class="html-attribute-value"> margin-bottom:0; font-size:90%</span>"&gt;</span></td></tr><tr><td class="line-number" value="609"></td><td class="line-content">							<span class="html-tag">&lt;div <span class="html-attribute-name">style</span>="<span class="html-attribute-value">border:1px solid lightgrey; padding:0.5em; padding-bottom:0.25em;</span>"&gt;</span></td></tr><tr><td class="line-number" value="610"></td><td class="line-content">							General setting:<span class="html-tag">&lt;br&gt;</span></td></tr><tr><td class="line-number" value="611"></td><td class="line-content">							<span class="html-tag">&lt;ol&gt;</span></td></tr><tr><td class="line-number" value="612"></td><td class="line-content">								<span class="html-tag">&lt;li&gt;</span>\(p(\boldsymbol X|\boldsymbol \theta)\) difficult to optimize<span class="html-tag">&lt;/li&gt;</span></td></tr><tr><td class="line-number" value="613"></td><td class="line-content">								<span class="html-tag">&lt;li&gt;</span>\(p(\boldsymbol X, \boldsymbol Z|\boldsymbol \theta)\) easy to optimize<span class="html-tag">&lt;/li&gt;</span></td></tr><tr><td class="line-number" value="614"></td><td class="line-content">							<span class="html-tag">&lt;/ol&gt;</span></td></tr><tr><td class="line-number" value="615"></td><td class="line-content">							<span class="html-tag">&lt;/div&gt;</span></td></tr><tr><td class="line-number" value="616"></td><td class="line-content">						<span class="html-tag">&lt;/div&gt;</span></td></tr><tr><td class="line-number" value="617"></td><td class="line-content">					<span class="html-tag">&lt;/div&gt;</span></td></tr><tr><td class="line-number" value="618"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="619"></td><td class="line-content">					<span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">fragment</span>" <span class="html-attribute-name">data-fragment-index</span>="<span class="html-attribute-value">2</span>" &gt;</span></td></tr><tr><td class="line-number" value="620"></td><td class="line-content">					\[\begin{align*}\ln p(\boldsymbol X|\boldsymbol \theta) &amp;= \ln p(\boldsymbol X, \boldsymbol Z |\boldsymbol \theta) - \ln q(\boldsymbol Z) - (\ln p(\boldsymbol Z |\boldsymbol X, \boldsymbol \theta) - \ln q(\boldsymbol Z)) \\</td></tr><tr><td class="line-number" value="621"></td><td class="line-content">					&amp;=\ln\frac{p(\boldsymbol X, \boldsymbol Z |\boldsymbol \theta)}{q(\boldsymbol Z)} - \ln \frac{p(\boldsymbol Z |\boldsymbol X, \boldsymbol \theta)}{q(\boldsymbol Z)} \end{align*}\]</td></tr><tr><td class="line-number" value="622"></td><td class="line-content">					<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="623"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="624"></td><td class="line-content">					<span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">fragment</span>"&gt;</span></td></tr><tr><td class="line-number" value="625"></td><td class="line-content">					Since this holds for any \(\boldsymbol Z\), it also holds for \(\mathbb{E}_{\boldsymbol Z}\) under any distribution over \(\boldsymbol Z\). We choose \(q(\boldsymbol Z)\):</td></tr><tr><td class="line-number" value="626"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="627"></td><td class="line-content"><span class="html-comment">&lt;!--					\[\underbrace{\mathbb{E}_{\boldsymbol Z \sim q(\boldsymbol Z)} \ln p(\boldsymbol X|\boldsymbol \theta)}_{=\ln p(\boldsymbol X|\boldsymbol \theta)} = \underbrace{\mathbb{E}_{\boldsymbol Z \sim q(\boldsymbol Z)} \left (\ln \frac{p(\boldsymbol X, \boldsymbol Z |\boldsymbol \theta)}{q(\boldsymbol Z)} \right )}_{\mathcal{L(q, \boldsymbol \theta)}} + \underbrace{\mathbb{E}_{\boldsymbol Z \sim q(\boldsymbol Z)} \left(-\ln \frac{p(\boldsymbol Z |\boldsymbol X, \boldsymbol \theta)}{q(\boldsymbol Z)} \right )}_{\text{KL}(q||p)\]--&gt;</span></td></tr><tr><td class="line-number" value="628"></td><td class="line-content">					\[\underbrace{\mathbb{E}_{\boldsymbol Z \sim q(\boldsymbol Z)} \ln p(\boldsymbol X|\boldsymbol \theta)}_{=\ln p(\boldsymbol X|\boldsymbol \theta)} = \underbrace{\mathbb{E}_{\boldsymbol Z \sim q(\boldsymbol Z)} \left (\ln \frac{p(\boldsymbol X, \boldsymbol Z |\boldsymbol \theta)}{q(\boldsymbol Z)} \right )}_{\mathcal{L(q, \boldsymbol \theta)}} + \underbrace{\mathbb{E}_{\boldsymbol Z \sim q(\boldsymbol Z)} \left(-\ln \frac{p(\boldsymbol Z |\boldsymbol X, \boldsymbol \theta)}{q(\boldsymbol Z)} \right )}_{\text{KL}(q||p)}\]</td></tr><tr><td class="line-number" value="629"></td><td class="line-content">					<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="630"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="631"></td><td class="line-content">					<span class="html-tag">&lt;aside <span class="html-attribute-name">class</span>="<span class="html-attribute-value">notes</span>"&gt;</span></td></tr><tr><td class="line-number" value="632"></td><td class="line-content">						<span class="html-tag">&lt;p&gt;</span>Note that the notation is slightly imprecise here: \(\text{KL}(q||p)\) should be \text{KL}(q||p(z|x))<span class="html-tag">&lt;/p&gt;</span></td></tr><tr><td class="line-number" value="633"></td><td class="line-content">					<span class="html-tag">&lt;/aside&gt;</span></td></tr><tr><td class="line-number" value="634"></td><td class="line-content">				<span class="html-tag">&lt;/section&gt;</span></td></tr><tr><td class="line-number" value="635"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="636"></td><td class="line-content">				<span class="html-tag">&lt;section <span class="html-attribute-name">style</span>="<span class="html-attribute-value">font-size:80%</span>"&gt;</span></td></tr><tr><td class="line-number" value="637"></td><td class="line-content">					<span class="html-tag">&lt;h3&gt;</span>EM in terms of log-likelihood bound (2) <span class="html-tag">&lt;/h3&gt;</span></td></tr><tr><td class="line-number" value="638"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="639"></td><td class="line-content">					<span class="html-tag">&lt;div <span class="html-attribute-name">style</span>="<span class="html-attribute-value">border:1px solid lightgrey; padding:0.5em;padding-bottom:0.25em;</span>"&gt;</span></td></tr><tr><td class="line-number" value="640"></td><td class="line-content">					\[\ln p(\boldsymbol X|\boldsymbol \theta) = \underbrace{\mathbb{E}_{\boldsymbol Z \sim q(\boldsymbol Z)} \left (\ln \frac{p(\boldsymbol X, \boldsymbol Z |\boldsymbol \theta)}{q(\boldsymbol Z)} \right )}_{\mathcal{L(q, \boldsymbol \theta)}} + \underbrace{\mathbb{E}_{\boldsymbol Z \sim q(\boldsymbol Z)} \left(-\ln \frac{p(\boldsymbol Z |\boldsymbol X, \boldsymbol \theta)}{q(\boldsymbol Z)} \right )}_{\text{KL}(q||p)}\]</td></tr><tr><td class="line-number" value="641"></td><td class="line-content">					<span class="html-tag">&lt;/div&gt;</span></td></tr><tr><td class="line-number" value="642"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="643"></td><td class="line-content">					<span class="html-tag">&lt;div <span class="html-attribute-name">class</span>="<span class="html-attribute-value">container</span>" <span class="html-attribute-name">style</span>="<span class="html-attribute-value">align-items:center</span>"&gt;</span></td></tr><tr><td class="line-number" value="644"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="645"></td><td class="line-content">						<span class="html-tag">&lt;div&gt;</span></td></tr><tr><td class="line-number" value="646"></td><td class="line-content">							<span class="html-tag">&lt;p&gt;</span>The Kullback Leibler divergence, \(\text{KL}(q||p)\) specifies how "close" \(q(\boldsymbol Z)\) is to \(p(\boldsymbol Z |\boldsymbol X, \boldsymbol \theta)\).<span class="html-tag">&lt;/p&gt;</span></td></tr><tr><td class="line-number" value="647"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="648"></td><td class="line-content">							<span class="html-tag">&lt;p&gt;</span>Since \(\text{KL}(q||p) &gt;= 0\), \(\mathcal{L}(q, \boldsymbol \theta)\) is a lower bound on \(\ln p(\boldsymbol X|\boldsymbol \theta)\).<span class="html-tag">&lt;/p&gt;</span></td></tr><tr><td class="line-number" value="649"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="650"></td><td class="line-content">							<span class="html-tag">&lt;p&gt;</span>\(\mathcal{L}\) is sometimes referred to as an ELBO (evidence lower bound)<span class="html-tag">&lt;/p&gt;</span></td></tr><tr><td class="line-number" value="651"></td><td class="line-content">						<span class="html-tag">&lt;/div&gt;</span></td></tr><tr><td class="line-number" value="652"></td><td class="line-content">						<span class="html-tag">&lt;div <span class="html-attribute-name">style</span>="<span class="html-attribute-value">padding:0.5em;</span>"&gt;</span></td></tr><tr><td class="line-number" value="653"></td><td class="line-content">							<span class="html-tag">&lt;img <span class="html-attribute-name">class</span>="<span class="html-attribute-value">noborder center prml</span>" <span class="html-attribute-name">style</span>="<span class="html-attribute-value">width:100%; margin-top:1em</span>" <span class="html-attribute-name">src</span>="<a class="html-attribute-value html-resource-link" target="_blank" href="https://wouterboomsma.github.io/pml2024/prmlfigs-svg/Figure9.11.svg" rel="noreferrer noopener">../prmlfigs-svg/Figure9.11.svg</a>"&gt;</span></td></tr><tr><td class="line-number" value="654"></td><td class="line-content">						<span class="html-tag">&lt;/div&gt;</span></td></tr><tr><td class="line-number" value="655"></td><td class="line-content">					<span class="html-tag">&lt;/div&gt;</span></td></tr><tr><td class="line-number" value="656"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="657"></td><td class="line-content">				<span class="html-tag">&lt;/section&gt;</span></td></tr><tr><td class="line-number" value="658"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="659"></td><td class="line-content">				<span class="html-tag">&lt;section <span class="html-attribute-name">style</span>="<span class="html-attribute-value">font-size:75%</span>"&gt;</span></td></tr><tr><td class="line-number" value="660"></td><td class="line-content">					<span class="html-tag">&lt;h3&gt;</span>EM in terms of log-likelihood bound (3) <span class="html-tag">&lt;/h3&gt;</span></td></tr><tr><td class="line-number" value="661"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="662"></td><td class="line-content">					<span class="html-tag">&lt;div <span class="html-attribute-name">style</span>="<span class="html-attribute-value">border:1px solid lightgrey; padding:0.5em;padding-bottom:0.25em; font-size:80%</span>"&gt;</span></td></tr><tr><td class="line-number" value="663"></td><td class="line-content">						\[\ln p(\boldsymbol X|\boldsymbol \theta) = \underbrace{\mathbb{E}_{\boldsymbol Z \sim q(\boldsymbol Z)} \left (\ln \frac{p(\boldsymbol X, \boldsymbol Z |\boldsymbol \theta)}{q(\boldsymbol Z)} \right )}_{\mathcal{L(q, \boldsymbol \theta)}} + \underbrace{\mathbb{E}_{\boldsymbol Z \sim q(\boldsymbol Z)} \left(-\ln \frac{p(\boldsymbol Z |\boldsymbol X, \boldsymbol \theta)}{q(\boldsymbol Z)} \right )}_{\text{KL}(q||p)}\]</td></tr><tr><td class="line-number" value="664"></td><td class="line-content">					<span class="html-tag">&lt;/div&gt;</span></td></tr><tr><td class="line-number" value="665"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="666"></td><td class="line-content">					<span class="html-tag">&lt;p&gt;</span>The EM algorithm alternates between optimizing \(\mathcal{L}(q, \boldsymbol \theta)\) wrt \(q\) and \(\boldsymbol \theta\).<span class="html-tag">&lt;/p&gt;</span></td></tr><tr><td class="line-number" value="667"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="668"></td><td class="line-content">					<span class="html-tag">&lt;div <span class="html-attribute-name">class</span>="<span class="html-attribute-value">container</span>" <span class="html-attribute-name">style</span>="<span class="html-attribute-value">align-items:baseline;margin-top:-0.45em;</span>" &gt;</span></td></tr><tr><td class="line-number" value="669"></td><td class="line-content">						<span class="html-tag">&lt;div&gt;</span></td></tr><tr><td class="line-number" value="670"></td><td class="line-content">							<span class="html-tag">&lt;img <span class="html-attribute-name">class</span>="<span class="html-attribute-value">noborder center prml</span>" <span class="html-attribute-name">style</span>="<span class="html-attribute-value">width:70%; margin-top:1em</span>" <span class="html-attribute-name">src</span>="<a class="html-attribute-value html-resource-link" target="_blank" href="https://wouterboomsma.github.io/pml2024/prmlfigs-svg/Figure9.12.svg" rel="noreferrer noopener">../prmlfigs-svg/Figure9.12.svg</a>"&gt;</span></td></tr><tr><td class="line-number" value="671"></td><td class="line-content">						<span class="html-tag">&lt;/div&gt;</span></td></tr><tr><td class="line-number" value="672"></td><td class="line-content">						<span class="html-tag">&lt;div&gt;</span></td></tr><tr><td class="line-number" value="673"></td><td class="line-content">							<span class="html-tag">&lt;img <span class="html-attribute-name">class</span>="<span class="html-attribute-value">noborder center prml fragment</span>"  <span class="html-attribute-name">data-fragment-index</span>="<span class="html-attribute-value">2</span>" <span class="html-attribute-name">style</span>="<span class="html-attribute-value">width:60%; padding-left:1.75em; margin-top:1em</span>" <span class="html-attribute-name">src</span>="<a class="html-attribute-value html-resource-link" target="_blank" href="https://wouterboomsma.github.io/pml2024/prmlfigs-svg/Figure9.13.svg" rel="noreferrer noopener">../prmlfigs-svg/Figure9.13.svg</a>"&gt;</span></td></tr><tr><td class="line-number" value="674"></td><td class="line-content">						<span class="html-tag">&lt;/div&gt;</span></td></tr><tr><td class="line-number" value="675"></td><td class="line-content">					<span class="html-tag">&lt;/div&gt;</span></td></tr><tr><td class="line-number" value="676"></td><td class="line-content">					<span class="html-tag">&lt;div <span class="html-attribute-name">class</span>="<span class="html-attribute-value">container</span>" <span class="html-attribute-name">style</span>="<span class="html-attribute-value">margin-top:0.25em</span>"&gt;</span></td></tr><tr><td class="line-number" value="677"></td><td class="line-content">						<span class="html-tag">&lt;div&gt;</span></td></tr><tr><td class="line-number" value="678"></td><td class="line-content">							<span class="html-tag">&lt;dl&gt;</span></td></tr><tr><td class="line-number" value="679"></td><td class="line-content">								<span class="html-tag">&lt;dt&gt;</span>E-step (iteration \(t\))<span class="html-tag">&lt;/dt&gt;</span></td></tr><tr><td class="line-number" value="680"></td><td class="line-content">								<span class="html-tag">&lt;dd&gt;</span>Optimize \(\mathcal{L}(q,\boldsymbol \theta_{t-1})\) with respect to \(q\), keeping \(\boldsymbol \theta_{t-1}\) fixed. 						<span class="html-tag">&lt;a <span class="html-attribute-name">onclick</span>="<span class="html-attribute-value">$(this.parentElement.parentElement).find('div.popup').toggle()</span>" <span class="html-attribute-name">class</span>="<span class="html-attribute-value">popup-q</span>"&gt;</span>?<span class="html-tag">&lt;/a&gt;</span></td></tr><tr><td class="line-number" value="681"></td><td class="line-content">									<span class="html-tag">&lt;div <span class="html-attribute-name">class</span>="<span class="html-attribute-value">popup</span>"&gt;</span></td></tr><tr><td class="line-number" value="682"></td><td class="line-content">										<span class="html-tag">&lt;div <span class="html-attribute-name">onclick</span>="<span class="html-attribute-value">$(this.parentElement).toggle()</span>" <span class="html-attribute-name">class</span>="<span class="html-attribute-value">popup-close</span>"&gt;</span>×<span class="html-tag">&lt;/div&gt;</span></td></tr><tr><td class="line-number" value="683"></td><td class="line-content">										<span class="html-tag">&lt;p&gt;</span></td></tr><tr><td class="line-number" value="684"></td><td class="line-content">											If we know the parameters \(\theta\), the best way to optimize the sum of the two terms is to let the KL term go to zero, making the lower bound exact.</td></tr><tr><td class="line-number" value="685"></td><td class="line-content">										<span class="html-tag">&lt;/p&gt;</span></td></tr><tr><td class="line-number" value="686"></td><td class="line-content">									<span class="html-tag">&lt;/div&gt;</span></td></tr><tr><td class="line-number" value="687"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="688"></td><td class="line-content">									<span class="html-tag">&lt;p&gt;</span>\(\Rightarrow q(\boldsymbol Z) = p(\boldsymbol Z |\boldsymbol X, \boldsymbol \theta_{t-1})\)<span class="html-tag">&lt;/p&gt;</span></td></tr><tr><td class="line-number" value="689"></td><td class="line-content">								<span class="html-tag">&lt;/dd&gt;</span></td></tr><tr><td class="line-number" value="690"></td><td class="line-content">							<span class="html-tag">&lt;/dl&gt;</span></td></tr><tr><td class="line-number" value="691"></td><td class="line-content">						<span class="html-tag">&lt;/div&gt;</span></td></tr><tr><td class="line-number" value="692"></td><td class="line-content">						<span class="html-tag">&lt;div&gt;</span></td></tr><tr><td class="line-number" value="693"></td><td class="line-content">							<span class="html-tag">&lt;dl <span class="html-attribute-name">class</span>="<span class="html-attribute-value">fragment</span>" <span class="html-attribute-name">data-fragment-index</span>="<span class="html-attribute-value">2</span>"&gt;</span></td></tr><tr><td class="line-number" value="694"></td><td class="line-content">								<span class="html-tag">&lt;dt&gt;</span>M-step (iteration \(t\))<span class="html-tag">&lt;/dt&gt;</span></td></tr><tr><td class="line-number" value="695"></td><td class="line-content">								<span class="html-tag">&lt;dd&gt;</span>Optimize \(\mathcal{L(q,\boldsymbol \theta})\) with respect to \(\boldsymbol \theta\), keeping \(q\) fixed. <span class="html-tag">&lt;a <span class="html-attribute-name">onclick</span>="<span class="html-attribute-value">$(this.parentElement.parentElement).find('div.popup').toggle()</span>" <span class="html-attribute-name">class</span>="<span class="html-attribute-value">popup-q</span>"&gt;</span>?<span class="html-tag">&lt;/a&gt;</span></td></tr><tr><td class="line-number" value="696"></td><td class="line-content">									<span class="html-tag">&lt;div <span class="html-attribute-name">class</span>="<span class="html-attribute-value">popup</span>"&gt;</span></td></tr><tr><td class="line-number" value="697"></td><td class="line-content">										<span class="html-tag">&lt;div <span class="html-attribute-name">onclick</span>="<span class="html-attribute-value">$(this.parentElement).toggle()</span>" <span class="html-attribute-name">class</span>="<span class="html-attribute-value">popup-close</span>"&gt;</span>×<span class="html-tag">&lt;/div&gt;</span></td></tr><tr><td class="line-number" value="698"></td><td class="line-content">										<span class="html-tag">&lt;p&gt;</span></td></tr><tr><td class="line-number" value="699"></td><td class="line-content">											As we start optimizing \(\mathcal{L(q,\boldsymbol \theta})\) with respect to \(\boldsymbol \theta\), $\mathcal{L}$ will increase. We know that \(p(\boldsymbol X|\boldsymbol \theta)\) will increase by at least the same amount. In general, it will increase more, introducing a non-zero contribution from the KL term.</td></tr><tr><td class="line-number" value="700"></td><td class="line-content">										<span class="html-tag">&lt;/p&gt;</span></td></tr><tr><td class="line-number" value="701"></td><td class="line-content">									<span class="html-tag">&lt;/div&gt;</span></td></tr><tr><td class="line-number" value="702"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="703"></td><td class="line-content">									<span class="html-tag">&lt;p&gt;</span>\[\mathcal{L}(q,\boldsymbol \theta_{t}) &gt;= \mathcal{L}(q,\boldsymbol \theta_{t-1}) \Rightarrow \\ p(\boldsymbol X|\boldsymbol \theta_t) &gt;= p(\boldsymbol X|\boldsymbol \theta_{t-1})\]<span class="html-tag">&lt;/p&gt;</span></td></tr><tr><td class="line-number" value="704"></td><td class="line-content">								<span class="html-tag">&lt;/dd&gt;</span></td></tr><tr><td class="line-number" value="705"></td><td class="line-content">							<span class="html-tag">&lt;/dl&gt;</span></td></tr><tr><td class="line-number" value="706"></td><td class="line-content">						<span class="html-tag">&lt;/div&gt;</span></td></tr><tr><td class="line-number" value="707"></td><td class="line-content">					<span class="html-tag">&lt;/div&gt;</span></td></tr><tr><td class="line-number" value="708"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="709"></td><td class="line-content">					<span class="html-tag">&lt;aside <span class="html-attribute-name">class</span>="<span class="html-attribute-value">notes</span>"&gt;</span></td></tr><tr><td class="line-number" value="710"></td><td class="line-content">						<span class="html-tag">&lt;p&gt;</span>For the E-step, we note that when q(Z) is chosen to be p(z|x), the KL term disappears. Since the left hand side does not depend on z, it will not change during the E-step, so this must therefore be the optimal choice for q(Z).<span class="html-tag">&lt;/p&gt;</span></td></tr><tr><td class="line-number" value="711"></td><td class="line-content">					<span class="html-tag">&lt;/aside&gt;</span></td></tr><tr><td class="line-number" value="712"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="713"></td><td class="line-content">				<span class="html-tag">&lt;/section&gt;</span></td></tr><tr><td class="line-number" value="714"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="715"></td><td class="line-content">				<span class="html-tag">&lt;section&gt;</span></td></tr><tr><td class="line-number" value="716"></td><td class="line-content">					<span class="html-tag">&lt;h3&gt;</span>EM in terms of log-likelihood bound (4) <span class="html-tag">&lt;/h3&gt;</span></td></tr><tr><td class="line-number" value="717"></td><td class="line-content">					<span class="html-tag">&lt;img <span class="html-attribute-name">class</span>="<span class="html-attribute-value">noborder center prml</span>" <span class="html-attribute-name">style</span>="<span class="html-attribute-value">width:70%;</span>" <span class="html-attribute-name">src</span>="<a class="html-attribute-value html-resource-link" target="_blank" href="https://wouterboomsma.github.io/pml2024/prmlfigs-svg/Figure9.14.svg" rel="noreferrer noopener">../prmlfigs-svg/Figure9.14.svg</a>"&gt;</span></td></tr><tr><td class="line-number" value="718"></td><td class="line-content">				<span class="html-tag">&lt;/section&gt;</span></td></tr><tr><td class="line-number" value="719"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="720"></td><td class="line-content">				<span class="html-tag">&lt;section <span class="html-attribute-name">style</span>="<span class="html-attribute-value">font-size:90%</span>"&gt;</span></td></tr><tr><td class="line-number" value="721"></td><td class="line-content">					<span class="html-tag">&lt;h3&gt;</span>A Bayesian Mixture model (BMM)<span class="html-tag">&lt;/h3&gt;</span></td></tr><tr><td class="line-number" value="722"></td><td class="line-content">	</td></tr><tr><td class="line-number" value="723"></td><td class="line-content">					<span class="html-tag">&lt;div <span class="html-attribute-name">class</span>="<span class="html-attribute-value">container</span>"&gt;</span></td></tr><tr><td class="line-number" value="724"></td><td class="line-content">						<span class="html-tag">&lt;div <span class="html-attribute-name">style</span>="<span class="html-attribute-value">flex-grow: 2</span>"&gt;</span></td></tr><tr><td class="line-number" value="725"></td><td class="line-content">							<span class="html-tag">&lt;p&gt;</span>What happens if we try to be Bayesian about the the mixture model?<span class="html-tag">&lt;/p&gt;</span></td></tr><tr><td class="line-number" value="726"></td><td class="line-content">	</td></tr><tr><td class="line-number" value="727"></td><td class="line-content">							<span class="html-tag">&lt;p&gt;</span>Like Blei et al, we'll consider a simplistic version, where we are only doing inference in the parameter \(\boldsymbol \mu\) - in addition to the original latent variables \(\boldsymbol z\).<span class="html-tag">&lt;/p&gt;</span></td></tr><tr><td class="line-number" value="728"></td><td class="line-content">	</td></tr><tr><td class="line-number" value="729"></td><td class="line-content">							<span class="html-tag">&lt;p&gt;</span>See Bishop for a more thorough treatment.<span class="html-tag">&lt;/p&gt;</span></td></tr><tr><td class="line-number" value="730"></td><td class="line-content">	</td></tr><tr><td class="line-number" value="731"></td><td class="line-content">						<span class="html-tag">&lt;/div&gt;</span></td></tr><tr><td class="line-number" value="732"></td><td class="line-content">	</td></tr><tr><td class="line-number" value="733"></td><td class="line-content">						<span class="html-tag">&lt;div <span class="html-attribute-name">style</span>="<span class="html-attribute-value">font-size:50%; text-align:center</span>"&gt;</span></td></tr><tr><td class="line-number" value="734"></td><td class="line-content">							<span class="html-tag">&lt;img <span class="html-attribute-name">class</span>="<span class="html-attribute-value">noborder center prml</span>" <span class="html-attribute-name">style</span>="<span class="html-attribute-value">width:80%; margin-top:1em; margin-bottom:0.2em</span>" <span class="html-attribute-name">src</span>="<a class="html-attribute-value html-resource-link" target="_blank" href="https://wouterboomsma.github.io/pml2024/prmlfigs-svg/Figure10.5.svg" rel="noreferrer noopener">../prmlfigs-svg/Figure10.5.svg</a>" <span class="html-attribute-name">alt</span>=""&gt;</span></td></tr><tr><td class="line-number" value="735"></td><td class="line-content">							Bayesian mixture model<span class="html-tag">&lt;br&gt;</span> from Bishop</td></tr><tr><td class="line-number" value="736"></td><td class="line-content">	</td></tr><tr><td class="line-number" value="737"></td><td class="line-content">							<span class="html-tag">&lt;img <span class="html-attribute-name">class</span>="<span class="html-attribute-value">noborder center prml</span>" <span class="html-attribute-name">style</span>="<span class="html-attribute-value">width:80%; margin-top:1em; margin-bottom:0.2em</span>" <span class="html-attribute-name">src</span>="<a class="html-attribute-value html-resource-link" target="_blank" href="https://wouterboomsma.github.io/pml2024/week2/prml_figure10.5_adapted.svg" rel="noreferrer noopener">prml_figure10.5_adapted.svg</a>" <span class="html-attribute-name">alt</span>=""&gt;</span></td></tr><tr><td class="line-number" value="738"></td><td class="line-content">							Bayesian mixture model<span class="html-tag">&lt;br&gt;</span> from Blei et al.</td></tr><tr><td class="line-number" value="739"></td><td class="line-content">						<span class="html-tag">&lt;/div&gt;</span></td></tr><tr><td class="line-number" value="740"></td><td class="line-content">					<span class="html-tag">&lt;/div&gt;</span></td></tr><tr><td class="line-number" value="741"></td><td class="line-content">	</td></tr><tr><td class="line-number" value="742"></td><td class="line-content">				<span class="html-tag">&lt;/section&gt;</span></td></tr><tr><td class="line-number" value="743"></td><td class="line-content">	</td></tr><tr><td class="line-number" value="744"></td><td class="line-content">				<span class="html-tag">&lt;section <span class="html-attribute-name">style</span>="<span class="html-attribute-value">font-size:90%</span>"&gt;</span></td></tr><tr><td class="line-number" value="745"></td><td class="line-content">					<span class="html-tag">&lt;h3&gt;</span>Example: BMM ingredients<span class="html-tag">&lt;/h3&gt;</span></td></tr><tr><td class="line-number" value="746"></td><td class="line-content">	</td></tr><tr><td class="line-number" value="747"></td><td class="line-content">					<span class="html-tag">&lt;p&gt;</span>Ingredients are similar to previous discussion on mixture models:<span class="html-tag">&lt;/p&gt;</span></td></tr><tr><td class="line-number" value="748"></td><td class="line-content">	</td></tr><tr><td class="line-number" value="749"></td><td class="line-content">	<span class="html-comment">&lt;!--					\[p(\boldsymbol Z) = \prod_{n=1}^N\prod_{k=1}^K \pi_k^{z_{nk}}\hspace{2em}\text{, where } \pi_k \text{ is the prior probability for the } k\text{th component}\]--&gt;</span></td></tr><tr><td class="line-number" value="750"></td><td class="line-content">					\[p(\boldsymbol Z) = \prod_{n=1}^N\prod_{k=1}^K \pi_k^{z_{nk}}\hspace{2em}\small{\text{, where } \pi_k \text{ is the probability for the } k\text{th component}}\]</td></tr><tr><td class="line-number" value="751"></td><td class="line-content">	</td></tr><tr><td class="line-number" value="752"></td><td class="line-content">					<span class="html-tag">&lt;p&gt;</span>But note that we in this example fix \(\pi_k=1/K\).<span class="html-tag">&lt;/p&gt;</span></td></tr><tr><td class="line-number" value="753"></td><td class="line-content">	</td></tr><tr><td class="line-number" value="754"></td><td class="line-content">					<span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">fragment</span>"&gt;</span></td></tr><tr><td class="line-number" value="755"></td><td class="line-content">					<span class="html-tag">&lt;p&gt;</span>Conditional distribution of output:<span class="html-tag">&lt;/p&gt;</span></td></tr><tr><td class="line-number" value="756"></td><td class="line-content">	</td></tr><tr><td class="line-number" value="757"></td><td class="line-content">					\[p(\boldsymbol X|\boldsymbol Z, \boldsymbol \mu) = \prod_{n=1}^N\prod_{k=1}^K \mathcal{N}(x_n | \mu_k)^{z_{nk}} \hspace{2em} \small{\text{we assume a constant variance of 1}}\]</td></tr><tr><td class="line-number" value="758"></td><td class="line-content">					<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="759"></td><td class="line-content">					<span class="html-tag">&lt;p <span class="html-attribute-name">class</span>="<span class="html-attribute-value">fragment</span>"&gt;</span>We choose a Normal prior, \(p(\boldsymbol \mu) = \mathcal{N}(0,\sigma^2)\) for \(\boldsymbol \mu\), which is conjugate to the Normal likelihood when only the mean is unknown. The \(\sigma^2\) is shared for all \(\mu_k\).<span class="html-tag">&lt;/p&gt;</span></td></tr><tr><td class="line-number" value="760"></td><td class="line-content">	</td></tr><tr><td class="line-number" value="761"></td><td class="line-content">				<span class="html-tag">&lt;/section&gt;</span></td></tr><tr><td class="line-number" value="762"></td><td class="line-content">	</td></tr><tr><td class="line-number" value="763"></td><td class="line-content">				<span class="html-tag">&lt;section <span class="html-attribute-name">style</span>="<span class="html-attribute-value">font-size:90%</span>"&gt;</span></td></tr><tr><td class="line-number" value="764"></td><td class="line-content">					<span class="html-tag">&lt;h3&gt;</span>Example: BMM joint and evidence<span class="html-tag">&lt;/h3&gt;</span></td></tr><tr><td class="line-number" value="765"></td><td class="line-content">					<span class="html-tag">&lt;img <span class="html-attribute-name">class</span>="<span class="html-attribute-value">noborder center prml</span>" <span class="html-attribute-name">style</span>="<span class="html-attribute-value">width:30%; float:right</span>" <span class="html-attribute-name">src</span>="<a class="html-attribute-value html-resource-link" target="_blank" href="https://wouterboomsma.github.io/pml2024/week2/prml_figure10.5_adapted.svg" rel="noreferrer noopener">prml_figure10.5_adapted.svg</a>" <span class="html-attribute-name">alt</span>=""&gt;</span></td></tr><tr><td class="line-number" value="766"></td><td class="line-content">	</td></tr><tr><td class="line-number" value="767"></td><td class="line-content">					<span class="html-tag">&lt;p&gt;</span>Joint:<span class="html-tag">&lt;/p&gt;</span></td></tr><tr><td class="line-number" value="768"></td><td class="line-content">					\[\begin{align*}p(\boldsymbol X, \boldsymbol Z, \boldsymbol \mu) &amp;= p(\boldsymbol \mu) p(\boldsymbol X|\boldsymbol Z, \boldsymbol \mu)p(\boldsymbol Z) \\</td></tr><tr><td class="line-number" value="769"></td><td class="line-content">					&amp;= p(\boldsymbol \mu) \prod_{n=1}^N \prod_{k=1}^K\mathcal{N}(x_n | \mu_k)^{z_{nk}}\pi_k^{z_{nk}}</td></tr><tr><td class="line-number" value="770"></td><td class="line-content">					\end{align*}\]</td></tr><tr><td class="line-number" value="771"></td><td class="line-content">					<span class="html-comment">&lt;!--					&amp;= \prod_{k=1}^K \mathcal{N}(\mu_k | 0, \sigma^2) \prod_{n=1}^N \mathcal{N}(x_n | \mu_k)^{z_{nk}}\pi_k^{z_{nk}}--&gt;</span></td></tr><tr><td class="line-number" value="772"></td><td class="line-content">	<span class="html-comment">&lt;!--					&amp;= \prod_{n=1}^N\prod_{k=1}^K \mathcal{N}(x_n | \mu_k)^{z_{nk}}\pi_k^{z_{nk}}\mathcal{N}(\mu_k | 0, \sigma^2)--&gt;</span></td></tr><tr><td class="line-number" value="773"></td><td class="line-content">	</td></tr><tr><td class="line-number" value="774"></td><td class="line-content">					<span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">fragment</span>"&gt;</span></td></tr><tr><td class="line-number" value="775"></td><td class="line-content">					<span class="html-tag">&lt;p&gt;</span>Evidence (integrating over \(\mu\) and summing over states of \(z_n\)):<span class="html-tag">&lt;/p&gt;</span></td></tr><tr><td class="line-number" value="776"></td><td class="line-content">					\[\begin{align*}p(\boldsymbol X) &amp;= \int_{\boldsymbol \mu} p(\boldsymbol \mu) \prod_{n=1}^N \sum_{z_n}\prod_{k=1}^K\mathcal{N}(x_n | \mu_k)^{z_{nk}}\pi_k^{z_{nk}} d\boldsymbol \mu\\</td></tr><tr><td class="line-number" value="777"></td><td class="line-content">					&amp;= \int_{\boldsymbol \mu} p(\boldsymbol \mu) \prod_{n=1}^N\sum_{k=1}^K\mathcal{N}(x_n | \mu_k)\pi_kd\boldsymbol \mu</td></tr><tr><td class="line-number" value="778"></td><td class="line-content">					\end{align*}\]</td></tr><tr><td class="line-number" value="779"></td><td class="line-content">	<span class="html-comment">&lt;!--					\[\begin{align*}p(\boldsymbol X) &amp;= \int_{\boldsymbol \mu}\prod_{k=1}^K \mathcal{N}(\mu_k | 0, \sigma^2) \prod_{n=1}^N\sum_{z_n}\mathcal{N}(x_n | \mu_k)^{z_{nk}}\pi_k^{z_{nk}} d\boldsymbol \mu\\--&gt;</span></td></tr><tr><td class="line-number" value="780"></td><td class="line-content">	<span class="html-comment">&lt;!--					&amp;= \int_{\boldsymbol \mu}\sum_{k=1}^K \mathcal{N}(\mu_k | 0, \sigma^2) \prod_{n=1}^N\mathcal{N}(x_n | \mu_k)\pi_kd\boldsymbol \mu--&gt;</span></td></tr><tr><td class="line-number" value="781"></td><td class="line-content">	</td></tr><tr><td class="line-number" value="782"></td><td class="line-content">					<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="783"></td><td class="line-content">					<span class="html-tag">&lt;p <span class="html-attribute-name">class</span>="<span class="html-attribute-value">fragment</span>"&gt;</span>Calculating \(p(\boldsymbol X)\) is intractable. For the same reason, \(p(\boldsymbol Z | \boldsymbol X)\) is intractable. We therefore cannot use the EM algorithm.<span class="html-tag">&lt;/p&gt;</span></td></tr><tr><td class="line-number" value="784"></td><td class="line-content">				<span class="html-tag">&lt;/section&gt;</span></td></tr><tr><td class="line-number" value="785"></td><td class="line-content">	</td></tr><tr><td class="line-number" value="786"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="787"></td><td class="line-content">			</td></tr><tr><td class="line-number" value="788"></td><td class="line-content">			<span class="html-tag">&lt;section <span class="html-attribute-name">style</span>="<span class="html-attribute-value">text-align:center</span>"&gt;</span></td></tr><tr><td class="line-number" value="789"></td><td class="line-content">				<span class="html-tag">&lt;h2&gt;</span>Variational inference<span class="html-tag">&lt;/h2&gt;</span></td></tr><tr><td class="line-number" value="790"></td><td class="line-content">			<span class="html-tag">&lt;/section&gt;</span></td></tr><tr><td class="line-number" value="791"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="792"></td><td class="line-content">			<span class="html-tag">&lt;section <span class="html-attribute-name">style</span>="<span class="html-attribute-value">font-size:90%</span>"&gt;</span></td></tr><tr><td class="line-number" value="793"></td><td class="line-content">				<span class="html-tag">&lt;h3&gt;</span>Variational inference: the general idea:<span class="html-tag">&lt;/h3&gt;</span></td></tr><tr><td class="line-number" value="794"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="795"></td><td class="line-content">				<span class="html-tag">&lt;div <span class="html-attribute-name">class</span>="<span class="html-attribute-value">container</span>"&gt;</span></td></tr><tr><td class="line-number" value="796"></td><td class="line-content">					<span class="html-tag">&lt;div <span class="html-attribute-name">style</span>="<span class="html-attribute-value">flex-grow: 2</span>"&gt;</span></td></tr><tr><td class="line-number" value="797"></td><td class="line-content">						<span class="html-tag">&lt;p&gt;</span>Approximate complex distribution with a simpler, tractable distribution<span class="html-tag">&lt;/p&gt;</span></td></tr><tr><td class="line-number" value="798"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="799"></td><td class="line-content">						<span class="html-tag">&lt;p&gt;</span>Measure similarity between target \(p(z)\) and approximation distributions \(q(z)\) using the Kullback Leibler divergence: \[\text{KL(q||p}) = \int q(z) \ln\frac{q(z)}{p(z)}dz\]<span class="html-tag">&lt;/p&gt;</span></td></tr><tr><td class="line-number" value="800"></td><td class="line-content">					<span class="html-tag">&lt;/div&gt;</span></td></tr><tr><td class="line-number" value="801"></td><td class="line-content">					<span class="html-tag">&lt;div&gt;</span></td></tr><tr><td class="line-number" value="802"></td><td class="line-content">						<span class="html-tag">&lt;img <span class="html-attribute-name">class</span>="<span class="html-attribute-value">noborder prml</span>" <span class="html-attribute-name">style</span>="<span class="html-attribute-value">width:100%</span>" <span class="html-attribute-name">src</span>="<a class="html-attribute-value html-resource-link" target="_blank" href="https://wouterboomsma.github.io/pml2024/prmlfigs-svg/Figure10.1a.svg" rel="noreferrer noopener">../prmlfigs-svg/Figure10.1a.svg</a>" <span class="html-attribute-name">alt</span>=""&gt;</span></td></tr><tr><td class="line-number" value="803"></td><td class="line-content">						<span class="html-tag">&lt;div <span class="html-attribute-name">style</span>="<span class="html-attribute-value">padding-left: 1em; padding-right:1em; font-size:50%</span>"&gt;</span>Red: Laplace approximation. <span class="html-tag">&lt;br&gt;</span>Green: Variational approximation.<span class="html-tag">&lt;/div&gt;</span></td></tr><tr><td class="line-number" value="804"></td><td class="line-content">					<span class="html-tag">&lt;/div&gt;</span></td></tr><tr><td class="line-number" value="805"></td><td class="line-content">				<span class="html-tag">&lt;/div&gt;</span></td></tr><tr><td class="line-number" value="806"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="807"></td><td class="line-content">				<span class="html-tag">&lt;p <span class="html-attribute-name">class</span>="<span class="html-attribute-value">fragment</span>"&gt;</span>We will see that this turns inference into an optimization problem: "inference", the reasoning about probability distributions of unknown variables, becomes a matter of finding the optimal probability distribution among a predefined family of distributions.<span class="html-tag">&lt;/p&gt;</span></td></tr><tr><td class="line-number" value="808"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="809"></td><td class="line-content">			<span class="html-tag">&lt;/section&gt;</span></td></tr><tr><td class="line-number" value="810"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="811"></td><td class="line-content"><span class="html-comment">&lt;!--				&lt;section&gt;--&gt;</span></td></tr><tr><td class="line-number" value="812"></td><td class="line-content"><span class="html-comment">&lt;!--					&lt;h3&gt;What do we hope to achieve&lt;/h3&gt;--&gt;</span></td></tr><tr><td class="line-number" value="813"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="814"></td><td class="line-content"><span class="html-comment">&lt;!--				&lt;/section&gt;--&gt;</span></td></tr><tr><td class="line-number" value="815"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="816"></td><td class="line-content">			<span class="html-comment">&lt;!-- &lt;section style="font-size:80%"&gt;</span></td></tr><tr><td class="line-number" value="817"></td><td class="line-content"><span class="html-comment">				&lt;h3&gt;Remember our discussion on EM?&lt;/h3&gt;</span></td></tr><tr><td class="line-number" value="818"></td><td class="line-content"><span class="html-comment"><br></span></td></tr><tr><td class="line-number" value="819"></td><td class="line-content"><span class="html-comment">				Repeating the central slide here:</span></td></tr><tr><td class="line-number" value="820"></td><td class="line-content"><span class="html-comment"><br></span></td></tr><tr><td class="line-number" value="821"></td><td class="line-content"><span class="html-comment">				&lt;div class="container"&gt;</span></td></tr><tr><td class="line-number" value="822"></td><td class="line-content"><span class="html-comment">					&lt;div style="flex-grow:2; padding:0.5em; padding-bottom:0.25em;"&gt;</span></td></tr><tr><td class="line-number" value="823"></td><td class="line-content"><span class="html-comment">						&lt;span data-fragment-index="1"&gt;The product rule states \(p(\boldsymbol X) = \frac{p(\boldsymbol X,\boldsymbol Z)}{p(\boldsymbol Z|\boldsymbol X)}\), so</span></td></tr><tr><td class="line-number" value="824"></td><td class="line-content"><span class="html-comment">						\[\ln p(\boldsymbol X|\boldsymbol \theta) = \ln p(\boldsymbol X, \boldsymbol Z |\boldsymbol \theta) - \ln p(\boldsymbol Z |\boldsymbol X, \boldsymbol \theta)\]</span></td></tr><tr><td class="line-number" value="825"></td><td class="line-content"><span class="html-comment">						&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="826"></td><td class="line-content"><span class="html-comment"><br></span></td></tr><tr><td class="line-number" value="827"></td><td class="line-content"><span class="html-comment">						&lt;p class="fragment" data-fragment-index="2" style="margin-bottom:0.25em; margin-top:1em"&gt;Add and subtract \(\ln q(\boldsymbol Z)\) (valid for any choice of \(q\)):&lt;/p&gt;</span></td></tr><tr><td class="line-number" value="828"></td><td class="line-content"><span class="html-comment"><br></span></td></tr><tr><td class="line-number" value="829"></td><td class="line-content"><span class="html-comment">					&lt;/div&gt;</span></td></tr><tr><td class="line-number" value="830"></td><td class="line-content"><span class="html-comment">					&lt;div style=" margin-bottom:0; font-size:90%"&gt;</span></td></tr><tr><td class="line-number" value="831"></td><td class="line-content"><span class="html-comment">						&lt;img class="noborder center prml" style="width:100%; margin-top:1em" src="../prmlfigs-svg/Figure9.11.svg"&gt;</span></td></tr><tr><td class="line-number" value="832"></td><td class="line-content"><span class="html-comment">					&lt;/div&gt;</span></td></tr><tr><td class="line-number" value="833"></td><td class="line-content"><span class="html-comment">				&lt;/div&gt;</span></td></tr><tr><td class="line-number" value="834"></td><td class="line-content"><span class="html-comment"><br></span></td></tr><tr><td class="line-number" value="835"></td><td class="line-content"><span class="html-comment">				&lt;span class="fragment"&gt;</span></td></tr><tr><td class="line-number" value="836"></td><td class="line-content"><span class="html-comment">				\[\begin{align*}\ln p(\boldsymbol X|\boldsymbol \theta) &amp;= \ln p(\boldsymbol X, \boldsymbol Z |\boldsymbol \theta) - \ln q(\boldsymbol Z) - (\ln p(\boldsymbol Z |\boldsymbol X, \boldsymbol \theta) - \ln q(\boldsymbol Z)) \\</span></td></tr><tr><td class="line-number" value="837"></td><td class="line-content"><span class="html-comment">				&amp;=\ln\frac{p(\boldsymbol X, \boldsymbol Z |\boldsymbol \theta)}{q(\boldsymbol Z)} - \ln \frac{p(\boldsymbol Z |\boldsymbol X, \boldsymbol \theta)}{q(\boldsymbol Z)} \end{align*}\]</span></td></tr><tr><td class="line-number" value="838"></td><td class="line-content"><span class="html-comment">				&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="839"></td><td class="line-content"><span class="html-comment"><br></span></td></tr><tr><td class="line-number" value="840"></td><td class="line-content"><span class="html-comment">				&lt;span class="fragment"&gt;</span></td></tr><tr><td class="line-number" value="841"></td><td class="line-content"><span class="html-comment">				Since this holds for any \(\boldsymbol Z\), it also holds for \(\mathbb{E}_{\boldsymbol Z}\) under any distribution over \(\boldsymbol Z\). We choose \(q(\boldsymbol Z)\):</span></td></tr><tr><td class="line-number" value="842"></td><td class="line-content"><span class="html-comment"><br></span></td></tr><tr><td class="line-number" value="843"></td><td class="line-content"><span class="html-comment">				\[\underbrace{\mathbb{E}_{\boldsymbol Z \sim q(\boldsymbol Z)} \ln p(\boldsymbol X|\boldsymbol \theta)}_{=\ln p(\boldsymbol X|\boldsymbol \theta)} = \underbrace{\mathbb{E}_{\boldsymbol Z \sim q(\boldsymbol Z)} \left (\ln \frac{p(\boldsymbol X, \boldsymbol Z |\boldsymbol \theta)}{q(\boldsymbol Z)} \right )}_{\mathcal{L(q, \boldsymbol \theta)}} + \underbrace{\mathbb{E}_{\boldsymbol Z \sim q(\boldsymbol Z)} \left(-\ln \frac{p(\boldsymbol Z |\boldsymbol X, \boldsymbol \theta)}{q(\boldsymbol Z)} \right )}_{\text{KL}(q||p)}\]</span></td></tr><tr><td class="line-number" value="844"></td><td class="line-content"><span class="html-comment">				&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="845"></td><td class="line-content"><span class="html-comment"><br></span></td></tr><tr><td class="line-number" value="846"></td><td class="line-content"><span class="html-comment">				&lt;aside class="notes"&gt;</span></td></tr><tr><td class="line-number" value="847"></td><td class="line-content"><span class="html-comment">					&lt;p&gt;Note that the notation is slightly imprecise here: \(\text{KL}(q||p)\) should be \text{KL}(q||p(z|x))&lt;/p&gt;</span></td></tr><tr><td class="line-number" value="848"></td><td class="line-content"><span class="html-comment">				&lt;/aside&gt;</span></td></tr><tr><td class="line-number" value="849"></td><td class="line-content"><span class="html-comment"><br></span></td></tr><tr><td class="line-number" value="850"></td><td class="line-content"><span class="html-comment">			&lt;/section&gt; --&gt;</span></td></tr><tr><td class="line-number" value="851"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="852"></td><td class="line-content">			<span class="html-tag">&lt;section <span class="html-attribute-name">style</span>="<span class="html-attribute-value">font-size:80%</span>"&gt;</span></td></tr><tr><td class="line-number" value="853"></td><td class="line-content">				<span class="html-tag">&lt;h3&gt;</span>Variational Inference / Variational Bayes<span class="html-tag">&lt;/h3&gt;</span></td></tr><tr><td class="line-number" value="854"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="855"></td><td class="line-content">				<span class="html-tag">&lt;div <span class="html-attribute-name">class</span>="<span class="html-attribute-value">container</span>"&gt;</span></td></tr><tr><td class="line-number" value="856"></td><td class="line-content">					<span class="html-tag">&lt;div&gt;</span></td></tr><tr><td class="line-number" value="857"></td><td class="line-content">						<span class="html-tag">&lt;p&gt;</span>When discussing the EM algorithm, we considered the following decomposition of the evidence<span class="html-tag">&lt;/p&gt;</span></td></tr><tr><td class="line-number" value="858"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="859"></td><td class="line-content">						\[\begin{align*}\ln p(\boldsymbol x) =&amp; ~\underbrace{\mathbb{E}_{\boldsymbol z \sim q(\boldsymbol z)} \left (\ln \frac{p(\boldsymbol x, \boldsymbol z)}{q(\boldsymbol z)} \right )}_{\mathcal{L(q)}} \\+&amp;~ \underbrace{\mathbb{E}_{\boldsymbol z \sim q(\boldsymbol z)} \left(-\ln \frac{p(\boldsymbol z |\boldsymbol x)}{q(\boldsymbol z)} \right )}_{\text{KL}(q(z)||p(z|x))}\end{align*}\]</td></tr><tr><td class="line-number" value="860"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="861"></td><td class="line-content">					<span class="html-tag">&lt;/div&gt;</span></td></tr><tr><td class="line-number" value="862"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="863"></td><td class="line-content">					<span class="html-tag">&lt;div <span class="html-attribute-name">style</span>="<span class="html-attribute-value">text-align:center;</span>"&gt;</span></td></tr><tr><td class="line-number" value="864"></td><td class="line-content">						<span class="html-tag">&lt;div <span class="html-attribute-name">style</span>="<span class="html-attribute-value">border: 1px solid lightgrey; padding-right:0.25em; padding-bottom:0.25em;padding-top:0.25em; padding-left:0; font-size:80%; background-color: #fafafa;</span>"&gt;</span></td></tr><tr><td class="line-number" value="865"></td><td class="line-content">							\[\underbrace{p(\boldsymbol z|\boldsymbol x)}_{\text{posterior}} = \frac{\overbrace{p(\boldsymbol x|\boldsymbol z)}^{\text{likelihood}}\overbrace{p(\boldsymbol z)}^{\text{prior}}}{\underbrace{p(\boldsymbol x)}_{\text{evidence / marginal log-likelihood}}}\]</td></tr><tr><td class="line-number" value="866"></td><td class="line-content">						<span class="html-tag">&lt;/div&gt;</span></td></tr><tr><td class="line-number" value="867"></td><td class="line-content">						<span class="html-tag">&lt;img <span class="html-attribute-name">class</span>="<span class="html-attribute-value">noborder prml</span>" <span class="html-attribute-name">style</span>="<span class="html-attribute-value">width:80%; margin-top:2em;</span>" <span class="html-attribute-name">src</span>="<a class="html-attribute-value html-resource-link" target="_blank" href="https://wouterboomsma.github.io/pml2024/prmlfigs-svg/Figure9.11.svg" rel="noreferrer noopener">../prmlfigs-svg/Figure9.11.svg</a>" <span class="html-attribute-name">alt</span>=""&gt;</span></td></tr><tr><td class="line-number" value="868"></td><td class="line-content">					<span class="html-tag">&lt;/div&gt;</span></td></tr><tr><td class="line-number" value="869"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="870"></td><td class="line-content">				<span class="html-tag">&lt;/div&gt;</span></td></tr><tr><td class="line-number" value="871"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="872"></td><td class="line-content">				<span class="html-tag">&lt;p&gt;</span>Idea in EM:</td></tr><tr><td class="line-number" value="873"></td><td class="line-content">					find \(q(z)\) that minimizes \(\text{KL}(q(z)||p(z|x))\)<span class="html-tag">&lt;/p&gt;</span></td></tr><tr><td class="line-number" value="874"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="875"></td><td class="line-content"><span class="html-comment">&lt;!--					&lt;div style="float:right; border: 1px solid lightgrey; font-size:80%; padding-right:0.25em; padding-bottom:0.25em;padding-top:0.25em; padding-left:0; margin:0.5em;"&gt;--&gt;</span></td></tr><tr><td class="line-number" value="876"></td><td class="line-content"><span class="html-comment">&lt;!--						\[\underbrace{p(\boldsymbol z|\boldsymbol x)}_{\text{posterior}} = \frac{\overbrace{p(\boldsymbol x|\boldsymbol z)}^{\text{likelihood}}\overbrace{p(\boldsymbol z)}^{\text{prior}}}{\underbrace{p(\boldsymbol x)}_{\text{evidence / marginal log-likelihood}}}\]--&gt;</span></td></tr><tr><td class="line-number" value="877"></td><td class="line-content"><span class="html-comment">&lt;!--					&lt;/div&gt;--&gt;</span></td></tr><tr><td class="line-number" value="878"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="879"></td><td class="line-content"><span class="html-comment">&lt;!--					&lt;p&gt;When we discussed EM, we considered the following decomposition&lt;/p&gt;--&gt;</span></td></tr><tr><td class="line-number" value="880"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="881"></td><td class="line-content"><span class="html-comment">&lt;!--					&lt;div style="clear:both"&gt;&lt;/div&gt;--&gt;</span></td></tr><tr><td class="line-number" value="882"></td><td class="line-content"><span class="html-comment">&lt;!--					\[\begin{align*}\ln p(\boldsymbol x) =&amp; ~\underbrace{\mathbb{E}_{\boldsymbol z \sim q(\boldsymbol z)} \left (\ln \frac{p(\boldsymbol x, \boldsymbol z)}{q(\boldsymbol z)} \right )}_{\mathcal{L(q)}} \\+&amp;~ \underbrace{\mathbb{E}_{\boldsymbol z \sim q(\boldsymbol z)} \left(-\ln \frac{p(\boldsymbol z |\boldsymbol x)}{q(\boldsymbol z)} \right )}_{\text{KL}(q||p(z|x))}\end{align*}\]--&gt;</span></td></tr><tr><td class="line-number" value="883"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="884"></td><td class="line-content"><span class="html-comment">&lt;!--					&lt;div style="float:right; width:50%"&gt;--&gt;</span></td></tr><tr><td class="line-number" value="885"></td><td class="line-content"><span class="html-comment">&lt;!--						&lt;img class="noborder prml" style="width:100%" src="../prmlfigs-svg/Figure9.11.svg" alt=""&gt;--&gt;</span></td></tr><tr><td class="line-number" value="886"></td><td class="line-content"><span class="html-comment">&lt;!--					&lt;/div&gt;--&gt;</span></td></tr><tr><td class="line-number" value="887"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="888"></td><td class="line-content">			<span class="html-tag">&lt;/section&gt;</span></td></tr><tr><td class="line-number" value="889"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="890"></td><td class="line-content">			<span class="html-comment">&lt;!-- &lt;section style="font-size:90%"&gt;</span></td></tr><tr><td class="line-number" value="891"></td><td class="line-content"><span class="html-comment"><br></span></td></tr><tr><td class="line-number" value="892"></td><td class="line-content"><span class="html-comment">				&lt;h3&gt;VI: Two scenarios&lt;/h3&gt;</span></td></tr><tr><td class="line-number" value="893"></td><td class="line-content"><span class="html-comment"><br></span></td></tr><tr><td class="line-number" value="894"></td><td class="line-content"><span class="html-comment">				&lt;dl class="list"&gt;</span></td></tr><tr><td class="line-number" value="895"></td><td class="line-content"><span class="html-comment">					&lt;dt&gt;Partly variational (partly maximum likelihood):&lt;/dt&gt;</span></td></tr><tr><td class="line-number" value="896"></td><td class="line-content"><span class="html-comment">					&lt;dd&gt;We have some parameters which we characterize by distributions, others by point estimates. For instance, for mixture models, we modeled the latent variables using probability distributions, but had point estimates for the parameters in each component. We thus ultimately &lt;em&gt;maximize&lt;/em&gt; \(p(x; \theta)\) wrt \(\theta\) (like we did in EM).&lt;/dd&gt;</span></td></tr><tr><td class="line-number" value="897"></td><td class="line-content"><span class="html-comment"><br></span></td></tr><tr><td class="line-number" value="898"></td><td class="line-content"><span class="html-comment">					&lt;dt class="spaced"&gt;Fully variational:&lt;/dt&gt;</span></td></tr><tr><td class="line-number" value="899"></td><td class="line-content"><span class="html-comment">					&lt;dd&gt;We describe all parameters using distributions. We find the optimal approximations \(q\) for all of them.&lt;/dd&gt;</span></td></tr><tr><td class="line-number" value="900"></td><td class="line-content"><span class="html-comment">				&lt;/dl&gt;</span></td></tr><tr><td class="line-number" value="901"></td><td class="line-content"><span class="html-comment"><br></span></td></tr><tr><td class="line-number" value="902"></td><td class="line-content"><span class="html-comment">			&lt;/section&gt; --&gt;</span></td></tr><tr><td class="line-number" value="903"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="904"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="905"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="906"></td><td class="line-content">			<span class="html-comment">&lt;!--				&lt;section style="font-size:80%"&gt;--&gt;</span></td></tr><tr><td class="line-number" value="907"></td><td class="line-content"><span class="html-comment">&lt;!--					&lt;h3&gt;Variational inference - decomposing the "evidence"&lt;/h3&gt;--&gt;</span></td></tr><tr><td class="line-number" value="908"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="909"></td><td class="line-content"><span class="html-comment">&lt;!--					&lt;div class="container"&gt;--&gt;</span></td></tr><tr><td class="line-number" value="910"></td><td class="line-content"><span class="html-comment">&lt;!--						&lt;div style="flex-grow: 2"&gt;--&gt;</span></td></tr><tr><td class="line-number" value="911"></td><td class="line-content"><span class="html-comment">&lt;!--							&lt;p&gt;When we talked about EM, we looked at the following decomposition&lt;/p&gt;--&gt;</span></td></tr><tr><td class="line-number" value="912"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="913"></td><td class="line-content"><span class="html-comment">&lt;!--							\[\]--&gt;</span></td></tr><tr><td class="line-number" value="914"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="915"></td><td class="line-content"><span class="html-comment">&lt;!--							&lt;p&gt;This equation forms the basis for variational inference.&lt;/p&gt;--&gt;</span></td></tr><tr><td class="line-number" value="916"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="917"></td><td class="line-content"><span class="html-comment">&lt;!--							&lt;p&gt;In EM we could evaluate p(z|)...we cannot do this in general. Idea in variational inference. Find approximations q(z) which are tractable--&gt;</span></td></tr><tr><td class="line-number" value="918"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="919"></td><td class="line-content"><span class="html-comment">&lt;!--						&lt;/div&gt;--&gt;</span></td></tr><tr><td class="line-number" value="920"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="921"></td><td class="line-content"><span class="html-comment">&lt;!--						&lt;div&gt;--&gt;</span></td></tr><tr><td class="line-number" value="922"></td><td class="line-content"><span class="html-comment">&lt;!--							&lt;img class="noborder prml" style="width:100%" src="../prmlfigs-svg/Figure9.11.svg" alt=""&gt;--&gt;</span></td></tr><tr><td class="line-number" value="923"></td><td class="line-content"><span class="html-comment">&lt;!--						&lt;/div&gt;--&gt;</span></td></tr><tr><td class="line-number" value="924"></td><td class="line-content"><span class="html-comment">&lt;!--					&lt;/div&gt;--&gt;</span></td></tr><tr><td class="line-number" value="925"></td><td class="line-content"><span class="html-comment">&lt;!--				&lt;/section&gt;--&gt;</span></td></tr><tr><td class="line-number" value="926"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="927"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="928"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="929"></td><td class="line-content">			<span class="html-tag">&lt;section <span class="html-attribute-name">style</span>="<span class="html-attribute-value">font-size:80%</span>"&gt;</span></td></tr><tr><td class="line-number" value="930"></td><td class="line-content">				<span class="html-tag">&lt;h3&gt;</span>Minimizing \(\text{KL}(q(z)||p(z|x))\)<span class="html-tag">&lt;/h3&gt;</span></td></tr><tr><td class="line-number" value="931"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="932"></td><td class="line-content">				<span class="html-tag">&lt;div <span class="html-attribute-name">class</span>="<span class="html-attribute-value">container</span>"&gt;</span></td></tr><tr><td class="line-number" value="933"></td><td class="line-content">					<span class="html-tag">&lt;div&gt;</span></td></tr><tr><td class="line-number" value="934"></td><td class="line-content">						<span class="html-tag">&lt;p&gt;</span>Idea: we need to minimize \(\text{KL}(q(z)||p(z|x))\)<span class="html-tag">&lt;/p&gt;</span></td></tr><tr><td class="line-number" value="935"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="936"></td><td class="line-content">						<span class="html-tag">&lt;p&gt;</span>For Gaussian mixture models, this was easy. We could simply choose \(q(z) = p(z|x)\)<span class="html-tag">&lt;/p&gt;</span></td></tr><tr><td class="line-number" value="937"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="938"></td><td class="line-content">						<span class="html-tag">&lt;p&gt;</span>For more complex models, \(p(z|x)\) will be intractable. So what can we do?<span class="html-tag">&lt;/p&gt;</span></td></tr><tr><td class="line-number" value="939"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="940"></td><td class="line-content">					<span class="html-tag">&lt;/div&gt;</span></td></tr><tr><td class="line-number" value="941"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="942"></td><td class="line-content">					<span class="html-tag">&lt;div <span class="html-attribute-name">style</span>="<span class="html-attribute-value">text-align:center</span>"&gt;</span></td></tr><tr><td class="line-number" value="943"></td><td class="line-content">						<span class="html-tag">&lt;div <span class="html-attribute-name">style</span>="<span class="html-attribute-value">font-size:80%</span>"&gt;</span></td></tr><tr><td class="line-number" value="944"></td><td class="line-content">							\[\begin{align*}\ln p(\boldsymbol x) =&amp; ~\underbrace{\mathbb{E}_{\boldsymbol z \sim q(\boldsymbol z)} \left (\ln \frac{p(\boldsymbol x, \boldsymbol z)}{q(\boldsymbol z)} \right )}_{\mathcal{L(q)}} \\+&amp;~ \underbrace{\mathbb{E}_{\boldsymbol z \sim q(\boldsymbol z)} \left(-\ln \frac{p(\boldsymbol z |\boldsymbol x)}{q(\boldsymbol z)} \right )}_{\text{KL}(q(z)||p(z|x))}\end{align*}\]</td></tr><tr><td class="line-number" value="945"></td><td class="line-content">						<span class="html-tag">&lt;/div&gt;</span></td></tr><tr><td class="line-number" value="946"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="947"></td><td class="line-content">						<span class="html-tag">&lt;img <span class="html-attribute-name">class</span>="<span class="html-attribute-value">noborder prml</span>" <span class="html-attribute-name">style</span>="<span class="html-attribute-value">width:60%; margin-top:1em;</span>" <span class="html-attribute-name">src</span>="<a class="html-attribute-value html-resource-link" target="_blank" href="https://wouterboomsma.github.io/pml2024/prmlfigs-svg/Figure9.11.svg" rel="noreferrer noopener">../prmlfigs-svg/Figure9.11.svg</a>" <span class="html-attribute-name">alt</span>=""&gt;</span></td></tr><tr><td class="line-number" value="948"></td><td class="line-content">					<span class="html-tag">&lt;/div&gt;</span></td></tr><tr><td class="line-number" value="949"></td><td class="line-content">				<span class="html-tag">&lt;/div&gt;</span></td></tr><tr><td class="line-number" value="950"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="951"></td><td class="line-content">				<span class="html-tag">&lt;p <span class="html-attribute-name">class</span>="<span class="html-attribute-value">fragment</span>" <span class="html-attribute-name">data-fragment-index</span>="<span class="html-attribute-value">1</span>"&gt;</span>We can maximize \(\mathcal{L(q)}\) instead. Since the KL is non-negative, \(\mathcal{L(q)}\) will be a lower bound on \(p(x)\)<span class="html-tag">&lt;/p&gt;</span></td></tr><tr><td class="line-number" value="952"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="953"></td><td class="line-content">				<span class="html-tag">&lt;p <span class="html-attribute-name">class</span>="<span class="html-attribute-value">fragment</span>" <span class="html-attribute-name">data-fragment-index</span>="<span class="html-attribute-value">1</span>"&gt;</span>We call \(\mathcal{L(q)}\) the Evidence Lower Bound (ELBO)<span class="html-tag">&lt;/p&gt;</span></td></tr><tr><td class="line-number" value="954"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="955"></td><td class="line-content">			<span class="html-tag">&lt;/section&gt;</span></td></tr><tr><td class="line-number" value="956"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="957"></td><td class="line-content">			<span class="html-tag">&lt;section <span class="html-attribute-name">style</span>="<span class="html-attribute-value">font-size:90%</span>"&gt;</span></td></tr><tr><td class="line-number" value="958"></td><td class="line-content">				<span class="html-tag">&lt;h3&gt;</span>Deconstructing the ELBO<span class="html-tag">&lt;/h3&gt;</span></td></tr><tr><td class="line-number" value="959"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="960"></td><td class="line-content">				<span class="html-tag">&lt;div <span class="html-attribute-name">style</span>="<span class="html-attribute-value">margin-top:1em</span>"&gt;</span></td></tr><tr><td class="line-number" value="961"></td><td class="line-content">					\[\begin{align*}\mathcal{L(q)} &amp;= \mathbb{E}_{q(\boldsymbol z)} \left (\ln \frac{p(\boldsymbol x, \boldsymbol z)}{q(\boldsymbol z)} \right ) = \mathbb{E}_{q(\boldsymbol z)} \left (\ln \frac{p(\boldsymbol x|\boldsymbol z)p(\boldsymbol z)}{q(\boldsymbol z)} \right )\end{align*}\]</td></tr><tr><td class="line-number" value="962"></td><td class="line-content">					<span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">fragment</span>"&gt;</span></td></tr><tr><td class="line-number" value="963"></td><td class="line-content">						\[\begin{align*}\htmlStyle{visibility:hidden;}{\mathcal{L(q)}}</td></tr><tr><td class="line-number" value="964"></td><td class="line-content">						&amp;= \mathbb{E}_{q(\boldsymbol z)}\ln p(\boldsymbol x|\boldsymbol z) + \mathbb{E}_{q(\boldsymbol z)} \left (\ln \frac{p(\boldsymbol z)}{q(\boldsymbol z)} \right )</td></tr><tr><td class="line-number" value="965"></td><td class="line-content">						\end{align*}\]<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="966"></td><td class="line-content">					<span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">fragment</span>"&gt;</span></td></tr><tr><td class="line-number" value="967"></td><td class="line-content">						\[\begin{align*}\htmlStyle{visibility:hidden;}{\mathcal{L(q)}}</td></tr><tr><td class="line-number" value="968"></td><td class="line-content">						&amp;= \mathbb{E}_{q(\boldsymbol z)}\ln p(\boldsymbol x|\boldsymbol z) - \mathbb{E}_{q(\boldsymbol z)} \left (\ln \frac{q(\boldsymbol z)}{p(\boldsymbol z)} \right )</td></tr><tr><td class="line-number" value="969"></td><td class="line-content">						\end{align*}\]</td></tr><tr><td class="line-number" value="970"></td><td class="line-content">					<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="971"></td><td class="line-content">					<span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">fragment</span>"&gt;</span></td></tr><tr><td class="line-number" value="972"></td><td class="line-content">						\[\begin{align*}\htmlStyle{visibility:hidden;}{\mathcal{L(q)}}</td></tr><tr><td class="line-number" value="973"></td><td class="line-content">						= \mathbb{E}_{q(\boldsymbol z)}\ln p(\boldsymbol x|\boldsymbol z) - \text{KL}(q(\boldsymbol z) || p(\boldsymbol z))</td></tr><tr><td class="line-number" value="974"></td><td class="line-content">						\end{align*}\]</td></tr><tr><td class="line-number" value="975"></td><td class="line-content">					<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="976"></td><td class="line-content">					<span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">fragment</span>"&gt;</span></td></tr><tr><td class="line-number" value="977"></td><td class="line-content">					Maximizing the ELBO is thus a trade-off between:</td></tr><tr><td class="line-number" value="978"></td><td class="line-content">					<span class="html-tag">&lt;dl <span class="html-attribute-name">class</span>="<span class="html-attribute-value">list</span>"&gt;</span></td></tr><tr><td class="line-number" value="979"></td><td class="line-content">						<span class="html-tag">&lt;dt&gt;</span>Maximizing the ability to reconstruct \(x\) from \(z\).<span class="html-tag">&lt;/dt&gt;</span></td></tr><tr><td class="line-number" value="980"></td><td class="line-content">						<span class="html-tag">&lt;dt&gt;</span>Minimizing the KL penalty, which tries to keep \(q(\boldsymbol z)\) close to the prior \(p(\boldsymbol z)\).<span class="html-tag">&lt;/dt&gt;</span></td></tr><tr><td class="line-number" value="981"></td><td class="line-content">					<span class="html-tag">&lt;/dl&gt;</span></td></tr><tr><td class="line-number" value="982"></td><td class="line-content">					<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="983"></td><td class="line-content">				<span class="html-tag">&lt;/div&gt;</span></td></tr><tr><td class="line-number" value="984"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="985"></td><td class="line-content">			<span class="html-tag">&lt;/section&gt;</span></td></tr><tr><td class="line-number" value="986"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="987"></td><td class="line-content">			<span class="html-tag">&lt;section <span class="html-attribute-name">style</span>="<span class="html-attribute-value">font-size:90%</span>"&gt;</span></td></tr><tr><td class="line-number" value="988"></td><td class="line-content">				<span class="html-tag">&lt;h3&gt;</span>ELBO derivation using Jensen's inequality<span class="html-tag">&lt;/h3&gt;</span></td></tr><tr><td class="line-number" value="989"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="990"></td><td class="line-content">				<span class="html-tag">&lt;div <span class="html-attribute-name">class</span>="<span class="html-attribute-value">container</span>"&gt;</span></td></tr><tr><td class="line-number" value="991"></td><td class="line-content">					<span class="html-tag">&lt;div <span class="html-attribute-name">style</span>="<span class="html-attribute-value">flex-grow: 1.5</span>"&gt;</span></td></tr><tr><td class="line-number" value="992"></td><td class="line-content">						<span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">fragment</span>"&gt;</span></td></tr><tr><td class="line-number" value="993"></td><td class="line-content">						<span class="html-tag">&lt;p&gt;</span>Alternative ELBO derivation:<span class="html-tag">&lt;/p&gt;</span></td></tr><tr><td class="line-number" value="994"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="995"></td><td class="line-content">						\[\begin{align*}\ln p(x) &amp;= \ln \int p(x,z)dz\end{align*}\]</td></tr><tr><td class="line-number" value="996"></td><td class="line-content">						<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="997"></td><td class="line-content">						<span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">fragment</span>"&gt;</span></td></tr><tr><td class="line-number" value="998"></td><td class="line-content">						\[\begin{align*}\htmlStyle{visibility:hidden;}{\ln p(x)} &amp;= \ln \int \frac{p(x,z)}{q(z)}q(z)dz \end{align*}\]</td></tr><tr><td class="line-number" value="999"></td><td class="line-content">						<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="1000"></td><td class="line-content">						<span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">fragment</span>"&gt;</span></td></tr><tr><td class="line-number" value="1001"></td><td class="line-content">						\[\begin{align*}\htmlStyle{visibility:hidden;}{\ln p(x)} &amp;= \ln \left (\mathbb{E}_{q(\boldsymbol z)} \left [ \frac{p(x,z)}{q(z)}\right ]\right) \end{align*}\]</td></tr><tr><td class="line-number" value="1002"></td><td class="line-content">						<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="1003"></td><td class="line-content">						<span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">fragment</span>"&gt;</span></td></tr><tr><td class="line-number" value="1004"></td><td class="line-content">						\[\begin{align*}\htmlStyle{visibility:hidden;}{\ln p(x)} &amp;\ge  \mathbb{E}_{q(\boldsymbol z)} \left [\ln \left (\frac{p(x,z)}{q(z)} \right )\right ] \end{align*}\]</td></tr><tr><td class="line-number" value="1005"></td><td class="line-content">						<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="1006"></td><td class="line-content">					<span class="html-tag">&lt;/div&gt;</span></td></tr><tr><td class="line-number" value="1007"></td><td class="line-content">					<span class="html-tag">&lt;div&gt;</span></td></tr><tr><td class="line-number" value="1008"></td><td class="line-content">					<span class="html-tag">&lt;div <span class="html-attribute-name">style</span>="<span class="html-attribute-value">font-size:75%; border:1px solid lightgrey; background:#fafafa; margin:0.5em; padding:0.5em;</span>"&gt;</span></td></tr><tr><td class="line-number" value="1009"></td><td class="line-content">						<span class="html-tag">&lt;h4&gt;</span>Jensen's inequality:<span class="html-tag">&lt;/h4&gt;</span></td></tr><tr><td class="line-number" value="1010"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="1011"></td><td class="line-content">						For a concave function \(f(x)\):</td></tr><tr><td class="line-number" value="1012"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="1013"></td><td class="line-content">						\[f(\mathbb{E}[x]) \ge \mathbb{E}[f(x)]\]</td></tr><tr><td class="line-number" value="1014"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="1015"></td><td class="line-content">						<span class="html-tag">&lt;span&gt;</span></td></tr><tr><td class="line-number" value="1016"></td><td class="line-content">						<span class="html-tag">&lt;div&gt;</span></td></tr><tr><td class="line-number" value="1017"></td><td class="line-content">							Specifically:</td></tr><tr><td class="line-number" value="1018"></td><td class="line-content"><span class="html-comment">&lt;!--								&lt;img class="noborder" style="width:60%;" src="log_function.svg" alt=""&gt;--&gt;</span></td></tr><tr><td class="line-number" value="1019"></td><td class="line-content">							\[\ln \mathbb{E}[x] \ge \mathbb{E}[\ln x]\]</td></tr><tr><td class="line-number" value="1020"></td><td class="line-content">						<span class="html-tag">&lt;/div&gt;</span></td></tr><tr><td class="line-number" value="1021"></td><td class="line-content">						<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="1022"></td><td class="line-content"><span class="html-comment">&lt;!--							&lt;div style="width:100%; text-align:right"&gt;--&gt;</span></td></tr><tr><td class="line-number" value="1023"></td><td class="line-content"><span class="html-comment">&lt;!--							&lt;/div&gt;--&gt;</span></td></tr><tr><td class="line-number" value="1024"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="1025"></td><td class="line-content">					<span class="html-tag">&lt;/div&gt;</span></td></tr><tr><td class="line-number" value="1026"></td><td class="line-content">					<span class="html-tag">&lt;/div&gt;</span></td></tr><tr><td class="line-number" value="1027"></td><td class="line-content">				<span class="html-tag">&lt;/div&gt;</span></td></tr><tr><td class="line-number" value="1028"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="1029"></td><td class="line-content">			<span class="html-tag">&lt;/section&gt;</span></td></tr><tr><td class="line-number" value="1030"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="1031"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="1032"></td><td class="line-content">			<span class="html-tag">&lt;section <span class="html-attribute-name">style</span>="<span class="html-attribute-value">text-align:center</span>"&gt;</span></td></tr><tr><td class="line-number" value="1033"></td><td class="line-content">				<span class="html-tag">&lt;h2&gt;</span>Variational inference - Choosing \(q(z)\)<span class="html-tag">&lt;/h2&gt;</span></td></tr><tr><td class="line-number" value="1034"></td><td class="line-content">			<span class="html-tag">&lt;/section&gt;</span></td></tr><tr><td class="line-number" value="1035"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="1036"></td><td class="line-content">			<span class="html-tag">&lt;section&gt;</span></td></tr><tr><td class="line-number" value="1037"></td><td class="line-content">				<span class="html-tag">&lt;h3&gt;</span>How do we choose a good \(q(z)\)?<span class="html-tag">&lt;/h3&gt;</span></td></tr><tr><td class="line-number" value="1038"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="1039"></td><td class="line-content"><span class="html-comment">&lt;!--					&lt;p&gt;Challenge: find a family of distributions that is tractable, but still expressive enough to closely fit the posterior.&lt;/p&gt;--&gt;</span></td></tr><tr><td class="line-number" value="1040"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="1041"></td><td class="line-content">				<span class="html-tag">&lt;p&gt;</span>Note that \(\mathbb{E}_{q(\boldsymbol z)} \left (\ln \frac{p(\boldsymbol x, \boldsymbol z)}{q(\boldsymbol z)} \right )\) is a <span class="html-tag">&lt;em&gt;</span>functional<span class="html-tag">&lt;/em&gt;</span> in \(q\): it takes a function \(q(z)\) as input and returns a value.<span class="html-tag">&lt;/p&gt;</span></td></tr><tr><td class="line-number" value="1042"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="1043"></td><td class="line-content">				<span class="html-tag">&lt;p&gt;</span>Finding the function that optimizes a functional can be achieve used "calculus of variations", which generalizes the notion of derivatives to functionals. I.e., how the value of a functional changes when you make small changes (variations) to the input function.<span class="html-tag">&lt;/p&gt;</span></td></tr><tr><td class="line-number" value="1044"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="1045"></td><td class="line-content">				<span class="html-tag">&lt;p&gt;</span>This is where the term "variational" comes from.<span class="html-tag">&lt;/p&gt;</span></td></tr><tr><td class="line-number" value="1046"></td><td class="line-content"><span class="html-comment">&lt;!--					&lt;p&gt;which is concerned with how the value of a functional changes when you make small changes (variations) to the input function&lt;/p&gt;--&gt;</span></td></tr><tr><td class="line-number" value="1047"></td><td class="line-content">			<span class="html-tag">&lt;/section&gt;</span></td></tr><tr><td class="line-number" value="1048"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="1049"></td><td class="line-content"><span class="html-comment">&lt;!--				&lt;section style="font-size:90%"&gt;--&gt;</span></td></tr><tr><td class="line-number" value="1050"></td><td class="line-content"><span class="html-comment">&lt;!--					&lt;h3&gt;Variational inference - key concepts&lt;/h3&gt;--&gt;</span></td></tr><tr><td class="line-number" value="1051"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="1052"></td><td class="line-content"><span class="html-comment">&lt;!--					&lt;p&gt;The term "variational" comes from the field called "calculus of variations" - which generalizes the notion of derivatives to &lt;em&gt;functionals&lt;/em&gt;.&lt;/p&gt;--&gt;</span></td></tr><tr><td class="line-number" value="1053"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="1054"></td><td class="line-content"><span class="html-comment">&lt;!--					&lt;p&gt;A functional is basically a function that takes a function (rather than a value) as input. Example: Entropy: \(H[p] = \int p(x)\ln p(x) dx\)&lt;/p&gt;--&gt;</span></td></tr><tr><td class="line-number" value="1055"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="1056"></td><td class="line-content"><span class="html-comment">&lt;!--					&lt;p&gt;So, the calculus of variations is concerned with how the value of a functional changes when you make small changes (variations) to the input function - such that we can find the function that maximizes/minimizes the functional. E.g., find the function with highest entropy.&lt;/p&gt;--&gt;</span></td></tr><tr><td class="line-number" value="1057"></td><td class="line-content"><span class="html-comment">&lt;!--					&amp;lt;!&amp;ndash;					&lt;dl class="list"&gt;&amp;ndash;&amp;gt;--&gt;</span></td></tr><tr><td class="line-number" value="1058"></td><td class="line-content"><span class="html-comment">&lt;!--					&amp;lt;!&amp;ndash;						&lt;dt&gt;&lt;em&gt;Calculus of variations&lt;/em&gt;&lt;/dt&gt;&amp;ndash;&amp;gt;--&gt;</span></td></tr><tr><td class="line-number" value="1059"></td><td class="line-content"><span class="html-comment">&lt;!--					&amp;lt;!&amp;ndash;						&lt;dd&gt;Extension of calculus to derivatives of functionals rather than functions.&lt;/dd&gt;&amp;ndash;&amp;gt;--&gt;</span></td></tr><tr><td class="line-number" value="1060"></td><td class="line-content"><span class="html-comment">&lt;!--					&amp;lt;!&amp;ndash;						&lt;dt&gt;Functionals&lt;/dt&gt;&amp;ndash;&amp;gt;--&gt;</span></td></tr><tr><td class="line-number" value="1061"></td><td class="line-content"><span class="html-comment">&lt;!--					&amp;lt;!&amp;ndash;						&lt;dd&gt;Functions: map values to values&lt;br&gt;Functionals: map functions to values&lt;/dd&gt;&amp;ndash;&amp;gt;--&gt;</span></td></tr><tr><td class="line-number" value="1062"></td><td class="line-content"><span class="html-comment">&lt;!--					&amp;lt;!&amp;ndash;						&lt;dt&gt;Maximizing functionals&lt;/dt&gt;&amp;ndash;&amp;gt;--&gt;</span></td></tr><tr><td class="line-number" value="1063"></td><td class="line-content"><span class="html-comment">&lt;!--					&amp;lt;!&amp;ndash;						&lt;dt&gt;ELBO (evidence lower bound)&lt;/dt&gt;&amp;ndash;&amp;gt;--&gt;</span></td></tr><tr><td class="line-number" value="1064"></td><td class="line-content"><span class="html-comment">&lt;!--					&amp;lt;!&amp;ndash;						&lt;dt&gt;Mean field&lt;/dt&gt;&amp;ndash;&amp;gt;--&gt;</span></td></tr><tr><td class="line-number" value="1065"></td><td class="line-content"><span class="html-comment">&lt;!--					&amp;lt;!&amp;ndash;					&lt;/dl&gt;&amp;ndash;&amp;gt;--&gt;</span></td></tr><tr><td class="line-number" value="1066"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="1067"></td><td class="line-content"><span class="html-comment">&lt;!--				&lt;/section&gt;--&gt;</span></td></tr><tr><td class="line-number" value="1068"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="1069"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="1070"></td><td class="line-content">			<span class="html-tag">&lt;section <span class="html-attribute-name">style</span>="<span class="html-attribute-value">font-size:80%</span>"&gt;</span></td></tr><tr><td class="line-number" value="1071"></td><td class="line-content">				<span class="html-tag">&lt;h3&gt;</span>Choosing \(q(z)\): Free-form vs fixed-form<span class="html-tag">&lt;/h3&gt;</span></td></tr><tr><td class="line-number" value="1072"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="1073"></td><td class="line-content">				<span class="html-tag">&lt;p&gt;</span>There are two distinct approaches to variational inference<span class="html-tag">&lt;/p&gt;</span></td></tr><tr><td class="line-number" value="1074"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="1075"></td><td class="line-content">				<span class="html-tag">&lt;dl <span class="html-attribute-name">class</span>="<span class="html-attribute-value">list</span>"&gt;</span></td></tr><tr><td class="line-number" value="1076"></td><td class="line-content">					<span class="html-tag">&lt;dt&gt;</span>Free-form:<span class="html-tag">&lt;/dt&gt;</span></td></tr><tr><td class="line-number" value="1077"></td><td class="line-content">					<span class="html-tag">&lt;dd&gt;</span>No assumptions are made about the functional form of \(q\) (or the factors of \(q\)). These arise automatically as a consequence of the calculus of variations. This is the approach taken in Bishop. This is mathematically quite involved.<span class="html-tag">&lt;/dd&gt;</span></td></tr><tr><td class="line-number" value="1078"></td><td class="line-content">					<span class="html-tag">&lt;dt <span class="html-attribute-name">class</span>="<span class="html-attribute-value">spaced</span>"&gt;</span>Fixed-form:<span class="html-tag">&lt;/dt&gt;</span></td></tr><tr><td class="line-number" value="1079"></td><td class="line-content">					<span class="html-tag">&lt;dd&gt;</span>We limit ourselves to a specific family of distributions, and <span class="html-tag">&lt;em&gt;</span>optimize the parameters<span class="html-tag">&lt;/em&gt;</span> of this family to find the optimal \(q(z)\). We can use standard optimization techniques for this. This is the approach used most often in practice.<span class="html-tag">&lt;/dd&gt;</span></td></tr><tr><td class="line-number" value="1080"></td><td class="line-content">				<span class="html-tag">&lt;/dl&gt;</span></td></tr><tr><td class="line-number" value="1081"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="1082"></td><td class="line-content">				<span class="html-tag">&lt;p&gt;</span>We will consider only the second case here.<span class="html-tag">&lt;/p&gt;</span></td></tr><tr><td class="line-number" value="1083"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="1084"></td><td class="line-content">				<span class="html-tag">&lt;aside <span class="html-attribute-name">class</span>="<span class="html-attribute-value">notes</span>"&gt;</span></td></tr><tr><td class="line-number" value="1085"></td><td class="line-content">					<span class="html-tag">&lt;p&gt;</span>As you can see in Bishop, the free form approach often results in distributions from the exponential family, which is also the family typically chosen<span class="html-tag">&lt;/p&gt;</span></td></tr><tr><td class="line-number" value="1086"></td><td class="line-content">				<span class="html-tag">&lt;/aside&gt;</span></td></tr><tr><td class="line-number" value="1087"></td><td class="line-content">			<span class="html-tag">&lt;/section&gt;</span></td></tr><tr><td class="line-number" value="1088"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="1089"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="1090"></td><td class="line-content">			<span class="html-tag">&lt;section <span class="html-attribute-name">style</span>="<span class="html-attribute-value">font-size:90%</span>"&gt;</span></td></tr><tr><td class="line-number" value="1091"></td><td class="line-content">				<span class="html-tag">&lt;h3&gt;</span>Variational inference: General recipe<span class="html-tag">&lt;/h3&gt;</span></td></tr><tr><td class="line-number" value="1092"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="1093"></td><td class="line-content">				<span class="html-tag">&lt;div <span class="html-attribute-name">class</span>="<span class="html-attribute-value">container</span>" <span class="html-attribute-name">style</span>="<span class="html-attribute-value">align-items: center</span>"&gt;</span></td></tr><tr><td class="line-number" value="1094"></td><td class="line-content">					<span class="html-tag">&lt;div&gt;</span></td></tr><tr><td class="line-number" value="1095"></td><td class="line-content">						<span class="html-tag">&lt;dl <span class="html-attribute-name">class</span>="<span class="html-attribute-value">list</span>"&gt;</span></td></tr><tr><td class="line-number" value="1096"></td><td class="line-content">							<span class="html-tag">&lt;dt <span class="html-attribute-name">class</span>="<span class="html-attribute-value">spaced</span>"&gt;</span>Choose parametric, tractable family of distributions<span class="html-tag">&lt;/dt&gt;</span></td></tr><tr><td class="line-number" value="1097"></td><td class="line-content">							<span class="html-tag">&lt;dt <span class="html-attribute-name">class</span>="<span class="html-attribute-value">spaced</span>"&gt;</span>Among this family, find \(q(z)\) that minimizes the Kullback-Leibler divergence to the target \(p(z|x)\)<span class="html-tag">&lt;/dt&gt;</span></td></tr><tr><td class="line-number" value="1098"></td><td class="line-content">						<span class="html-tag">&lt;/dl&gt;</span></td></tr><tr><td class="line-number" value="1099"></td><td class="line-content">					<span class="html-tag">&lt;/div&gt;</span></td></tr><tr><td class="line-number" value="1100"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="1101"></td><td class="line-content">					<span class="html-tag">&lt;div <span class="html-attribute-name">style</span>="<span class="html-attribute-value">flex-grow: 1.5; padding:1em</span>" &gt;</span></td></tr><tr><td class="line-number" value="1102"></td><td class="line-content">						<span class="html-tag">&lt;img <span class="html-attribute-name">class</span>="<span class="html-attribute-value">noborder</span>" <span class="html-attribute-name">style</span>="<span class="html-attribute-value">width:100%</span>" <span class="html-attribute-name">src</span>="<a class="html-attribute-value html-resource-link" target="_blank" href="https://wouterboomsma.github.io/pml2024/week2/blei_variational_inference.svg" rel="noreferrer noopener">blei_variational_inference.svg</a>" <span class="html-attribute-name">alt</span>=""&gt;</span></td></tr><tr><td class="line-number" value="1103"></td><td class="line-content">						<span class="html-tag">&lt;span <span class="html-attribute-name">style</span>="<span class="html-attribute-value">font-size:50%; float:right;</span>"&gt;</span>Figure from NeurIPS tutorial by Blei et al<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="1104"></td><td class="line-content">					<span class="html-tag">&lt;/div&gt;</span></td></tr><tr><td class="line-number" value="1105"></td><td class="line-content">				<span class="html-tag">&lt;/div&gt;</span></td></tr><tr><td class="line-number" value="1106"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="1107"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="1108"></td><td class="line-content">			<span class="html-tag">&lt;/section&gt;</span></td></tr><tr><td class="line-number" value="1109"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="1110"></td><td class="line-content">			<span class="html-tag">&lt;section <span class="html-attribute-name">style</span>="<span class="html-attribute-value">font-size:80%</span>"&gt;</span></td></tr><tr><td class="line-number" value="1111"></td><td class="line-content">				<span class="html-tag">&lt;h3&gt;</span>Mean Field family<span class="html-tag">&lt;/h3&gt;</span></td></tr><tr><td class="line-number" value="1112"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="1113"></td><td class="line-content">				<span class="html-tag">&lt;p&gt;</span>We need to somehow make \(q\) managable.<span class="html-tag">&lt;/p&gt;</span></td></tr><tr><td class="line-number" value="1114"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="1115"></td><td class="line-content">				<span class="html-tag">&lt;p&gt;</span>Classic VI typically restricts itself to the Mean Field family - which assumes that \(q(\boldsymbol Z)\) factorizes completely<span class="html-tag">&lt;/dt&gt;</span></td></tr><tr><td class="line-number" value="1116"></td><td class="line-content">				<span class="html-tag">&lt;dd&gt;</span></td></tr><tr><td class="line-number" value="1117"></td><td class="line-content">					\[q(\boldsymbol Z) = \prod_{i=1}^N\prod_{j=1}^D q_{ij}(z_{ij})\]</td></tr><tr><td class="line-number" value="1118"></td><td class="line-content">				<span class="html-tag">&lt;/dd&gt;</span></td></tr><tr><td class="line-number" value="1119"></td><td class="line-content">				<span class="html-tag">&lt;/dl&gt;</span></td></tr><tr><td class="line-number" value="1120"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="1121"></td><td class="line-content">				<span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">fragment</span>"&gt;</span><span class="html-tag">&lt;p &gt;</span>Note that \(\boldsymbol Z = \{\boldsymbol z_1, \boldsymbol z_2, \ldots, \boldsymbol z_n \}\) corresponding to the latent variables associated with each data point \(\boldsymbol X = \{\boldsymbol x_1, \boldsymbol x_2, \ldots, \boldsymbol x_n\} \). We thus assume independence both between all \(\boldsymbol z_i\) and \(\boldsymbol z_j\) and between the \(D\) different variables within each \(\boldsymbol z_i\).<span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span> Each of these latent variables will have its own variational distribution.<span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="1122"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="1123"></td><td class="line-content">			<span class="html-tag">&lt;/section&gt;</span></td></tr><tr><td class="line-number" value="1124"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="1125"></td><td class="line-content">			<span class="html-tag">&lt;section&gt;</span></td></tr><tr><td class="line-number" value="1126"></td><td class="line-content">				<span class="html-tag">&lt;h3&gt;</span>Limitations of mean field<span class="html-tag">&lt;/h3&gt;</span></td></tr><tr><td class="line-number" value="1127"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="1128"></td><td class="line-content"><span class="html-comment">&lt;!--					&lt;img class="noborder prml" style="width:40%" src="../prmlfigs-svg/Figure10.1a.svg" alt=""&gt;--&gt;</span></td></tr><tr><td class="line-number" value="1129"></td><td class="line-content">				<span class="html-tag">&lt;div <span class="html-attribute-name">class</span>="<span class="html-attribute-value">container</span>"&gt;</span></td></tr><tr><td class="line-number" value="1130"></td><td class="line-content">					<span class="html-tag">&lt;div&gt;</span></td></tr><tr><td class="line-number" value="1131"></td><td class="line-content">						<span class="html-tag">&lt;p&gt;</span>The disadvantage of mean field is that we do not capture correlations between variables.<span class="html-tag">&lt;/p&gt;</span></td></tr><tr><td class="line-number" value="1132"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="1133"></td><td class="line-content">						<span class="html-tag">&lt;p&gt;</span>In some cases, it will therefore be necessary to choose \(q\) distributions with more complex covariance structure.<span class="html-tag">&lt;/p&gt;</span></td></tr><tr><td class="line-number" value="1134"></td><td class="line-content">					<span class="html-tag">&lt;/div&gt;</span></td></tr><tr><td class="line-number" value="1135"></td><td class="line-content">					<span class="html-tag">&lt;div&gt;</span></td></tr><tr><td class="line-number" value="1136"></td><td class="line-content">						<span class="html-tag">&lt;img <span class="html-attribute-name">class</span>="<span class="html-attribute-value">noborder prml center</span>" <span class="html-attribute-name">style</span>="<span class="html-attribute-value">width:75%</span>" <span class="html-attribute-name">src</span>="<a class="html-attribute-value html-resource-link" target="_blank" href="https://wouterboomsma.github.io/pml2024/prmlfigs-svg/Figure10.2a.svg" rel="noreferrer noopener">../prmlfigs-svg/Figure10.2a.svg</a>" <span class="html-attribute-name">alt</span>=""&gt;</span></td></tr><tr><td class="line-number" value="1137"></td><td class="line-content">					<span class="html-tag">&lt;/div&gt;</span></td></tr><tr><td class="line-number" value="1138"></td><td class="line-content">				<span class="html-tag">&lt;/div&gt;</span></td></tr><tr><td class="line-number" value="1139"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="1140"></td><td class="line-content"><span class="html-comment">&lt;!--					&lt;img class="noborder prml center" style="width:50%" src="../prmlfigs-svg/Figure10.2a.svg" alt=""&gt;--&gt;</span></td></tr><tr><td class="line-number" value="1141"></td><td class="line-content"><span class="html-comment">&lt;!--					&lt;img class="noborder prml" style="width:32%" src="../prmlfigs-svg/Figure10.3b.svg" alt=""&gt;--&gt;</span></td></tr><tr><td class="line-number" value="1142"></td><td class="line-content"><span class="html-comment">&lt;!--					&lt;img class="noborder prml" style="width:32%" src="../prmlfigs-svg/Figure10.3c.svg" alt=""&gt;--&gt;</span></td></tr><tr><td class="line-number" value="1143"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="1144"></td><td class="line-content">			<span class="html-tag">&lt;/section&gt;</span></td></tr><tr><td class="line-number" value="1145"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="1146"></td><td class="line-content">			<span class="html-tag">&lt;section <span class="html-attribute-name">style</span>="<span class="html-attribute-value">text-align:center</span>"&gt;</span></td></tr><tr><td class="line-number" value="1147"></td><td class="line-content">				<span class="html-tag">&lt;h2&gt;</span>Bayesian Mixture model - continued<span class="html-tag">&lt;/h2&gt;</span></td></tr><tr><td class="line-number" value="1148"></td><td class="line-content">			<span class="html-tag">&lt;/section&gt;</span></td></tr><tr><td class="line-number" value="1149"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="1150"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="1151"></td><td class="line-content">			<span class="html-tag">&lt;section <span class="html-attribute-name">style</span>="<span class="html-attribute-value">font-size:95%</span>"&gt;</span></td></tr><tr><td class="line-number" value="1152"></td><td class="line-content">				<span class="html-tag">&lt;h3&gt;</span>Example: BMM - writing up \(q\)<span class="html-tag">&lt;/h3&gt;</span></td></tr><tr><td class="line-number" value="1153"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="1154"></td><td class="line-content">				<span class="html-tag">&lt;div <span class="html-attribute-name">class</span>="<span class="html-attribute-value">container</span>"&gt;</span></td></tr><tr><td class="line-number" value="1155"></td><td class="line-content">					<span class="html-tag">&lt;div&gt;</span></td></tr><tr><td class="line-number" value="1156"></td><td class="line-content">						<span class="html-tag">&lt;p&gt;</span>Given the mean-field assumption, we can write out the variational posterior approximation as:<span class="html-tag">&lt;/p&gt;</span></td></tr><tr><td class="line-number" value="1157"></td><td class="line-content">						\[q(\boldsymbol Z, \boldsymbol \mu) = \prod_{n=1}^Nq(z_n)\prod_{k=1}^Kq(\mu_k)\]</td></tr><tr><td class="line-number" value="1158"></td><td class="line-content">		</td></tr><tr><td class="line-number" value="1159"></td><td class="line-content">		</td></tr><tr><td class="line-number" value="1160"></td><td class="line-content">		<span class="html-comment">&lt;!--					&lt;span class="fragment"&gt;--&gt;</span></td></tr><tr><td class="line-number" value="1161"></td><td class="line-content">		<span class="html-comment">&lt;!--					&lt;p&gt;We will see that for this particular choice of model, we actually don't need to specify more. The functional forms of \(q(\boldsymbol z_i)\) and \(q(\mu_k)\) will turn out to have the same functional form as their respective priors (we'll see this later):&lt;/p&gt;--&gt;</span></td></tr><tr><td class="line-number" value="1162"></td><td class="line-content">		<span class="html-comment">&lt;!--						&amp;lt;!&amp;ndash;					&lt;p&gt;We now choose \(q(\boldsymbol z_i)\) and \(q(\mu_k)\) to have the same functional form as their respective priors (we'll see later why that makes sense).&lt;/p&gt;&amp;ndash;&amp;gt;--&gt;</span></td></tr><tr><td class="line-number" value="1163"></td><td class="line-content">		<span class="html-comment">&lt;!--					\[q(\mu_k) = \mathcal{N}(\mu_k | \hat \mu_k, \hat \sigma^2) \hspace*{3em} q(z_n) = \prod_{k=1}^K\hat \pi_{nk}^{z_{nk}}\]--&gt;</span></td></tr><tr><td class="line-number" value="1164"></td><td class="line-content">		<span class="html-comment">&lt;!--						&lt;/span&gt;--&gt;</span>		</td></tr><tr><td class="line-number" value="1165"></td><td class="line-content">					<span class="html-tag">&lt;/div&gt;</span></td></tr><tr><td class="line-number" value="1166"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="1167"></td><td class="line-content">					<span class="html-tag">&lt;div&gt;</span></td></tr><tr><td class="line-number" value="1168"></td><td class="line-content">						<span class="html-tag">&lt;img <span class="html-attribute-name">class</span>="<span class="html-attribute-value">noborder center prml</span>" <span class="html-attribute-name">style</span>="<span class="html-attribute-value">width:65%; margin-top:1em; margin-bottom:0.2em</span>" <span class="html-attribute-name">src</span>="<a class="html-attribute-value html-resource-link" target="_blank" href="https://wouterboomsma.github.io/pml2024/week2/prml_figure10.5_adapted.svg" rel="noreferrer noopener">prml_figure10.5_adapted.svg</a>" <span class="html-attribute-name">alt</span>=""&gt;</span></td></tr><tr><td class="line-number" value="1169"></td><td class="line-content">					<span class="html-tag">&lt;/div&gt;</span></td></tr><tr><td class="line-number" value="1170"></td><td class="line-content">				<span class="html-tag">&lt;/div&gt;</span></td></tr><tr><td class="line-number" value="1171"></td><td class="line-content">				<span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">fragment</span>"&gt;</span></td></tr><tr><td class="line-number" value="1172"></td><td class="line-content">					<span class="html-tag">&lt;p&gt;</span>We choose the following functional forms for \(q(\mu_k)\) and \(q(z_n)\) :<span class="html-tag">&lt;/p&gt;</span></td></tr><tr><td class="line-number" value="1173"></td><td class="line-content">				\[q(\mu_k) = \mathcal{N}(\mu_k | m_k, s_k^2) \hspace*{3em} q(z_n) = \prod_{k=1}^K\phi_{nk}^{z_{nk}}\]</td></tr><tr><td class="line-number" value="1174"></td><td class="line-content">				<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="1175"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="1176"></td><td class="line-content">				<span class="html-tag">&lt;p <span class="html-attribute-name">class</span>="<span class="html-attribute-value">fragment</span>"&gt;</span>For this particular model, assuming mean field, these are actually the optimal functional forms (i.e. would arise out of the free-form variational inference approach)<span class="html-tag">&lt;/p&gt;</span></td></tr><tr><td class="line-number" value="1177"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="1178"></td><td class="line-content">			<span class="html-tag">&lt;/section&gt;</span></td></tr><tr><td class="line-number" value="1179"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="1180"></td><td class="line-content">			<span class="html-tag">&lt;section <span class="html-attribute-name">style</span>="<span class="html-attribute-value">font-size:80%</span>"&gt;</span></td></tr><tr><td class="line-number" value="1181"></td><td class="line-content">				<span class="html-tag">&lt;h3&gt;</span>Example: BMM - ELBO<span class="html-tag">&lt;/h3&gt;</span></td></tr><tr><td class="line-number" value="1182"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="1183"></td><td class="line-content">				<span class="html-tag">&lt;p&gt;</span>The ELBO is a function of the variational parameters we just introduced<span class="html-tag">&lt;/p&gt;</span></td></tr><tr><td class="line-number" value="1184"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="1185"></td><td class="line-content">				\[\begin{align*}\text{ELBO}(\boldsymbol \phi, \boldsymbol m, \boldsymbol s^2) &amp;= \mathbb{E}_{q(\boldsymbol Z, \boldsymbol \mu|\boldsymbol \phi, \boldsymbol m, \boldsymbol s^2)}\left[\ln p(\boldsymbol X|\boldsymbol Z, \boldsymbol \mu)\right] + \mathbb{E}_{q(\boldsymbol Z, \boldsymbol \mu|\boldsymbol \phi, \boldsymbol m, \boldsymbol s^2)}\left[\ln \frac{p(\boldsymbol Z, \boldsymbol \mu)}{q(\boldsymbol Z, \boldsymbol \mu|\boldsymbol \phi, \boldsymbol m, \boldsymbol s^2)}\right]\end{align*}\]</td></tr><tr><td class="line-number" value="1186"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="1187"></td><td class="line-content">				<span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">fragment</span>"&gt;</span></td></tr><tr><td class="line-number" value="1188"></td><td class="line-content">				\[\begin{align*}\htmlStyle{visibility:hidden;}{\text{ELBO}(\hat {\boldsymbol \pi}, \hat {\boldsymbol \mu}, \hat {\boldsymbol \sigma}^2)}</td></tr><tr><td class="line-number" value="1189"></td><td class="line-content">					&amp;=\mathbb{E}_{q}\left[\ln p(\boldsymbol X|\boldsymbol Z, \boldsymbol \mu)\right] + \mathbb{E}_{q}\left[ \ln p(\boldsymbol Z)\right] + \mathbb{E}_{q} \left[\ln p(\boldsymbol \mu)\right] \\[1em]&amp;\hspace{2em}- \mathbb{E}_{q} \left[\ln q(\boldsymbol Z)\right] - \mathbb{E}_{q} \left[\ln q(\boldsymbol \mu)\right]</td></tr><tr><td class="line-number" value="1190"></td><td class="line-content">					\end{align*}\]</td></tr><tr><td class="line-number" value="1191"></td><td class="line-content">				<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="1192"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="1193"></td><td class="line-content">				<span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">fragment</span>"&gt;</span></td></tr><tr><td class="line-number" value="1194"></td><td class="line-content">				\[\begin{align*}\htmlStyle{visibility:hidden;}{\text{ELBO}(\boldsymbol \phi, \boldsymbol m, \boldsymbol s^2)}</td></tr><tr><td class="line-number" value="1195"></td><td class="line-content">					&amp;=\sum_{n=1}^N \left(\mathbb{E}_{q}\left[\ln p(x_n| \boldsymbol z_n, \boldsymbol \mu)\right] + \mathbb{E}_{q} \left[\ln p(\boldsymbol z_n)\right] - \mathbb{E}_{q} \left[\ln q(\boldsymbol z_n) \right]\right) \\</td></tr><tr><td class="line-number" value="1196"></td><td class="line-content">				&amp;\hspace{2em}+ \sum_{k=1}^K \left(\mathbb{E}_{q}\left[\ln p(\mu_k) \right] - \mathbb{E}_{q}\left[\ln q(\mu_k) \right]\right)</td></tr><tr><td class="line-number" value="1197"></td><td class="line-content">					\end{align*}\]</td></tr><tr><td class="line-number" value="1198"></td><td class="line-content">					<span class="html-comment">&lt;!-- \[\begin{align*}\htmlStyle{visibility:hidden;}{\text{ELBO}(\boldsymbol \phi, \boldsymbol m, \boldsymbol s^2)}</span></td></tr><tr><td class="line-number" value="1199"></td><td class="line-content"><span class="html-comment">					&amp;=\sum_{n=1}^N \left(\mathbb{E}_{q}\underbrace{\left[\ln p(x_n| \boldsymbol z_n, \boldsymbol \mu)\right]}_{\sum_{k=1}^K z_{nk}\ln(p(x_n|\mu_k))} + \mathbb{E}_{q} \left[\ln p(\boldsymbol z_n)\right] - \mathbb{E}_{q} \left[\ln q(\boldsymbol z_n) \right]\right) \\</span></td></tr><tr><td class="line-number" value="1200"></td><td class="line-content"><span class="html-comment">				&amp;\hspace{2em}+ \sum_{k=1}^K \left(\mathbb{E}_{q}\left[\ln p(\mu_k) \right] - \mathbb{E}_{q}\left[\ln q(\mu_k) \right]\right)</span></td></tr><tr><td class="line-number" value="1201"></td><td class="line-content"><span class="html-comment">					\end{align*}\] --&gt;</span></td></tr><tr><td class="line-number" value="1202"></td><td class="line-content">				<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="1203"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="1204"></td><td class="line-content">				<span class="html-tag">&lt;p <span class="html-attribute-name">class</span>="<span class="html-attribute-value">fragment</span>"&gt;</span>Let's take a look at these individual terms<span class="html-tag">&lt;/p&gt;</span></td></tr><tr><td class="line-number" value="1205"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="1206"></td><td class="line-content"><span class="html-comment">&lt;!--					\sum_{k=1}^K \mathbb{E}_{q(\mu_k)}\left[ \frac{\ln p(\mu_k)}{\ln q(\mu_k)}\right] \\--&gt;</span></td></tr><tr><td class="line-number" value="1207"></td><td class="line-content"><span class="html-comment">&lt;!--					+ \mathbb{E}_{q(\pi_k)}--&gt;</span></td></tr><tr><td class="line-number" value="1208"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="1209"></td><td class="line-content">			<span class="html-tag">&lt;/section&gt;</span></td></tr><tr><td class="line-number" value="1210"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="1211"></td><td class="line-content">			<span class="html-tag">&lt;section <span class="html-attribute-name">style</span>="<span class="html-attribute-value">font-size:75%</span>"&gt;</span></td></tr><tr><td class="line-number" value="1212"></td><td class="line-content">				<span class="html-tag">&lt;div <span class="html-attribute-name">style</span>="<span class="html-attribute-value">border: 1px solid lightgrey; background-color:#fafafa; font-size:90%</span>"&gt;</span></td></tr><tr><td class="line-number" value="1213"></td><td class="line-content">				\[\begin{align*}\text{ELBO}(\boldsymbol \phi, \boldsymbol m, \boldsymbol s^2) &amp;= \sum_{n=1}^N \left(\sum_{k=1}^K\mathbb{E}_{q}\left[\ln(p(x_n|\mu_k)\right] + \mathbb{E}_{q} \left[\ln p(z_n)\right] - \mathbb{E}_{q} \left[\ln q(z_n) \right]\right)\\</td></tr><tr><td class="line-number" value="1214"></td><td class="line-content">				&amp;\hspace{2em}+ \sum_{k=1}^K \left(\mathbb{E}_{q}\left[\ln p(\mu_k) \right] - \mathbb{E}_{q}\left[\ln q(\mu_k) \right]\right)</td></tr><tr><td class="line-number" value="1215"></td><td class="line-content">				\end{align*}\]</td></tr><tr><td class="line-number" value="1216"></td><td class="line-content">				<span class="html-tag">&lt;/div&gt;</span></td></tr><tr><td class="line-number" value="1217"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="1218"></td><td class="line-content">				<span class="html-tag">&lt;dl&gt;</span></td></tr><tr><td class="line-number" value="1219"></td><td class="line-content">					<span class="html-tag">&lt;dt <span class="html-attribute-name">class</span>="" <span class="html-attribute-name">data-fragment-index</span>="<span class="html-attribute-value">1</span>"&gt;</span>\[\mathbb{E}_{q(\mu_k|m_k, s_k^2)}\left[\ln q(\mu_k|m_k, s_k^2) \right]\]<span class="html-tag">&lt;/dt&gt;</span></td></tr><tr><td class="line-number" value="1220"></td><td class="line-content">					<span class="html-tag">&lt;dd <span class="html-attribute-name">class</span>="" <span class="html-attribute-name">data-fragment-index</span>="<span class="html-attribute-value">1</span>"&gt;</span>Depends on variational parameters \(m_k\) and \(s_k^2\)<span class="html-tag">&lt;/dd&gt;</span></td></tr><tr><td class="line-number" value="1221"></td><td class="line-content">					<span class="html-tag">&lt;dt <span class="html-attribute-name">class</span>="<span class="html-attribute-value">fragment</span>" <span class="html-attribute-name">data-fragment-index</span>="<span class="html-attribute-value">2</span>"&gt;</span>\[\mathbb{E}_{q(\mu_k|m_k, s_k^2)}\left[\ln p(\mu_k) \right]\]<span class="html-tag">&lt;/dt&gt;</span></td></tr><tr><td class="line-number" value="1222"></td><td class="line-content">					<span class="html-tag">&lt;dd <span class="html-attribute-name">class</span>="<span class="html-attribute-value">fragment</span>" <span class="html-attribute-name">data-fragment-index</span>="<span class="html-attribute-value">2</span>"&gt;</span>Depends on variational parameters \(m_k\) and \(s_k^2\) through the expectation<span class="html-tag">&lt;/dd&gt;</span></td></tr><tr><td class="line-number" value="1223"></td><td class="line-content">					<span class="html-tag">&lt;dt <span class="html-attribute-name">class</span>="<span class="html-attribute-value">fragment</span>" <span class="html-attribute-name">data-fragment-index</span>="<span class="html-attribute-value">3</span>"&gt;</span>\[\mathbb{E}_{q(\boldsymbol z_n|\boldsymbol \phi_n)}\left[\ln q(\boldsymbol z_n|\boldsymbol \phi_n) \right]\]<span class="html-tag">&lt;/dt&gt;</span></td></tr><tr><td class="line-number" value="1224"></td><td class="line-content">					<span class="html-tag">&lt;dd <span class="html-attribute-name">class</span>="<span class="html-attribute-value">fragment</span>" <span class="html-attribute-name">data-fragment-index</span>="<span class="html-attribute-value">3</span>"&gt;</span>Depends on variational parameters \(\boldsymbol \phi_n= \{\phi_{n1}, \ldots, \phi_{nK}\}\)<span class="html-tag">&lt;/dd&gt;</span></td></tr><tr><td class="line-number" value="1225"></td><td class="line-content">					<span class="html-tag">&lt;dt <span class="html-attribute-name">class</span>="<span class="html-attribute-value">fragment</span>" <span class="html-attribute-name">data-fragment-index</span>="<span class="html-attribute-value">4</span>"&gt;</span>\[\mathbb{E}_{q(\boldsymbol z_n|\boldsymbol \phi_n)}\left[\ln p(z_n) \right]\]<span class="html-tag">&lt;/dt&gt;</span></td></tr><tr><td class="line-number" value="1226"></td><td class="line-content">					<span class="html-tag">&lt;dd <span class="html-attribute-name">class</span>="<span class="html-attribute-value">fragment</span>" <span class="html-attribute-name">data-fragment-index</span>="<span class="html-attribute-value">4</span>"&gt;</span>Depends on variational parameters \(\boldsymbol \phi_n\) through the expectation<span class="html-tag">&lt;/dd&gt;</span></td></tr><tr><td class="line-number" value="1227"></td><td class="line-content">					<span class="html-tag">&lt;dt <span class="html-attribute-name">class</span>="<span class="html-attribute-value">fragment</span>" <span class="html-attribute-name">data-fragment-index</span>="<span class="html-attribute-value">5</span>"&gt;</span>\[\mathbb{E}_{q(\boldsymbol z_n, \mu_k|\boldsymbol \phi_n, m_k, s_k^2)}\left[\ln(p(x_n|\mu_k)\right]     \]<span class="html-tag">&lt;/dt&gt;</span></td></tr><tr><td class="line-number" value="1228"></td><td class="line-content">					<span class="html-tag">&lt;dd <span class="html-attribute-name">class</span>="<span class="html-attribute-value">fragment</span>" <span class="html-attribute-name">data-fragment-index</span>="<span class="html-attribute-value">5</span>"&gt;</span>Depends on variational parameters: \(\boldsymbol \phi_n\), \(m_k\), and \(s^2\) through the expectation<span class="html-tag">&lt;/dd&gt;</span></td></tr><tr><td class="line-number" value="1229"></td><td class="line-content">				<span class="html-tag">&lt;/dl&gt;</span></td></tr><tr><td class="line-number" value="1230"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="1231"></td><td class="line-content">			<span class="html-tag">&lt;/section&gt;</span></td></tr><tr><td class="line-number" value="1232"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="1233"></td><td class="line-content">			<span class="html-tag">&lt;section <span class="html-attribute-name">style</span>="<span class="html-attribute-value">font-size:85%</span>"&gt;</span></td></tr><tr><td class="line-number" value="1234"></td><td class="line-content">				<span class="html-tag">&lt;h3&gt;</span>Optimizing the ELBO<span class="html-tag">&lt;/h3&gt;</span></td></tr><tr><td class="line-number" value="1235"></td><td class="line-content">				<span class="html-tag">&lt;div <span class="html-attribute-name">style</span>="<span class="html-attribute-value">border: 1px solid lightgrey; background-color:#fafafa; font-size:90%</span>"&gt;</span></td></tr><tr><td class="line-number" value="1236"></td><td class="line-content">					\[\begin{align*}\text{ELBO}(\boldsymbol \phi, \boldsymbol m, \boldsymbol s^2) &amp;= \sum_{n=1}^N \left(\sum_{k=1}^K\mathbb{E}_{q}\left[\ln(p(x_n|\mu_k)\right] + \mathbb{E}_{q} \left[\ln p(z_n)\right] - \mathbb{E}_{q} \left[\ln q(z_n) \right]\right)\\</td></tr><tr><td class="line-number" value="1237"></td><td class="line-content">					&amp;\hspace{2em}+ \sum_{k=1}^K \left(\mathbb{E}_{q}\left[\ln p(\mu_k) \right] - \mathbb{E}_{q}\left[\ln q(\mu_k) \right]\right)</td></tr><tr><td class="line-number" value="1238"></td><td class="line-content">					\end{align*}\]</td></tr><tr><td class="line-number" value="1239"></td><td class="line-content">				<span class="html-tag">&lt;/div&gt;</span></td></tr><tr><td class="line-number" value="1240"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="1241"></td><td class="line-content"><span class="html-comment">&lt;!--					&lt;div style="border: 1px solid lightgrey; background-color:#fafafa; font-size:90%"&gt;--&gt;</span></td></tr><tr><td class="line-number" value="1242"></td><td class="line-content"><span class="html-comment">&lt;!--						\[\begin{align*}\text{ELBO}(\hat {\boldsymbol \pi}, \hat {\boldsymbol \mu}, \hat {\boldsymbol \sigma}^2) &amp;= \sum_{n=1}^N \left(\mathbb{E}_{q}\left[\ln p(x_n| z_n, \boldsymbol \mu)\right] + \mathbb{E}_{q} \left[\ln p(z_n)\right] - \mathbb{E}_{q} \left[\ln q(z_n) \right]\right)\\--&gt;</span></td></tr><tr><td class="line-number" value="1243"></td><td class="line-content"><span class="html-comment">&lt;!--						&amp;\hspace{2em}+ \sum_{k=1}^K \left(\mathbb{E}_{q}\left[ p(\mu_k) \right] - \mathbb{E}_{q}\left[ q(\mu_k) \right]\right)--&gt;</span></td></tr><tr><td class="line-number" value="1244"></td><td class="line-content"><span class="html-comment">&lt;!--						\end{align*}\]--&gt;</span></td></tr><tr><td class="line-number" value="1245"></td><td class="line-content"><span class="html-comment">&lt;!--					&lt;/div&gt;--&gt;</span></td></tr><tr><td class="line-number" value="1246"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="1247"></td><td class="line-content">				<span class="html-tag">&lt;p&gt;</span>So, now we just need to optimize wrt the variational parameters<span class="html-tag">&lt;/p&gt;</span></td></tr><tr><td class="line-number" value="1248"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="1249"></td><td class="line-content">				<span class="html-tag">&lt;p <span class="html-attribute-name">class</span>="<span class="html-attribute-value">fragment</span>"&gt;</span>Even though we in mean field VI assume independence between the latent variables, the <span class="html-tag">&lt;em&gt;</span>parameters<span class="html-tag">&lt;/em&gt;</span> of the variational distributions are coupled through the likelihood (e.g. the probabilities \(\boldsymbol \phi_{n}\) for the \(k\) components depends on \(\mu_k\)). How can we optimize this?<span class="html-tag">&lt;/p&gt;</span></td></tr><tr><td class="line-number" value="1250"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="1251"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="1252"></td><td class="line-content">				<span class="html-tag">&lt;p <span class="html-attribute-name">class</span>="<span class="html-attribute-value">fragment</span>"&gt;</span>Idea: optimize for one parameter at a time, keeping the others fixed: Coordinate Ascent Variational Inference (CAVI). Blei et al covers this in detail in <span class="html-tag">&lt;em&gt;</span>"Variational Inference: A review for statisticians"<span class="html-tag">&lt;/em&gt;</span>.<span class="html-tag">&lt;/p&gt;</span></td></tr><tr><td class="line-number" value="1253"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="1254"></td><td class="line-content">			<span class="html-tag">&lt;/section&gt;</span></td></tr><tr><td class="line-number" value="1255"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="1256"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="1257"></td><td class="line-content">				<span class="html-tag">&lt;section <span class="html-attribute-name">style</span>="<span class="html-attribute-value">font-size:100%</span>"&gt;</span></td></tr><tr><td class="line-number" value="1258"></td><td class="line-content">					<span class="html-tag">&lt;h3&gt;</span>Concluding remarks and perspectives<span class="html-tag">&lt;/h3&gt;</span></td></tr><tr><td class="line-number" value="1259"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="1260"></td><td class="line-content">					<span class="html-tag">&lt;span&gt;</span></td></tr><tr><td class="line-number" value="1261"></td><td class="line-content">						<span class="html-tag">&lt;dt <span class="html-attribute-name">style</span>="<span class="html-attribute-value">margin-top:0.5em;</span>"&gt;</span>Mixture models allow modelling of complex distributions.<span class="html-tag">&lt;/dt&gt;</span></td></tr><tr><td class="line-number" value="1262"></td><td class="line-content">						<span class="html-tag">&lt;dt <span class="html-attribute-name">class</span>="<span class="html-attribute-value">fragment</span>" <span class="html-attribute-name">style</span>="<span class="html-attribute-value">margin-top:0.5em;</span>"&gt;</span>The latent variable provides structure/groups in the data<span class="html-tag">&lt;/dt&gt;</span></td></tr><tr><td class="line-number" value="1263"></td><td class="line-content">						<span class="html-tag">&lt;dt <span class="html-attribute-name">class</span>="<span class="html-attribute-value">fragment</span>" <span class="html-attribute-name">style</span>="<span class="html-attribute-value">margin-top:0.5em;</span>"&gt;</span>Gaussian mixtures are somewhat similar to Kmeans, but estimating (co)variances in addition to means.<span class="html-tag">&lt;/dt&gt;</span></td></tr><tr><td class="line-number" value="1264"></td><td class="line-content">						<span class="html-tag">&lt;dt <span class="html-attribute-name">class</span>="<span class="html-attribute-value">fragment</span>" <span class="html-attribute-name">style</span>="<span class="html-attribute-value">margin-top:0.5em;</span>"&gt;</span>Mixture models can be trained using gradient descent, but the EM algorithm is often more efficient.<span class="html-tag">&lt;/dt&gt;</span></td></tr><tr><td class="line-number" value="1265"></td><td class="line-content">						<span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">fragment</span>"&gt;</span></td></tr><tr><td class="line-number" value="1266"></td><td class="line-content">						<span class="html-tag">&lt;dt <span class="html-attribute-name">style</span>="<span class="html-attribute-value">margin-top:0.5em;</span>"&gt;</span></td></tr><tr><td class="line-number" value="1267"></td><td class="line-content">							The variational inference technique covered today is an important step towards understanding the variational autoencoder.</td></tr><tr><td class="line-number" value="1268"></td><td class="line-content">						<span class="html-tag">&lt;/dt&gt;</span></td></tr><tr><td class="line-number" value="1269"></td><td class="line-content">						<span class="html-tag">&lt;dd&gt;</span></td></tr><tr><td class="line-number" value="1270"></td><td class="line-content">							<span class="html-tag">&lt;ul&gt;</span></td></tr><tr><td class="line-number" value="1271"></td><td class="line-content">								<span class="html-tag">&lt;li&gt;</span>Next time, we will cover <span class="html-tag">&lt;em&gt;</span>stochastic variational inference<span class="html-tag">&lt;/em&gt;</span>, which broadens the applicability of VI to a much broader set of models.<span class="html-tag">&lt;/li&gt;</span></td></tr><tr><td class="line-number" value="1272"></td><td class="line-content">								<span class="html-comment">&lt;!-- &lt;li&gt;We will see that variational autoencoders arise as a natural generalization of probabilistic PCA.&lt;/li&gt; --&gt;</span></td></tr><tr><td class="line-number" value="1273"></td><td class="line-content">							<span class="html-tag">&lt;/ul&gt;</span></td></tr><tr><td class="line-number" value="1274"></td><td class="line-content">		</td></tr><tr><td class="line-number" value="1275"></td><td class="line-content">						<span class="html-tag">&lt;/dd&gt;</span></td></tr><tr><td class="line-number" value="1276"></td><td class="line-content">					<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="1277"></td><td class="line-content">					<span class="html-tag">&lt;/dl&gt;</span></td></tr><tr><td class="line-number" value="1278"></td><td class="line-content">	</td></tr><tr><td class="line-number" value="1279"></td><td class="line-content"><span class="html-comment">&lt;!--					&lt;p&gt;We've seen that latent variables can facilitate modelling:&lt;/p&gt;--&gt;</span></td></tr><tr><td class="line-number" value="1280"></td><td class="line-content"><span class="html-comment">&lt;!--					&lt;ul&gt;--&gt;</span></td></tr><tr><td class="line-number" value="1281"></td><td class="line-content"><span class="html-comment">&lt;!--						&lt;li&gt;Discrete latent variables allow us to estimate complex densities as a sum of simpler ones. Gaussian mixture models are a natural probabilistic version of Kmean clustering.&lt;/li&gt;--&gt;</span></td></tr><tr><td class="line-number" value="1282"></td><td class="line-content"><span class="html-comment">&lt;!--						&lt;li&gt;Continous latent variables allow us to describe patterns in data in a lower dimensional space. &lt;/li&gt;--&gt;</span></td></tr><tr><td class="line-number" value="1283"></td><td class="line-content"><span class="html-comment">&lt;!--					&lt;/ul&gt;--&gt;</span></td></tr><tr><td class="line-number" value="1284"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="1285"></td><td class="line-content">					<span class="html-tag">&lt;span&gt;</span></td></tr><tr><td class="line-number" value="1286"></td><td class="line-content">					<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="1287"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="1288"></td><td class="line-content">				<span class="html-tag">&lt;/section&gt;</span></td></tr><tr><td class="line-number" value="1289"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="1290"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="1291"></td><td class="line-content">			<span class="html-tag">&lt;/div&gt;</span></td></tr><tr><td class="line-number" value="1292"></td><td class="line-content">		<span class="html-tag">&lt;/div&gt;</span></td></tr><tr><td class="line-number" value="1293"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="1294"></td><td class="line-content">		<span class="html-tag">&lt;script <span class="html-attribute-name">src</span>="<a class="html-attribute-value html-resource-link" target="_blank" href="https://wouterboomsma.github.io/pml2024/reveal.js-4.5.0/dist/reveal.js" rel="noreferrer noopener">../reveal.js-4.5.0/dist/reveal.js</a>"&gt;</span><span class="html-tag">&lt;/script&gt;</span></td></tr><tr><td class="line-number" value="1295"></td><td class="line-content">		<span class="html-tag">&lt;script <span class="html-attribute-name">src</span>="<a class="html-attribute-value html-resource-link" target="_blank" href="https://wouterboomsma.github.io/pml2024/reveal.js-4.5.0/plugin/notes/notes.js" rel="noreferrer noopener">../reveal.js-4.5.0/plugin/notes/notes.js</a>"&gt;</span><span class="html-tag">&lt;/script&gt;</span></td></tr><tr><td class="line-number" value="1296"></td><td class="line-content">		<span class="html-tag">&lt;script <span class="html-attribute-name">src</span>="<a class="html-attribute-value html-resource-link" target="_blank" href="https://wouterboomsma.github.io/pml2024/reveal.js-4.5.0/plugin/markdown/markdown.js" rel="noreferrer noopener">../reveal.js-4.5.0/plugin/markdown/markdown.js</a>"&gt;</span><span class="html-tag">&lt;/script&gt;</span></td></tr><tr><td class="line-number" value="1297"></td><td class="line-content">		<span class="html-tag">&lt;script <span class="html-attribute-name">src</span>="<a class="html-attribute-value html-resource-link" target="_blank" href="https://wouterboomsma.github.io/pml2024/reveal.js-4.5.0/plugin/highlight/highlight.js" rel="noreferrer noopener">../reveal.js-4.5.0/plugin/highlight/highlight.js</a>"&gt;</span><span class="html-tag">&lt;/script&gt;</span></td></tr><tr><td class="line-number" value="1298"></td><td class="line-content">		<span class="html-tag">&lt;script <span class="html-attribute-name">src</span>="<a class="html-attribute-value html-resource-link" target="_blank" href="https://wouterboomsma.github.io/pml2024/reveal.js-4.5.0/plugin/math/math.js" rel="noreferrer noopener">../reveal.js-4.5.0/plugin/math/math.js</a>"&gt;</span><span class="html-tag">&lt;/script&gt;</span></td></tr><tr><td class="line-number" value="1299"></td><td class="line-content">		<span class="html-tag">&lt;script <span class="html-attribute-name">src</span>="<a class="html-attribute-value html-resource-link" target="_blank" href="https://wouterboomsma.github.io/pml2024/reveal.js-4.5.0/plugin/zoom/zoom.js" rel="noreferrer noopener">../reveal.js-4.5.0/plugin/zoom/zoom.js</a>"&gt;</span><span class="html-tag">&lt;/script&gt;</span></td></tr><tr><td class="line-number" value="1300"></td><td class="line-content">		<span class="html-tag">&lt;script&gt;</span></td></tr><tr><td class="line-number" value="1301"></td><td class="line-content">			// More info about initialization &amp; config:</td></tr><tr><td class="line-number" value="1302"></td><td class="line-content">			// - https://revealjs.com/initialization/</td></tr><tr><td class="line-number" value="1303"></td><td class="line-content">			// - https://revealjs.com/config/</td></tr><tr><td class="line-number" value="1304"></td><td class="line-content">			Reveal.initialize({</td></tr><tr><td class="line-number" value="1305"></td><td class="line-content"> 				// The "normal" size of the presentation, aspect ratio will</td></tr><tr><td class="line-number" value="1306"></td><td class="line-content">  				// be preserved when the presentation is scaled to fit different</td></tr><tr><td class="line-number" value="1307"></td><td class="line-content">  				// resolutions. Can be specified using percentage units.</td></tr><tr><td class="line-number" value="1308"></td><td class="line-content">  				width: 1050,</td></tr><tr><td class="line-number" value="1309"></td><td class="line-content">  				height: 800,</td></tr><tr><td class="line-number" value="1310"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="1311"></td><td class="line-content">				// Factor of the display size that should remain empty around</td></tr><tr><td class="line-number" value="1312"></td><td class="line-content">				// the content</td></tr><tr><td class="line-number" value="1313"></td><td class="line-content">				margin: 0.04,</td></tr><tr><td class="line-number" value="1314"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="1315"></td><td class="line-content">				// Bounds for smallest/largest possible scale to apply to content</td></tr><tr><td class="line-number" value="1316"></td><td class="line-content">				minScale: 0.2,</td></tr><tr><td class="line-number" value="1317"></td><td class="line-content">				maxScale: 2.0,</td></tr><tr><td class="line-number" value="1318"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="1319"></td><td class="line-content">				katex: {</td></tr><tr><td class="line-number" value="1320"></td><td class="line-content">					trust:true</td></tr><tr><td class="line-number" value="1321"></td><td class="line-content">				},</td></tr><tr><td class="line-number" value="1322"></td><td class="line-content">				hash: true,</td></tr><tr><td class="line-number" value="1323"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="1324"></td><td class="line-content">				slideNumber: true,</td></tr><tr><td class="line-number" value="1325"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="1326"></td><td class="line-content">				transitionSpeed: 'fast',</td></tr><tr><td class="line-number" value="1327"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="1328"></td><td class="line-content">				// Learn about plugins: https://revealjs.com/plugins/</td></tr><tr><td class="line-number" value="1329"></td><td class="line-content">				// plugins: [ RevealMarkdown, RevealHighlight, RevealNotes, RevealMath.MathJax2 ]</td></tr><tr><td class="line-number" value="1330"></td><td class="line-content">				plugins: [ RevealMarkdown, RevealHighlight, RevealNotes, RevealZoom, RevealMath.KaTeX() ]</td></tr><tr><td class="line-number" value="1331"></td><td class="line-content">			});</td></tr><tr><td class="line-number" value="1332"></td><td class="line-content">		<span class="html-tag">&lt;/script&gt;</span></td></tr><tr><td class="line-number" value="1333"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="1334"></td><td class="line-content"><span class="html-comment">&lt;!--		&lt;script src="../jquery-3.6.0.min.js"&gt;&lt;/script&gt;--&gt;</span></td></tr><tr><td class="line-number" value="1335"></td><td class="line-content"><span class="html-comment">&lt;!--	  &lt;script&gt;--&gt;</span></td></tr><tr><td class="line-number" value="1336"></td><td class="line-content"><span class="html-comment">&lt;!--			$(document).ready(function() {--&gt;</span></td></tr><tr><td class="line-number" value="1337"></td><td class="line-content"><span class="html-comment">&lt;!--				$(".prml.center").removeClass('center').wrap('&lt;div class="pmrlref" style="text-align: center"&gt;&lt;/div&gt;').parent().append('&lt;span style="writing-mode: vertical-rl; display: inline-block; font-size: 30%; margin-top:10%; vertical-align: top"&gt;Pattern Recognition and Machine Learning, Bishop&lt;/span&gt;');--&gt;</span></td></tr><tr><td class="line-number" value="1338"></td><td class="line-content"><span class="html-comment">&lt;!--			});--&gt;</span></td></tr><tr><td class="line-number" value="1339"></td><td class="line-content"><span class="html-comment">&lt;!--		&lt;/script&gt;--&gt;</span></td></tr><tr><td class="line-number" value="1340"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="1341"></td><td class="line-content">				<span class="html-tag">&lt;script <span class="html-attribute-name">src</span>="<a class="html-attribute-value html-resource-link" target="_blank" href="https://wouterboomsma.github.io/pml2024/jquery-3.6.0.min.js" rel="noreferrer noopener">../jquery-3.6.0.min.js</a>"&gt;</span><span class="html-tag">&lt;/script&gt;</span></td></tr><tr><td class="line-number" value="1342"></td><td class="line-content">			  <span class="html-tag">&lt;script&gt;</span></td></tr><tr><td class="line-number" value="1343"></td><td class="line-content">					$(document).ready(function() {</td></tr><tr><td class="line-number" value="1344"></td><td class="line-content">						$(".prml").wrap('&lt;a href="https://www.microsoft.com/en-us/research/people/cmbishop/prml-book" title="Figure from Pattern Recognition and Machine Learning, by Christopher Bishop."/&gt;&lt;/a&gt;');</td></tr><tr><td class="line-number" value="1345"></td><td class="line-content">					});</td></tr><tr><td class="line-number" value="1346"></td><td class="line-content">				<span class="html-tag">&lt;/script&gt;</span></td></tr><tr><td class="line-number" value="1347"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="1348"></td><td class="line-content">	<span class="html-tag">&lt;/body&gt;</span></td></tr><tr><td class="line-number" value="1349"></td><td class="line-content"><span class="html-tag">&lt;/html&gt;</span></td></tr><tr><td class="line-number" value="1350"></td><td class="line-content"><span class="html-end-of-file"></span></td></tr></tbody></table></body></html>